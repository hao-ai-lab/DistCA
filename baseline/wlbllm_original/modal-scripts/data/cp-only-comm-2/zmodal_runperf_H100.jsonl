{"0": {"per_seq_latency": 2.7580944061279298, "per_doc_latency": 23.418553161621094, "perseq_allgather_time": 0.1475696012377739, "perseq_attn_time": 2.5979056358337402, "perdoc_allgather_time": 0.0031887999153696, "perdoc_attn_time": 23.408720016479492, "output_shape": [65536, 64, 128]}, "per_seq_latency": 0.0026934515684843064, "per_doc_latency": 0.0228696808218956, "per_seq_allgather_latency": 0.00014411093870876358, "per_seq_attn_latency": 0.002537017222493887, "per_doc_allgather_latency": 3.114062417353125e-06, "per_doc_attn_latency": 0.022860078141093254, "num_seq_in_batch": 1024, "seq_len": 64, "num_heads": 64, "head_dim": 128, "cp": 1, "tp": 1, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 1.4459792137145997, "per_doc_latency": 21.846598815917968, "perseq_allgather_time": 0.08260319977998734, "perseq_attn_time": 1.3470672011375426, "perdoc_allgather_time": 0.0035983999259769917, "perdoc_attn_time": 21.83050889968872, "output_shape": [65536, 32, 128]}, "per_seq_latency": 0.0014120890758931638, "per_doc_latency": 0.02133456915616989, "per_seq_allgather_latency": 8.066718728514389e-05, "per_seq_attn_latency": 0.0013154953136108815, "per_doc_allgather_latency": 3.514062427711906e-06, "per_doc_attn_latency": 0.021318856347352266, "num_seq_in_batch": 1024, "seq_len": 64, "num_heads": 64, "head_dim": 128, "cp": 1, "tp": 2, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 0.7785808086395264, "per_doc_latency": 21.87482604980469, "perseq_allgather_time": 0.05083519946783781, "perseq_attn_time": 0.71771519780159, "perdoc_allgather_time": 0.004822399944532663, "perdoc_attn_time": 21.777891159057617, "output_shape": [65536, 16, 128]}, "per_seq_latency": 0.0007603328209370375, "per_doc_latency": 0.02136213481426239, "per_seq_allgather_latency": 4.964374948031036e-05, "per_seq_attn_latency": 0.0007008937478531152, "per_doc_allgather_latency": 4.7093749458326785e-06, "per_doc_attn_latency": 0.021267471835017204, "num_seq_in_batch": 1024, "seq_len": 64, "num_heads": 64, "head_dim": 128, "cp": 1, "tp": 4, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 0.47045278549194336, "per_doc_latency": 20.91112060546875, "perseq_allgather_time": 0.050623999536037446, "perseq_attn_time": 0.40889599919319153, "perdoc_allgather_time": 0.010540799936279655, "perdoc_attn_time": 20.599867248535155, "output_shape": [65536, 8, 128]}, "per_seq_latency": 0.00045942654833197594, "per_doc_latency": 0.020421016216278075, "per_seq_allgather_latency": 4.943749954691157e-05, "per_seq_attn_latency": 0.0003993124992121011, "per_doc_allgather_latency": 1.02937499377731e-05, "per_doc_attn_latency": 0.020117057859897612, "num_seq_in_batch": 1024, "seq_len": 64, "num_heads": 64, "head_dim": 128, "cp": 1, "tp": 8, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 2.515553665161133, "per_doc_latency": 12.222315216064453, "perseq_allgather_time": 0.14485120102763177, "perseq_attn_time": 2.360305571556091, "perdoc_allgather_time": 0.003212799923494458, "perdoc_attn_time": 12.212436962127686, "output_shape": [65536, 64, 128]}, "per_seq_latency": 0.004913190752267838, "per_doc_latency": 0.023871709406375886, "per_seq_allgather_latency": 0.0002829125020070933, "per_seq_attn_latency": 0.004609971819445491, "per_doc_allgather_latency": 6.2749998505751135e-06, "per_doc_attn_latency": 0.023852415941655637, "num_seq_in_batch": 512, "seq_len": 128, "num_heads": 64, "head_dim": 128, "cp": 1, "tp": 1, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 1.3272047996520997, "per_doc_latency": 10.789425659179688, "perseq_allgather_time": 0.08354720026254654, "perseq_attn_time": 1.2270832002162932, "perdoc_allgather_time": 0.0034879999235272407, "perdoc_attn_time": 10.778006553649902, "output_shape": [65536, 32, 128]}, "per_seq_latency": 0.0025921968743205072, "per_doc_latency": 0.02107309699058533, "per_seq_allgather_latency": 0.00016317812551278622, "per_seq_attn_latency": 0.0023966468754224477, "per_doc_allgather_latency": 6.812499850639142e-06, "per_doc_attn_latency": 0.021050794050097466, "num_seq_in_batch": 512, "seq_len": 128, "num_heads": 64, "head_dim": 128, "cp": 1, "tp": 2, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 0.7242447853088378, "per_doc_latency": 10.091614532470704, "perseq_allgather_time": 0.0497759997844696, "perseq_attn_time": 0.6640816032886505, "perdoc_allgather_time": 0.004097599943634123, "perdoc_attn_time": 10.052950429916383, "output_shape": [65536, 16, 128]}, "per_seq_latency": 0.001414540596306324, "per_doc_latency": 0.019710184633731843, "per_seq_allgather_latency": 9.721874957904219e-05, "per_seq_attn_latency": 0.0012970343814231455, "per_doc_allgather_latency": 8.003124889910396e-06, "per_doc_attn_latency": 0.019634668808430435, "num_seq_in_batch": 512, "seq_len": 128, "num_heads": 64, "head_dim": 128, "cp": 1, "tp": 4, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 0.44127840995788575, "per_doc_latency": 9.695702362060548, "perseq_allgather_time": 0.04954559952020645, "perseq_attn_time": 0.38170560002326964, "perdoc_allgather_time": 0.005582399980630726, "perdoc_attn_time": 9.597067070007324, "output_shape": [65536, 8, 128]}, "per_seq_latency": 0.0008618718944489956, "per_doc_latency": 0.018936918675899507, "per_seq_allgather_latency": 9.676874906290322e-05, "per_seq_attn_latency": 0.0007455187500454485, "per_doc_allgather_latency": 1.0903124962169387e-05, "per_doc_attn_latency": 0.018744271621108054, "num_seq_in_batch": 512, "seq_len": 128, "num_heads": 64, "head_dim": 128, "cp": 1, "tp": 8, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 3.1068063735961915, "per_doc_latency": 7.755513763427734, "perseq_allgather_time": 0.1443743996322155, "perseq_attn_time": 2.9525871872901917, "perdoc_allgather_time": 0.0032367999316193163, "perdoc_attn_time": 7.745592093467712, "output_shape": [65536, 64, 128]}, "per_seq_latency": 0.012135962396860123, "per_doc_latency": 0.030294975638389586, "per_seq_allgather_latency": 0.0005639624985633418, "per_seq_attn_latency": 0.011533543700352311, "per_doc_allgather_latency": 1.2643749732887954e-05, "per_doc_attn_latency": 0.03025621911510825, "num_seq_in_batch": 256, "seq_len": 256, "num_heads": 64, "head_dim": 128, "cp": 1, "tp": 1, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 1.6061471939086913, "per_doc_latency": 6.185774230957032, "perseq_allgather_time": 0.08185600005090236, "perseq_attn_time": 1.5142623901367187, "perdoc_allgather_time": 0.0035455999430269005, "perdoc_attn_time": 6.17168960571289, "output_shape": [65536, 32, 128]}, "per_seq_latency": 0.0062740124762058255, "per_doc_latency": 0.024163180589675905, "per_seq_allgather_latency": 0.00031975000019883736, "per_seq_attn_latency": 0.0059150874614715574, "per_doc_allgather_latency": 1.384999977744883e-05, "per_doc_attn_latency": 0.024108162522315978, "num_seq_in_batch": 256, "seq_len": 256, "num_heads": 64, "head_dim": 128, "cp": 1, "tp": 2, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 0.8727935791015625, "per_doc_latency": 5.592812728881836, "perseq_allgather_time": 0.05038880035281181, "perseq_attn_time": 0.811575996875763, "perdoc_allgather_time": 0.004100799944717437, "perdoc_attn_time": 5.555980801582336, "output_shape": [65536, 16, 128]}, "per_seq_latency": 0.0034093499183654786, "per_doc_latency": 0.021846924722194672, "per_seq_allgather_latency": 0.00019683125137817114, "per_seq_attn_latency": 0.003170218737795949, "per_doc_allgather_latency": 1.6018749784052487e-05, "per_doc_attn_latency": 0.021703050006181, "num_seq_in_batch": 256, "seq_len": 256, "num_heads": 64, "head_dim": 128, "cp": 1, "tp": 4, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 0.5133711814880371, "per_doc_latency": 5.757571029663086, "perseq_allgather_time": 0.05096479989588261, "perseq_attn_time": 0.4518591985106468, "perdoc_allgather_time": 0.0039023999474011362, "perdoc_attn_time": 5.736868810653687, "output_shape": [65536, 8, 128]}, "per_seq_latency": 0.002005356177687645, "per_doc_latency": 0.02249051183462143, "per_seq_allgather_latency": 0.00019908124959329144, "per_seq_attn_latency": 0.0017650749941822141, "per_doc_allgather_latency": 1.5243749794535688e-05, "per_doc_attn_latency": 0.022409643791615964, "num_seq_in_batch": 256, "seq_len": 256, "num_heads": 64, "head_dim": 128, "cp": 1, "tp": 8, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 3.852113723754883, "per_doc_latency": 6.95898208618164, "perseq_allgather_time": 0.14428799971938133, "perseq_attn_time": 3.6981152057647706, "perdoc_allgather_time": 0.0032063999329693615, "perdoc_attn_time": 6.949161624908447, "output_shape": [65536, 64, 128]}, "per_seq_latency": 0.030094638466835022, "per_doc_latency": 0.054367047548294065, "per_seq_allgather_latency": 0.0011272499978076667, "per_seq_attn_latency": 0.02889152504503727, "per_doc_allgather_latency": 2.5049999476323136e-05, "per_doc_attn_latency": 0.05429032519459724, "num_seq_in_batch": 128, "seq_len": 512, "num_heads": 64, "head_dim": 128, "cp": 1, "tp": 1, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 1.9940256118774413, "per_doc_latency": 4.282462310791016, "perseq_allgather_time": 0.08164479993283749, "perseq_attn_time": 1.9024320006370545, "perdoc_allgather_time": 0.0036895999452099203, "perdoc_attn_time": 4.266321587562561, "output_shape": [65536, 32, 128]}, "per_seq_latency": 0.01557832509279251, "per_doc_latency": 0.03345673680305481, "per_seq_allgather_latency": 0.0006378499994752929, "per_seq_attn_latency": 0.014862750004976989, "per_doc_allgather_latency": 2.8824999571952502e-05, "per_doc_attn_latency": 0.03333063740283251, "num_seq_in_batch": 128, "seq_len": 512, "num_heads": 64, "head_dim": 128, "cp": 1, "tp": 2, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 1.0617712020874024, "per_doc_latency": 3.2808414459228517, "perseq_allgather_time": 0.04942239951342344, "perseq_attn_time": 1.002655991911888, "perdoc_allgather_time": 0.003543999930843711, "perdoc_attn_time": 3.266908812522888, "output_shape": [65536, 16, 128]}, "per_seq_latency": 0.008295087516307831, "per_doc_latency": 0.02563157379627228, "per_seq_allgather_latency": 0.00038611249619862064, "per_seq_attn_latency": 0.007833249936811625, "per_doc_allgather_latency": 2.7687499459716493e-05, "per_doc_attn_latency": 0.025522725097835063, "num_seq_in_batch": 128, "seq_len": 512, "num_heads": 64, "head_dim": 128, "cp": 1, "tp": 4, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 0.61386079788208, "per_doc_latency": 2.8891952514648436, "perseq_allgather_time": 0.04979840014129877, "perseq_attn_time": 0.5541120022535324, "perdoc_allgather_time": 0.003956799954175949, "perdoc_attn_time": 2.8245359897613525, "output_shape": [65536, 8, 128]}, "per_seq_latency": 0.00479578748345375, "per_doc_latency": 0.02257183790206909, "per_seq_allgather_latency": 0.00038905000110389665, "per_seq_attn_latency": 0.004329000017605722, "per_doc_allgather_latency": 3.09124996419996e-05, "per_doc_attn_latency": 0.022066687420010566, "num_seq_in_batch": 128, "seq_len": 512, "num_heads": 64, "head_dim": 128, "cp": 1, "tp": 8, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 5.057249450683594, "per_doc_latency": 8.106166076660156, "perseq_allgather_time": 0.14471999928355217, "perseq_attn_time": 4.902224016189575, "perdoc_allgather_time": 0.0032143999240361156, "perdoc_attn_time": 8.096302461624145, "output_shape": [65536, 64, 128]}, "per_seq_latency": 0.07901952266693116, "per_doc_latency": 0.12665884494781493, "per_seq_allgather_latency": 0.0022612499888055027, "per_seq_attn_latency": 0.07659725025296212, "per_doc_allgather_latency": 5.0224998813064306e-05, "per_doc_attn_latency": 0.12650472596287726, "num_seq_in_batch": 64, "seq_len": 1024, "num_heads": 64, "head_dim": 128, "cp": 1, "tp": 1, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 2.6146095275878904, "per_doc_latency": 4.1634033203125, "perseq_allgather_time": 0.08544959910213948, "perseq_attn_time": 2.5161423802375795, "perdoc_allgather_time": 0.0032527999370358883, "perdoc_attn_time": 4.153425574302673, "output_shape": [65536, 32, 128]}, "per_seq_latency": 0.04085327386856079, "per_doc_latency": 0.06505317687988281, "per_seq_allgather_latency": 0.0013351499859709294, "per_seq_attn_latency": 0.03931472469121218, "per_doc_allgather_latency": 5.0824999016185755e-05, "per_doc_attn_latency": 0.06489727459847927, "num_seq_in_batch": 64, "seq_len": 1024, "num_heads": 64, "head_dim": 128, "cp": 1, "tp": 2, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 1.3950400352478027, "per_doc_latency": 2.4985008239746094, "perseq_allgather_time": 0.04983679950237274, "perseq_attn_time": 1.334929609298706, "perdoc_allgather_time": 0.003220799926202744, "perdoc_attn_time": 2.488644802570343, "output_shape": [65536, 16, 128]}, "per_seq_latency": 0.021797500550746918, "per_doc_latency": 0.03903907537460327, "per_seq_allgather_latency": 0.0007786999922245741, "per_seq_attn_latency": 0.02085827514529228, "per_doc_allgather_latency": 5.032499884691788e-05, "per_doc_attn_latency": 0.03888507504016161, "num_seq_in_batch": 64, "seq_len": 1024, "num_heads": 64, "head_dim": 128, "cp": 1, "tp": 4, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 0.7974688053131104, "per_doc_latency": 2.1263824462890626, "perseq_allgather_time": 0.05119040068238974, "perseq_attn_time": 0.7356656014919281, "perdoc_allgather_time": 0.003563199914060533, "perdoc_attn_time": 1.9005887866020204, "output_shape": [65536, 8, 128]}, "per_seq_latency": 0.01246045008301735, "per_doc_latency": 0.0332247257232666, "per_seq_allgather_latency": 0.0007998500106623397, "per_seq_attn_latency": 0.011494775023311376, "per_doc_allgather_latency": 5.567499865719583e-05, "per_doc_attn_latency": 0.029696699790656568, "num_seq_in_batch": 64, "seq_len": 1024, "num_heads": 64, "head_dim": 128, "cp": 1, "tp": 8, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 7.8943328857421875, "per_doc_latency": 10.980601501464843, "perseq_allgather_time": 0.14722879976034164, "perseq_attn_time": 7.734633564949036, "perdoc_allgather_time": 0.003287999948952347, "perdoc_attn_time": 10.970531272888184, "output_shape": [65536, 64, 128]}, "per_seq_latency": 0.24669790267944336, "per_doc_latency": 0.34314379692077634, "per_seq_allgather_latency": 0.004600899992510676, "per_seq_attn_latency": 0.24170729890465736, "per_doc_allgather_latency": 0.00010274999840476085, "per_doc_attn_latency": 0.34282910227775576, "num_seq_in_batch": 32, "seq_len": 2048, "num_heads": 64, "head_dim": 128, "cp": 1, "tp": 1, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 4.046430587768555, "per_doc_latency": 5.536748886108398, "perseq_allgather_time": 0.08335999958217144, "perseq_attn_time": 3.9517248272895813, "perdoc_allgather_time": 0.0032159999245777726, "perdoc_attn_time": 5.526900768280029, "output_shape": [65536, 32, 128]}, "per_seq_latency": 0.12645095586776733, "per_doc_latency": 0.17302340269088745, "per_seq_allgather_latency": 0.0026049999869428575, "per_seq_attn_latency": 0.12349140085279942, "per_doc_allgather_latency": 0.0001004999976430554, "per_doc_attn_latency": 0.17271564900875092, "num_seq_in_batch": 32, "seq_len": 2048, "num_heads": 64, "head_dim": 128, "cp": 1, "tp": 2, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 2.1299392700195314, "per_doc_latency": 2.862553596496582, "perseq_allgather_time": 0.050798399932682516, "perseq_attn_time": 2.065334403514862, "perdoc_allgather_time": 0.0032575999503023922, "perdoc_attn_time": 2.852568030357361, "output_shape": [65536, 16, 128]}, "per_seq_latency": 0.06656060218811036, "per_doc_latency": 0.08945479989051819, "per_seq_allgather_latency": 0.0015874499978963286, "per_seq_attn_latency": 0.06454170010983944, "per_doc_allgather_latency": 0.00010179999844694976, "per_doc_attn_latency": 0.08914275094866753, "num_seq_in_batch": 32, "seq_len": 2048, "num_heads": 64, "head_dim": 128, "cp": 1, "tp": 4, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 1.189955234527588, "per_doc_latency": 1.5736000061035156, "perseq_allgather_time": 0.04958719965070486, "perseq_attn_time": 1.1198287963867188, "perdoc_allgather_time": 0.0035919999238103626, "perdoc_attn_time": 1.5577648043632508, "output_shape": [65536, 8, 128]}, "per_seq_latency": 0.03718610107898712, "per_doc_latency": 0.04917500019073486, "per_seq_allgather_latency": 0.001549599989084527, "per_seq_attn_latency": 0.034994649887084964, "per_doc_allgather_latency": 0.00011224999761907383, "per_doc_attn_latency": 0.04868015013635159, "num_seq_in_batch": 32, "seq_len": 2048, "num_heads": 64, "head_dim": 128, "cp": 1, "tp": 8, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 13.539747619628907, "per_doc_latency": 16.964079284667967, "perseq_allgather_time": 0.1450464002788067, "perseq_attn_time": 13.383963108062744, "perdoc_allgather_time": 0.0032319999299943447, "perdoc_attn_time": 16.954172706604005, "output_shape": [65536, 64, 128]}, "per_seq_latency": 0.8462342262268067, "per_doc_latency": 1.060254955291748, "per_seq_allgather_latency": 0.009065400017425418, "per_seq_attn_latency": 0.8364976942539215, "per_doc_allgather_latency": 0.00020199999562464654, "per_doc_attn_latency": 1.0596357941627503, "num_seq_in_batch": 16, "seq_len": 4096, "num_heads": 64, "head_dim": 128, "cp": 1, "tp": 1, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 6.917826843261719, "per_doc_latency": 8.538184356689452, "perseq_allgather_time": 0.08205280043184757, "perseq_attn_time": 6.825302410125732, "perdoc_allgather_time": 0.0032831999473273755, "perdoc_attn_time": 8.528072023391724, "output_shape": [65536, 32, 128]}, "per_seq_latency": 0.43236417770385743, "per_doc_latency": 0.5336365222930908, "per_seq_allgather_latency": 0.005128300026990473, "per_seq_attn_latency": 0.42658140063285827, "per_doc_allgather_latency": 0.00020519999670796097, "per_doc_attn_latency": 0.5330045014619827, "num_seq_in_batch": 16, "seq_len": 4096, "num_heads": 64, "head_dim": 128, "cp": 1, "tp": 2, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 3.6190799713134765, "per_doc_latency": 4.31627197265625, "perseq_allgather_time": 0.05519519932568073, "perseq_attn_time": 3.549065577983856, "perdoc_allgather_time": 0.0032303999294526877, "perdoc_attn_time": 4.306392025947571, "output_shape": [65536, 16, 128]}, "per_seq_latency": 0.22619249820709228, "per_doc_latency": 0.26976699829101564, "per_seq_allgather_latency": 0.003449699957855046, "per_seq_attn_latency": 0.221816598623991, "per_doc_allgather_latency": 0.00020189999559079298, "per_doc_attn_latency": 0.2691495016217232, "num_seq_in_batch": 16, "seq_len": 4096, "num_heads": 64, "head_dim": 128, "cp": 1, "tp": 4, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 1.9813520431518554, "per_doc_latency": 2.3035247802734373, "perseq_allgather_time": 0.050238399766385555, "perseq_attn_time": 1.9197520017623901, "perdoc_allgather_time": 0.0032527999370358883, "perdoc_attn_time": 2.2935551762580872, "output_shape": [65536, 8, 128]}, "per_seq_latency": 0.12383450269699096, "per_doc_latency": 0.14397029876708983, "per_seq_allgather_latency": 0.003139899985399097, "per_seq_attn_latency": 0.11998450011014938, "per_doc_allgather_latency": 0.00020329999606474302, "per_doc_attn_latency": 0.14334719851613045, "num_seq_in_batch": 16, "seq_len": 4096, "num_heads": 64, "head_dim": 128, "cp": 1, "tp": 8, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 24.83018341064453, "per_doc_latency": 29.477859497070312, "perseq_allgather_time": 0.1398159980773926, "perseq_attn_time": 24.68357620239258, "perdoc_allgather_time": 0.0032687999424524604, "perdoc_attn_time": 29.467877006530763, "output_shape": [65536, 64, 128]}, "per_seq_latency": 3.1037729263305662, "per_doc_latency": 3.684732437133789, "per_seq_allgather_latency": 0.017476999759674074, "per_seq_attn_latency": 3.0854470252990724, "per_doc_allgather_latency": 0.00040859999280655756, "per_doc_attn_latency": 3.6834846258163454, "num_seq_in_batch": 8, "seq_len": 8192, "num_heads": 64, "head_dim": 128, "cp": 1, "tp": 1, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 12.697621154785157, "per_doc_latency": 14.540623474121094, "perseq_allgather_time": 0.08347999937832355, "perseq_attn_time": 12.60270562171936, "perdoc_allgather_time": 0.003235199942719191, "perdoc_attn_time": 14.530705547332763, "output_shape": [65536, 32, 128]}, "per_seq_latency": 1.5872026443481446, "per_doc_latency": 1.8175779342651368, "per_seq_allgather_latency": 0.010434999922290444, "per_seq_attn_latency": 1.57533820271492, "per_doc_allgather_latency": 0.0004043999928398989, "per_doc_attn_latency": 1.8163381934165954, "num_seq_in_batch": 8, "seq_len": 8192, "num_heads": 64, "head_dim": 128, "cp": 1, "tp": 2, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 6.545963287353516, "per_doc_latency": 7.399505615234375, "perseq_allgather_time": 0.04973280020058155, "perseq_attn_time": 6.485875201225281, "perdoc_allgather_time": 0.003203199920244515, "perdoc_attn_time": 7.38932318687439, "output_shape": [65536, 16, 128]}, "per_seq_latency": 0.8182454109191895, "per_doc_latency": 0.9249382019042969, "per_seq_allgather_latency": 0.006216600025072694, "per_seq_attn_latency": 0.8107344001531601, "per_doc_allgather_latency": 0.0004003999900305644, "per_doc_attn_latency": 0.9236653983592987, "num_seq_in_batch": 8, "seq_len": 8192, "num_heads": 64, "head_dim": 128, "cp": 1, "tp": 4, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 3.5564815521240236, "per_doc_latency": 3.8346126556396483, "perseq_allgather_time": 0.04964960031211376, "perseq_attn_time": 3.4968063950538637, "perdoc_allgather_time": 0.0032319999299943447, "perdoc_attn_time": 3.824712026119232, "output_shape": [65536, 8, 128]}, "per_seq_latency": 0.44456019401550295, "per_doc_latency": 0.47932658195495603, "per_seq_allgather_latency": 0.00620620003901422, "per_seq_attn_latency": 0.43710079938173296, "per_doc_allgather_latency": 0.0004039999912492931, "per_doc_attn_latency": 0.478089003264904, "num_seq_in_batch": 8, "seq_len": 8192, "num_heads": 64, "head_dim": 128, "cp": 1, "tp": 8, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 47.613912963867186, "per_doc_latency": 53.9921142578125, "perseq_allgather_time": 0.1400351993739605, "perseq_attn_time": 47.467227172851565, "perdoc_allgather_time": 0.0032239999272860587, "perdoc_attn_time": 53.982228660583495, "output_shape": [65536, 64, 128]}, "per_seq_latency": 11.903478240966797, "per_doc_latency": 13.498028564453126, "per_seq_allgather_latency": 0.035008799843490125, "per_seq_attn_latency": 11.866806793212891, "per_doc_allgather_latency": 0.0008059999818215147, "per_doc_attn_latency": 13.495557165145874, "num_seq_in_batch": 4, "seq_len": 16384, "num_heads": 64, "head_dim": 128, "cp": 1, "tp": 1, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 24.196076965332033, "per_doc_latency": 26.700411987304687, "perseq_allgather_time": 0.07726080007851124, "perseq_attn_time": 24.11222743988037, "perdoc_allgather_time": 0.0031903999159112574, "perdoc_attn_time": 26.690622329711914, "output_shape": [65536, 32, 128]}, "per_seq_latency": 6.049019241333008, "per_doc_latency": 6.675102996826172, "per_seq_allgather_latency": 0.01931520001962781, "per_seq_attn_latency": 6.028056859970093, "per_doc_allgather_latency": 0.0007975999789778144, "per_doc_attn_latency": 6.6726555824279785, "num_seq_in_batch": 4, "seq_len": 16384, "num_heads": 64, "head_dim": 128, "cp": 1, "tp": 2, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 12.511678314208984, "per_doc_latency": 13.500164794921876, "perseq_allgather_time": 0.04972159992903471, "perseq_attn_time": 12.451671981811524, "perdoc_allgather_time": 0.0032783999340608716, "perdoc_attn_time": 13.49021282196045, "output_shape": [65536, 16, 128]}, "per_seq_latency": 3.127919578552246, "per_doc_latency": 3.375041198730469, "per_seq_allgather_latency": 0.012430399982258677, "per_seq_attn_latency": 3.112917995452881, "per_doc_allgather_latency": 0.0008195999835152179, "per_doc_attn_latency": 3.3725532054901124, "num_seq_in_batch": 4, "seq_len": 16384, "num_heads": 64, "head_dim": 128, "cp": 1, "tp": 4, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 6.670703887939453, "per_doc_latency": 6.9587455749511715, "perseq_allgather_time": 0.04959199968725443, "perseq_attn_time": 6.61094720363617, "perdoc_allgather_time": 0.003211199922952801, "perdoc_attn_time": 6.94892315864563, "output_shape": [65536, 8, 128]}, "per_seq_latency": 1.6676759719848633, "per_doc_latency": 1.7396863937377929, "per_seq_allgather_latency": 0.012397999921813608, "per_seq_attn_latency": 1.6527368009090424, "per_doc_allgather_latency": 0.0008027999807382003, "per_doc_attn_latency": 1.7372307896614074, "num_seq_in_batch": 4, "seq_len": 16384, "num_heads": 64, "head_dim": 128, "cp": 1, "tp": 8, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 93.02147216796875, "per_doc_latency": 103.7802734375, "perseq_allgather_time": 0.1400256000459194, "perseq_attn_time": 92.87471237182618, "perdoc_allgather_time": 0.003278399945702404, "perdoc_attn_time": 103.77025299072265, "output_shape": [65536, 64, 128]}, "per_seq_latency": 46.510736083984376, "per_doc_latency": 51.89013671875, "per_seq_allgather_latency": 0.0700128000229597, "per_seq_attn_latency": 46.43735618591309, "per_doc_allgather_latency": 0.001639199972851202, "per_doc_attn_latency": 51.88512649536133, "num_seq_in_batch": 2, "seq_len": 32768, "num_heads": 64, "head_dim": 128, "cp": 1, "tp": 1, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 47.32095642089844, "per_doc_latency": 52.21280517578125, "perseq_allgather_time": 0.07714399956166744, "perseq_attn_time": 47.237142372131345, "perdoc_allgather_time": 0.0032063999213278295, "perdoc_attn_time": 52.202938652038576, "output_shape": [65536, 32, 128]}, "per_seq_latency": 23.66047821044922, "per_doc_latency": 26.106402587890624, "per_seq_allgather_latency": 0.03857199978083372, "per_seq_attn_latency": 23.618571186065672, "per_doc_allgather_latency": 0.0016031999606639148, "per_doc_attn_latency": 26.101469326019288, "num_seq_in_batch": 2, "seq_len": 32768, "num_heads": 64, "head_dim": 128, "cp": 1, "tp": 2, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 24.464785766601562, "per_doc_latency": 25.910812377929688, "perseq_allgather_time": 0.04481599982827902, "perseq_attn_time": 24.413217735290527, "perdoc_allgather_time": 0.0032527999370358883, "perdoc_attn_time": 25.900881862640382, "output_shape": [65536, 16, 128]}, "per_seq_latency": 12.232392883300781, "per_doc_latency": 12.955406188964844, "per_seq_allgather_latency": 0.02240799991413951, "per_seq_attn_latency": 12.206608867645263, "per_doc_allgather_latency": 0.0016263999685179442, "per_doc_attn_latency": 12.950440931320191, "num_seq_in_batch": 2, "seq_len": 32768, "num_heads": 64, "head_dim": 128, "cp": 1, "tp": 4, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 13.038902282714844, "per_doc_latency": 13.300128173828124, "perseq_allgather_time": 0.044910399802029134, "perseq_attn_time": 12.987339210510253, "perdoc_allgather_time": 0.003241599933244288, "perdoc_attn_time": 13.290188789367676, "output_shape": [65536, 8, 128]}, "per_seq_latency": 6.519451141357422, "per_doc_latency": 6.650064086914062, "per_seq_allgather_latency": 0.022455199901014567, "per_seq_attn_latency": 6.493669605255127, "per_doc_allgather_latency": 0.001620799966622144, "per_doc_attn_latency": 6.645094394683838, "num_seq_in_batch": 2, "seq_len": 32768, "num_heads": 64, "head_dim": 128, "cp": 1, "tp": 8, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 183.19815673828126, "per_doc_latency": 206.2207275390625, "perseq_allgather_time": 0.1399376004934311, "perseq_attn_time": 183.05150909423827, "perdoc_allgather_time": 0.0032847999478690325, "perdoc_attn_time": 206.2106071472168, "output_shape": [65536, 64, 128]}, "per_seq_latency": 183.19815673828126, "per_doc_latency": 206.2207275390625, "per_seq_allgather_latency": 0.1399376004934311, "per_seq_attn_latency": 183.05150909423827, "per_doc_allgather_latency": 0.0032847999478690325, "per_doc_attn_latency": 206.2106071472168, "num_seq_in_batch": 1, "seq_len": 65536, "num_heads": 64, "head_dim": 128, "cp": 1, "tp": 1, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 92.83199462890624, "per_doc_latency": 103.74642333984374, "perseq_allgather_time": 0.07692160122096539, "perseq_attn_time": 92.74843254089356, "perdoc_allgather_time": 0.0032367999316193163, "perdoc_attn_time": 103.73647384643554, "output_shape": [65536, 32, 128]}, "per_seq_latency": 92.83199462890624, "per_doc_latency": 103.74642333984374, "per_seq_allgather_latency": 0.07692160122096539, "per_seq_attn_latency": 92.74843254089356, "per_doc_allgather_latency": 0.0032367999316193163, "per_doc_attn_latency": 103.73647384643554, "num_seq_in_batch": 1, "seq_len": 65536, "num_heads": 64, "head_dim": 128, "cp": 1, "tp": 2, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 47.64072265625, "per_doc_latency": 52.4123291015625, "perseq_allgather_time": 0.04500000011175871, "perseq_attn_time": 47.58900470733643, "perdoc_allgather_time": 0.003255999938119203, "perdoc_attn_time": 52.40237407684326, "output_shape": [65536, 16, 128]}, "per_seq_latency": 47.64072265625, "per_doc_latency": 52.4123291015625, "per_seq_allgather_latency": 0.04500000011175871, "per_seq_attn_latency": 47.58900470733643, "per_doc_allgather_latency": 0.003255999938119203, "per_doc_attn_latency": 52.40237407684326, "num_seq_in_batch": 1, "seq_len": 65536, "num_heads": 64, "head_dim": 128, "cp": 1, "tp": 4, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 25.073670959472658, "per_doc_latency": 26.44336853027344, "perseq_allgather_time": 0.04497599974274635, "perseq_attn_time": 25.022105407714843, "perdoc_allgather_time": 0.003179199923761189, "perdoc_attn_time": 26.433569526672365, "output_shape": [65536, 8, 128]}, "per_seq_latency": 25.073670959472658, "per_doc_latency": 26.44336853027344, "per_seq_allgather_latency": 0.04497599974274635, "per_seq_attn_latency": 25.022105407714843, "per_doc_allgather_latency": 0.003179199923761189, "per_doc_attn_latency": 26.433569526672365, "num_seq_in_batch": 1, "seq_len": 65536, "num_heads": 64, "head_dim": 128, "cp": 1, "tp": 8, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"1": {"per_seq_latency": 2.5262943267822267, "per_doc_latency": 63.024725341796874, "perseq_allgather_time": 1.1927552193403244, "perseq_attn_time": 1.3269567906856536, "perdoc_allgather_time": 42.25418872833252, "perdoc_attn_time": 20.763915061950684, "output_shape": [32768, 64, 128]}, "0": {"per_seq_latency": 1.8016912460327148, "per_doc_latency": 63.467584228515626, "perseq_allgather_time": 0.4586911991238594, "perseq_attn_time": 1.331227195262909, "perdoc_allgather_time": 45.119307136535646, "perdoc_attn_time": 18.341449642181395, "output_shape": [32768, 64, 128]}, "per_seq_latency": 0.002467084303498268, "per_doc_latency": 0.06198006272315979, "per_seq_allgather_latency": 0.0011648000188870355, "per_seq_attn_latency": 0.0013000265578739345, "per_doc_allgather_latency": 0.04406182337552309, "per_doc_attn_latency": 0.020277260802686214, "num_seq_in_batch": 1024, "seq_len": 64, "num_heads": 64, "head_dim": 128, "cp": 2, "tp": 1, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"1": {"per_seq_latency": 1.2409711837768556, "per_doc_latency": 62.23255615234375, "perseq_allgather_time": 0.5198912024497986, "perseq_attn_time": 0.7144255965948105, "perdoc_allgather_time": 42.26957607269287, "perdoc_attn_time": 19.949212741851806, "output_shape": [32768, 32, 128]}, "0": {"per_seq_latency": 1.0452128410339356, "per_doc_latency": 61.43426513671875, "perseq_allgather_time": 0.2707679972052574, "perseq_attn_time": 0.7202416032552719, "perdoc_allgather_time": 41.630734252929685, "perdoc_attn_time": 19.729264068603516, "output_shape": [32768, 32, 128]}, "per_seq_latency": 0.0012118859216570855, "per_doc_latency": 0.06077398061752319, "per_seq_allgather_latency": 0.0005077062523923814, "per_seq_attn_latency": 0.0007033609406789764, "per_doc_allgather_latency": 0.04127888288348913, "per_doc_attn_latency": 0.019481653068214654, "num_seq_in_batch": 1024, "seq_len": 64, "num_heads": 64, "head_dim": 128, "cp": 2, "tp": 2, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"1": {"per_seq_latency": 0.7774767875671387, "per_doc_latency": 62.491632080078126, "perseq_allgather_time": 0.3691344060003757, "perseq_attn_time": 0.4015855997800827, "perdoc_allgather_time": 43.617690849304196, "perdoc_attn_time": 18.805924892425537, "output_shape": [32768, 16, 128]}, "0": {"per_seq_latency": 0.6610767841339111, "per_doc_latency": 60.64937133789063, "perseq_allgather_time": 0.16099999994039535, "perseq_attn_time": 0.40664959996938704, "perdoc_allgather_time": 42.36855850219727, "perdoc_attn_time": 18.003102445602416, "output_shape": [32768, 16, 128]}, "per_seq_latency": 0.0007592546753585339, "per_doc_latency": 0.061026984453201295, "per_seq_allgather_latency": 0.0003604828183597419, "per_seq_attn_latency": 0.00039711874997010453, "per_doc_allgather_latency": 0.04259540122002363, "per_doc_attn_latency": 0.018365161027759314, "num_seq_in_batch": 1024, "seq_len": 64, "num_heads": 64, "head_dim": 128, "cp": 2, "tp": 4, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 0.4363711833953857, "per_doc_latency": 61.858148193359376, "perseq_allgather_time": 0.1650911994278431, "perseq_attn_time": 0.25417600125074385, "perdoc_allgather_time": 43.256159973144534, "perdoc_attn_time": 18.0719614982605, "output_shape": [32768, 8, 128]}, "1": {"per_seq_latency": 1.00173921585083, "per_doc_latency": 63.45347900390625, "perseq_allgather_time": 0.7470048047602177, "perseq_attn_time": 0.24804159998893738, "perdoc_allgather_time": 45.15994567871094, "perdoc_attn_time": 17.997966384887697, "output_shape": [32768, 8, 128]}, "per_seq_latency": 0.0009782609529793262, "per_doc_latency": 0.0619662880897522, "per_seq_allgather_latency": 0.0007294968796486501, "per_seq_attn_latency": 0.00024821875122142955, "per_doc_allgather_latency": 0.04410150945186615, "per_doc_attn_latency": 0.01764839990064502, "num_seq_in_batch": 1024, "seq_len": 64, "num_heads": 64, "head_dim": 128, "cp": 2, "tp": 8, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 1.732032012939453, "per_doc_latency": 32.02994995117187, "perseq_allgather_time": 0.4558495968580246, "perseq_attn_time": 1.2299264013767242, "perdoc_allgather_time": 18.981635093688965, "perdoc_attn_time": 13.041348791122436, "output_shape": [32768, 64, 128]}, "1": {"per_seq_latency": 1.9939888000488282, "per_doc_latency": 31.433773803710938, "perseq_allgather_time": 0.7573392033576966, "perseq_attn_time": 1.229934388399124, "perdoc_allgather_time": 18.933969688415527, "perdoc_attn_time": 12.493136072158814, "output_shape": [32768, 64, 128]}, "per_seq_latency": 0.0038945093750953675, "per_doc_latency": 0.06255849599838256, "per_seq_allgather_latency": 0.001479178131558001, "per_seq_attn_latency": 0.002402215602342039, "per_doc_allgather_latency": 0.03707350604236126, "per_doc_attn_latency": 0.025471384357661008, "num_seq_in_batch": 512, "seq_len": 128, "num_heads": 64, "head_dim": 128, "cp": 2, "tp": 1, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"1": {"per_seq_latency": 1.2838272094726562, "per_doc_latency": 30.683444213867187, "perseq_allgather_time": 0.6078144058585166, "perseq_attn_time": 0.6693183958530426, "perdoc_allgather_time": 18.87433605194092, "perdoc_attn_time": 11.80242395401001, "output_shape": [32768, 32, 128]}, "0": {"per_seq_latency": 0.9750783920288086, "per_doc_latency": 30.74273681640625, "perseq_allgather_time": 0.2635023966431618, "perseq_attn_time": 0.6717631965875626, "perdoc_allgather_time": 18.793668842315675, "perdoc_attn_time": 11.886728096008301, "output_shape": [32768, 32, 128]}, "per_seq_latency": 0.0025074750185012816, "per_doc_latency": 0.06004440784454346, "per_seq_allgather_latency": 0.0011871375114424153, "per_seq_attn_latency": 0.0013120374933350831, "per_doc_allgather_latency": 0.03686393760144711, "per_doc_attn_latency": 0.023216265812516214, "num_seq_in_batch": 512, "seq_len": 128, "num_heads": 64, "head_dim": 128, "cp": 2, "tp": 2, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"1": {"per_seq_latency": 0.9243791580200196, "per_doc_latency": 30.141299438476562, "perseq_allgather_time": 0.5292256034910678, "perseq_attn_time": 0.3885455995798111, "perdoc_allgather_time": 18.368900775909424, "perdoc_attn_time": 11.762703990936279, "output_shape": [32768, 16, 128]}, "0": {"per_seq_latency": 0.638759994506836, "per_doc_latency": 30.54622802734375, "perseq_allgather_time": 0.16059520170092584, "perseq_attn_time": 0.3904671981930733, "perdoc_allgather_time": 18.551652717590333, "perdoc_attn_time": 11.833577632904053, "output_shape": [32768, 16, 128]}, "per_seq_latency": 0.0018054280430078507, "per_doc_latency": 0.059660601615905764, "per_seq_allgather_latency": 0.0010336437568184919, "per_seq_attn_latency": 0.0007626312464708463, "per_doc_allgather_latency": 0.03623369671404362, "per_doc_attn_latency": 0.023112456314265728, "num_seq_in_batch": 512, "seq_len": 128, "num_heads": 64, "head_dim": 128, "cp": 2, "tp": 4, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 0.42351198196411133, "per_doc_latency": 30.13671875, "perseq_allgather_time": 0.1616479992866516, "perseq_attn_time": 0.24711039960384368, "perdoc_allgather_time": 18.692123126983642, "perdoc_attn_time": 11.224169635772705, "output_shape": [32768, 8, 128]}, "1": {"per_seq_latency": 0.8893631935119629, "per_doc_latency": 29.63892822265625, "perseq_allgather_time": 0.6389664053916931, "perseq_attn_time": 0.24364640265703202, "perdoc_allgather_time": 18.793067264556885, "perdoc_attn_time": 10.750339198112489, "output_shape": [32768, 8, 128]}, "per_seq_latency": 0.0017370374873280526, "per_doc_latency": 0.05886077880859375, "per_seq_allgather_latency": 0.0012479812605306507, "per_seq_attn_latency": 0.0004826374992262572, "per_doc_allgather_latency": 0.03670520950108767, "per_doc_attn_latency": 0.021922206319868565, "num_seq_in_batch": 512, "seq_len": 128, "num_heads": 64, "head_dim": 128, "cp": 2, "tp": 8, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"1": {"per_seq_latency": 2.5244415283203123, "per_doc_latency": 18.520156860351562, "perseq_allgather_time": 0.9782079994678498, "perseq_attn_time": 1.5396191954612732, "perdoc_allgather_time": 11.998348903656005, "perdoc_attn_time": 6.5151423692703245, "output_shape": [32768, 64, 128]}, "0": {"per_seq_latency": 2.0104080200195313, "per_doc_latency": 18.568815612792967, "perseq_allgather_time": 0.45765920281410216, "perseq_attn_time": 1.5423423945903778, "perdoc_allgather_time": 11.86559991836548, "perdoc_attn_time": 6.695542407035828, "output_shape": [32768, 64, 128]}, "per_seq_latency": 0.00986109972000122, "per_doc_latency": 0.07253443598747253, "per_seq_allgather_latency": 0.003821124997921288, "per_seq_attn_latency": 0.006024774978868663, "per_doc_allgather_latency": 0.04686855040490627, "per_doc_attn_latency": 0.026154462527483702, "num_seq_in_batch": 256, "seq_len": 256, "num_heads": 64, "head_dim": 128, "cp": 2, "tp": 1, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 1.125928020477295, "per_doc_latency": 17.22130432128906, "perseq_allgather_time": 0.2654784008860588, "perseq_attn_time": 0.8248255997896194, "perdoc_allgather_time": 11.674688005447388, "perdoc_attn_time": 5.520615959167481, "output_shape": [32768, 32, 128]}, "1": {"per_seq_latency": 1.753473663330078, "per_doc_latency": 17.279948425292968, "perseq_allgather_time": 0.9256704047322273, "perseq_attn_time": 0.8211136072874069, "perdoc_allgather_time": 11.635873556137085, "perdoc_attn_time": 5.637363171577453, "output_shape": [32768, 32, 128]}, "per_seq_latency": 0.006849506497383117, "per_doc_latency": 0.06749979853630066, "per_seq_allgather_latency": 0.003615900018485263, "per_seq_attn_latency": 0.003221974999178201, "per_doc_allgather_latency": 0.04560425002127886, "per_doc_attn_latency": 0.022020949888974427, "num_seq_in_batch": 256, "seq_len": 256, "num_heads": 64, "head_dim": 128, "cp": 2, "tp": 2, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 0.6550848007202148, "per_doc_latency": 16.64581756591797, "perseq_allgather_time": 0.17570560052990913, "perseq_attn_time": 0.4674640014767647, "perdoc_allgather_time": 11.363191890716553, "perdoc_attn_time": 5.203436732292175, "output_shape": [32768, 16, 128]}, "1": {"per_seq_latency": 0.8389951705932617, "per_doc_latency": 16.53350067138672, "perseq_allgather_time": 0.37207679376006125, "perseq_attn_time": 0.4601151987910271, "perdoc_allgather_time": 11.356132888793946, "perdoc_attn_time": 5.170622396469116, "output_shape": [32768, 16, 128]}, "per_seq_latency": 0.0032773248851299284, "per_doc_latency": 0.06502272486686707, "per_seq_allgather_latency": 0.0014534249756252393, "per_seq_attn_latency": 0.0018260312557686121, "per_doc_allgather_latency": 0.04438746832311154, "per_doc_attn_latency": 0.02032592473551631, "num_seq_in_batch": 256, "seq_len": 256, "num_heads": 64, "head_dim": 128, "cp": 2, "tp": 4, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"1": {"per_seq_latency": 0.8579183578491211, "per_doc_latency": 16.084120178222655, "perseq_allgather_time": 0.5708352126181125, "perseq_attn_time": 0.28023840188980104, "perdoc_allgather_time": 12.74508810043335, "perdoc_attn_time": 3.3187471866607665, "output_shape": [32768, 8, 128]}, "0": {"per_seq_latency": 0.4897200107574463, "per_doc_latency": 16.13995819091797, "perseq_allgather_time": 0.15882399976253508, "perseq_attn_time": 0.28301919996738434, "perdoc_allgather_time": 11.054115152359008, "perdoc_attn_time": 5.029759955406189, "output_shape": [32768, 8, 128]}, "per_seq_latency": 0.003351243585348129, "per_doc_latency": 0.06304671168327332, "per_seq_allgather_latency": 0.002229825049289502, "per_seq_attn_latency": 0.001105543749872595, "per_doc_allgather_latency": 0.04978550039231777, "per_doc_attn_latency": 0.019647499825805426, "num_seq_in_batch": 256, "seq_len": 256, "num_heads": 64, "head_dim": 128, "cp": 2, "tp": 8, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 2.3961904525756834, "per_doc_latency": 12.625801849365235, "perseq_allgather_time": 0.45688959807157514, "perseq_attn_time": 1.9279359936714173, "perdoc_allgather_time": 7.281724810600281, "perdoc_attn_time": 5.337070417404175, "output_shape": [32768, 64, 128]}, "1": {"per_seq_latency": 2.8121503829956054, "per_doc_latency": 12.628523254394532, "perseq_allgather_time": 0.8837104007601738, "perseq_attn_time": 1.9217263996601104, "perdoc_allgather_time": 7.4820576190948485, "perdoc_attn_time": 5.139792013168335, "output_shape": [32768, 64, 128]}, "per_seq_latency": 0.021969924867153167, "per_doc_latency": 0.09866033792495728, "per_seq_allgather_latency": 0.006903987505938858, "per_seq_attn_latency": 0.015061999950557948, "per_doc_allgather_latency": 0.058453575149178504, "per_doc_attn_latency": 0.04169586263597012, "num_seq_in_batch": 128, "seq_len": 512, "num_heads": 64, "head_dim": 128, "cp": 2, "tp": 1, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"1": {"per_seq_latency": 1.650204849243164, "per_doc_latency": 8.62566909790039, "perseq_allgather_time": 0.621670413017273, "perseq_attn_time": 1.021891188621521, "perdoc_allgather_time": 5.252771186828613, "perdoc_attn_time": 3.366328001022339, "output_shape": [32768, 32, 128]}, "0": {"per_seq_latency": 1.2995311737060546, "per_doc_latency": 8.671916961669922, "perseq_allgather_time": 0.26525439918041227, "perseq_attn_time": 1.0237871944904327, "perdoc_allgather_time": 5.226887941360474, "perdoc_attn_time": 3.42669278383255, "output_shape": [32768, 32, 128]}, "per_seq_latency": 0.012892225384712219, "per_doc_latency": 0.06774935126304626, "per_seq_allgather_latency": 0.004856800101697445, "per_seq_attn_latency": 0.007998337456956505, "per_doc_allgather_latency": 0.04103727489709854, "per_doc_attn_latency": 0.026771037373691797, "num_seq_in_batch": 128, "seq_len": 512, "num_heads": 64, "head_dim": 128, "cp": 2, "tp": 2, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"1": {"per_seq_latency": 1.0602160453796388, "per_doc_latency": 8.093653106689453, "perseq_allgather_time": 0.48327038884162904, "perseq_attn_time": 0.5703631967306138, "perdoc_allgather_time": 5.384742403030396, "perdoc_attn_time": 2.7023104071617126, "output_shape": [32768, 16, 128]}, "0": {"per_seq_latency": 0.776139211654663, "per_doc_latency": 7.999887847900391, "perseq_allgather_time": 0.16176320016384124, "perseq_attn_time": 0.5747168004512787, "perdoc_allgather_time": 5.086520075798035, "perdoc_attn_time": 2.8592463970184325, "output_shape": [32768, 16, 128]}, "per_seq_latency": 0.008282937854528428, "per_doc_latency": 0.06323166489601136, "per_seq_allgather_latency": 0.003775549912825227, "per_seq_attn_latency": 0.004489975003525615, "per_doc_allgather_latency": 0.04206830002367497, "per_doc_attn_latency": 0.022337862476706504, "num_seq_in_batch": 128, "seq_len": 512, "num_heads": 64, "head_dim": 128, "cp": 2, "tp": 4, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"1": {"per_seq_latency": 0.9395024299621582, "per_doc_latency": 7.638203430175781, "perseq_allgather_time": 0.590404798835516, "perseq_attn_time": 0.3423903971910477, "perdoc_allgather_time": 4.9468847751617435, "perdoc_attn_time": 2.6836383819580076, "output_shape": [32768, 8, 128]}, "0": {"per_seq_latency": 0.5937888145446777, "per_doc_latency": 7.588833618164062, "perseq_allgather_time": 0.16095040068030358, "perseq_attn_time": 0.39700800329446795, "perdoc_allgather_time": 5.3119535684585575, "perdoc_attn_time": 2.2289007782936094, "output_shape": [32768, 8, 128]}, "per_seq_latency": 0.007339862734079361, "per_doc_latency": 0.05967346429824829, "per_seq_allgather_latency": 0.004612537490902469, "per_seq_attn_latency": 0.003101625025738031, "per_doc_allgather_latency": 0.04149963725358248, "per_doc_attn_latency": 0.020965924859046935, "num_seq_in_batch": 128, "seq_len": 512, "num_heads": 64, "head_dim": 128, "cp": 2, "tp": 8, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 3.003449630737305, "per_doc_latency": 12.435160064697266, "perseq_allgather_time": 0.4566512003540993, "perseq_attn_time": 2.5365903973579407, "perdoc_allgather_time": 7.1069584608078005, "perdoc_attn_time": 5.321262359619141, "output_shape": [32768, 64, 128]}, "1": {"per_seq_latency": 3.7975902557373047, "per_doc_latency": 12.437406158447265, "perseq_allgather_time": 1.2553680464625359, "perseq_attn_time": 2.5355455756187437, "perdoc_allgather_time": 7.183711957931519, "perdoc_attn_time": 5.247051191329956, "output_shape": [32768, 64, 128]}, "per_seq_latency": 0.059337347745895386, "per_doc_latency": 0.19433447122573852, "per_seq_allgather_latency": 0.019615125725977123, "per_seq_attn_latency": 0.03963422495871782, "per_doc_allgather_latency": 0.11224549934267998, "per_doc_attn_latency": 0.08314472436904907, "num_seq_in_batch": 64, "seq_len": 1024, "num_heads": 64, "head_dim": 128, "cp": 2, "tp": 1, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"1": {"per_seq_latency": 1.9785295486450196, "per_doc_latency": 6.854523468017578, "perseq_allgather_time": 0.6309503972530365, "perseq_attn_time": 1.3408544063568115, "perdoc_allgather_time": 3.991644787788391, "perdoc_attn_time": 2.856055974960327, "output_shape": [32768, 32, 128]}, "0": {"per_seq_latency": 1.6286863327026366, "per_doc_latency": 6.851601409912109, "perseq_allgather_time": 0.26473119854927063, "perseq_attn_time": 1.3436592161655425, "perdoc_allgather_time": 3.808403217792511, "perdoc_attn_time": 3.0363136172294616, "output_shape": [32768, 32, 128]}, "per_seq_latency": 0.03091452419757843, "per_doc_latency": 0.10710192918777466, "per_seq_allgather_latency": 0.009858599957078695, "per_seq_attn_latency": 0.020994675252586602, "per_doc_allgather_latency": 0.06236944980919361, "per_doc_attn_latency": 0.04744240026921034, "num_seq_in_batch": 64, "seq_len": 1024, "num_heads": 64, "head_dim": 128, "cp": 2, "tp": 2, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 1.0272496223449707, "per_doc_latency": 4.598467254638672, "perseq_allgather_time": 0.17654879987239838, "perseq_attn_time": 0.7506607979536056, "perdoc_allgather_time": 2.6000416040420533, "perdoc_attn_time": 1.9785648047924043, "output_shape": [32768, 16, 128]}, "1": {"per_seq_latency": 1.4208895683288574, "per_doc_latency": 4.566984176635742, "perseq_allgather_time": 0.6663487873971462, "perseq_attn_time": 0.7479424059391022, "perdoc_allgather_time": 2.7287248253822325, "perdoc_attn_time": 1.8316271960735322, "output_shape": [32768, 16, 128]}, "per_seq_latency": 0.022201399505138397, "per_doc_latency": 0.07185105085372925, "per_seq_allgather_latency": 0.01041169980308041, "per_seq_attn_latency": 0.011729074968025088, "per_doc_allgather_latency": 0.04263632539659738, "per_doc_attn_latency": 0.030915075074881317, "num_seq_in_batch": 64, "seq_len": 1024, "num_heads": 64, "head_dim": 128, "cp": 2, "tp": 4, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"1": {"per_seq_latency": 1.0981663703918456, "per_doc_latency": 4.274038314819336, "perseq_allgather_time": 0.6454480230808258, "perseq_attn_time": 0.44605119675397875, "perdoc_allgather_time": 2.694875192642212, "perdoc_attn_time": 1.5724975883960723, "output_shape": [32768, 8, 128]}, "0": {"per_seq_latency": 0.6806687831878662, "per_doc_latency": 4.293121719360352, "perseq_allgather_time": 0.1625696003437042, "perseq_attn_time": 0.45062399953603743, "perdoc_allgather_time": 2.575206387042999, "perdoc_attn_time": 1.6732528030872345, "output_shape": [32768, 8, 128]}, "per_seq_latency": 0.017158849537372588, "per_doc_latency": 0.0670800268650055, "per_seq_allgather_latency": 0.010085125360637904, "per_seq_attn_latency": 0.007040999992750585, "per_doc_allgather_latency": 0.042107424885034564, "per_doc_attn_latency": 0.02614457504823804, "num_seq_in_batch": 64, "seq_len": 1024, "num_heads": 64, "head_dim": 128, "cp": 2, "tp": 8, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"1": {"per_seq_latency": 5.112779235839843, "per_doc_latency": 13.702330017089844, "perseq_allgather_time": 1.1409552067518234, "perseq_attn_time": 3.965129590034485, "perdoc_allgather_time": 7.09443998336792, "perdoc_attn_time": 6.601212763786316, "output_shape": [32768, 64, 128]}, "0": {"per_seq_latency": 4.437150573730468, "per_doc_latency": 13.702546691894531, "perseq_allgather_time": 0.45765759944915774, "perseq_attn_time": 3.968880021572113, "perdoc_allgather_time": 7.0400255680084225, "perdoc_attn_time": 6.655553650856018, "output_shape": [32768, 64, 128]}, "per_seq_latency": 0.1597743511199951, "per_doc_latency": 0.4282045841217041, "per_seq_allgather_latency": 0.03565485021099448, "per_seq_attn_latency": 0.12402750067412853, "per_doc_allgather_latency": 0.2217012494802475, "per_doc_attn_latency": 0.20798605158925057, "num_seq_in_batch": 32, "seq_len": 2048, "num_heads": 64, "head_dim": 128, "cp": 2, "tp": 1, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 2.356964874267578, "per_doc_latency": 7.096673583984375, "perseq_allgather_time": 0.26718240082263944, "perseq_attn_time": 2.0795663833618163, "perdoc_allgather_time": 3.679377591609955, "perdoc_attn_time": 3.4103279948234557, "output_shape": [32768, 32, 128]}, "1": {"per_seq_latency": 2.693564796447754, "per_doc_latency": 7.097878265380859, "perseq_allgather_time": 0.6036383986473084, "perseq_attn_time": 2.0831904292106627, "perdoc_allgather_time": 3.6907952308654783, "perdoc_attn_time": 3.400335991382599, "output_shape": [32768, 32, 128]}, "per_seq_latency": 0.0841738998889923, "per_doc_latency": 0.22180869579315185, "per_seq_allgather_latency": 0.018863699957728387, "per_seq_attn_latency": 0.06509970091283321, "per_doc_allgather_latency": 0.1153373509645462, "per_doc_attn_latency": 0.10657274983823299, "num_seq_in_batch": 32, "seq_len": 2048, "num_heads": 64, "head_dim": 128, "cp": 2, "tp": 2, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"1": {"per_seq_latency": 1.8224031448364257, "per_doc_latency": 3.9073070526123046, "perseq_allgather_time": 0.6785087905824184, "perseq_attn_time": 1.13714240193367, "perdoc_allgather_time": 2.0966064095497132, "perdoc_attn_time": 1.804006391763687, "output_shape": [32768, 16, 128]}, "0": {"per_seq_latency": 1.3467519760131836, "per_doc_latency": 3.897196960449219, "perseq_allgather_time": 0.16613599956035613, "perseq_attn_time": 1.1520416140556335, "perdoc_allgather_time": 1.9429504156112671, "perdoc_attn_time": 1.9342479884624482, "output_shape": [32768, 16, 128]}, "per_seq_latency": 0.056950098276138304, "per_doc_latency": 0.12210334539413452, "per_seq_allgather_latency": 0.021203399705700576, "per_seq_attn_latency": 0.03600130043923855, "per_doc_allgather_latency": 0.06551895029842854, "per_doc_attn_latency": 0.060445249639451505, "num_seq_in_batch": 32, "seq_len": 2048, "num_heads": 64, "head_dim": 128, "cp": 2, "tp": 4, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"1": {"per_seq_latency": 1.8048831939697265, "per_doc_latency": 2.8816400527954102, "perseq_allgather_time": 1.1260911628603936, "perseq_attn_time": 0.6721119999885559, "perdoc_allgather_time": 1.7192223906517028, "perdoc_attn_time": 1.1557056188583374, "output_shape": [32768, 8, 128]}, "0": {"per_seq_latency": 0.9247280120849609, "per_doc_latency": 2.842366409301758, "perseq_allgather_time": 0.16470720171928405, "perseq_attn_time": 0.6842160016298294, "perdoc_allgather_time": 1.6044688105583191, "perdoc_attn_time": 1.2015199959278107, "output_shape": [32768, 8, 128]}, "per_seq_latency": 0.056402599811553954, "per_doc_latency": 0.09005125164985657, "per_seq_allgather_latency": 0.0351903488393873, "per_seq_attn_latency": 0.02138175005093217, "per_doc_allgather_latency": 0.05372569970786571, "per_doc_attn_latency": 0.03754749987274408, "num_seq_in_batch": 32, "seq_len": 2048, "num_heads": 64, "head_dim": 128, "cp": 2, "tp": 8, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"1": {"per_seq_latency": 7.613902282714844, "per_doc_latency": 16.47834930419922, "perseq_allgather_time": 0.7131232067942619, "perseq_attn_time": 6.894144105911255, "perdoc_allgather_time": 7.057265639305115, "perdoc_attn_time": 9.41441445350647, "output_shape": [32768, 64, 128]}, "0": {"per_seq_latency": 7.448184204101563, "per_doc_latency": 16.484010314941408, "perseq_allgather_time": 0.4559152007102966, "perseq_attn_time": 6.9820815324783325, "perdoc_allgather_time": 7.052555179595947, "perdoc_attn_time": 9.424505615234375, "output_shape": [32768, 64, 128]}, "per_seq_latency": 0.47586889266967775, "per_doc_latency": 1.030250644683838, "per_seq_allgather_latency": 0.04457020042464137, "per_seq_attn_latency": 0.4363800957798958, "per_doc_allgather_latency": 0.44107910245656967, "per_doc_attn_latency": 0.5890316009521485, "num_seq_in_batch": 16, "seq_len": 4096, "num_heads": 64, "head_dim": 128, "cp": 2, "tp": 1, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 3.8482704162597656, "per_doc_latency": 8.470420837402344, "perseq_allgather_time": 0.28328159898519517, "perseq_attn_time": 3.5540719985961915, "perdoc_allgather_time": 3.6575664043426515, "perdoc_attn_time": 4.806009578704834, "output_shape": [32768, 32, 128]}, "1": {"per_seq_latency": 4.2286529541015625, "per_doc_latency": 8.470388793945313, "perseq_allgather_time": 0.6455695807933808, "perseq_attn_time": 3.5763407945632935, "perdoc_allgather_time": 3.6323983907699584, "perdoc_attn_time": 4.831227207183838, "output_shape": [32768, 32, 128]}, "per_seq_latency": 0.26429080963134766, "per_doc_latency": 0.5294013023376465, "per_seq_allgather_latency": 0.0403480987995863, "per_seq_attn_latency": 0.22352129966020584, "per_doc_allgather_latency": 0.22859790027141572, "per_doc_attn_latency": 0.3019517004489899, "num_seq_in_batch": 16, "seq_len": 4096, "num_heads": 64, "head_dim": 128, "cp": 2, "tp": 2, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 2.147889518737793, "per_doc_latency": 4.44007682800293, "perseq_allgather_time": 0.17459519878029822, "perseq_attn_time": 1.9440895974636079, "perdoc_allgather_time": 1.894729596376419, "perdoc_attn_time": 2.538475203514099, "output_shape": [32768, 16, 128]}, "1": {"per_seq_latency": 2.4802127838134767, "per_doc_latency": 4.439176177978515, "perseq_allgather_time": 0.5339440032839775, "perseq_attn_time": 1.9396463990211488, "perdoc_allgather_time": 1.8936016142368317, "perdoc_attn_time": 2.5389104008674623, "output_shape": [32768, 16, 128]}, "per_seq_latency": 0.1550132989883423, "per_doc_latency": 0.2775048017501831, "per_seq_allgather_latency": 0.033371500205248594, "per_seq_attn_latency": 0.12150559984147549, "per_doc_allgather_latency": 0.11842059977352619, "per_doc_attn_latency": 0.1586819000542164, "num_seq_in_batch": 16, "seq_len": 4096, "num_heads": 64, "head_dim": 128, "cp": 2, "tp": 4, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 1.3795519828796388, "per_doc_latency": 2.428641510009766, "perseq_allgather_time": 0.171043199300766, "perseq_attn_time": 1.1809920072555542, "perdoc_allgather_time": 1.0388863921165465, "perdoc_attn_time": 1.378679984807968, "output_shape": [32768, 8, 128]}, "1": {"per_seq_latency": 1.7726032257080078, "per_doc_latency": 2.4653472900390625, "perseq_allgather_time": 0.6385952211916447, "perseq_attn_time": 1.1272047936916352, "perdoc_allgather_time": 1.0786591827869416, "perdoc_attn_time": 1.3799567997455597, "output_shape": [32768, 8, 128]}, "per_seq_latency": 0.11078770160675049, "per_doc_latency": 0.1540842056274414, "per_seq_allgather_latency": 0.03991220132447779, "per_seq_attn_latency": 0.07381200045347214, "per_doc_allgather_latency": 0.06741619892418385, "per_doc_attn_latency": 0.08624729998409748, "num_seq_in_batch": 16, "seq_len": 4096, "num_heads": 64, "head_dim": 128, "cp": 2, "tp": 8, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 13.535322570800782, "per_doc_latency": 22.231588745117186, "perseq_allgather_time": 0.4859776020050049, "perseq_attn_time": 13.039126348495483, "perdoc_allgather_time": 7.037631988525391, "perdoc_attn_time": 15.186899042129516, "output_shape": [32768, 64, 128]}, "1": {"per_seq_latency": 13.58409423828125, "per_doc_latency": 22.228604125976563, "perseq_allgather_time": 0.599606403708458, "perseq_attn_time": 12.97779688835144, "perdoc_allgather_time": 7.125193548202515, "perdoc_attn_time": 15.096737623214722, "output_shape": [32768, 64, 128]}, "per_seq_latency": 1.6980117797851562, "per_doc_latency": 2.7789485931396483, "per_seq_allgather_latency": 0.07495080046355725, "per_seq_attn_latency": 1.6298907935619353, "per_doc_allgather_latency": 0.8906491935253144, "per_doc_attn_latency": 1.8983623802661895, "num_seq_in_batch": 8, "seq_len": 8192, "num_heads": 64, "head_dim": 128, "cp": 2, "tp": 1, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"1": {"per_seq_latency": 7.194723510742188, "per_doc_latency": 11.384671783447265, "perseq_allgather_time": 0.577512001991272, "perseq_attn_time": 6.6104896068573, "perdoc_allgather_time": 3.630294394493103, "perdoc_attn_time": 7.747632026672363, "output_shape": [32768, 32, 128]}, "0": {"per_seq_latency": 6.901131439208984, "per_doc_latency": 11.385619354248046, "perseq_allgather_time": 0.29514559656381606, "perseq_attn_time": 6.595809602737427, "perdoc_allgather_time": 3.679374396800995, "perdoc_attn_time": 7.699281573295593, "output_shape": [32768, 32, 128]}, "per_seq_latency": 0.8993404388427735, "per_doc_latency": 1.4232024192810058, "per_seq_allgather_latency": 0.072189000248909, "per_seq_attn_latency": 0.8263112008571625, "per_doc_allgather_latency": 0.45992179960012436, "per_doc_attn_latency": 0.9684540033340454, "num_seq_in_batch": 8, "seq_len": 8192, "num_heads": 64, "head_dim": 128, "cp": 2, "tp": 2, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 3.710851287841797, "per_doc_latency": 5.916908645629883, "perseq_allgather_time": 0.17273439913988115, "perseq_attn_time": 3.5280304074287416, "perdoc_allgather_time": 1.9008591890335083, "perdoc_attn_time": 4.009169614315033, "output_shape": [32768, 16, 128]}, "1": {"per_seq_latency": 4.052167892456055, "per_doc_latency": 5.9144737243652346, "perseq_allgather_time": 0.5293392084538937, "perseq_attn_time": 3.516158390045166, "perdoc_allgather_time": 1.8812288045883179, "perdoc_attn_time": 4.026419234275818, "output_shape": [32768, 16, 128]}, "per_seq_latency": 0.5065209865570068, "per_doc_latency": 0.7396135807037354, "per_seq_allgather_latency": 0.06616740105673671, "per_seq_attn_latency": 0.4410038009285927, "per_doc_allgather_latency": 0.23760739862918853, "per_doc_attn_latency": 0.5033024042844773, "num_seq_in_batch": 8, "seq_len": 8192, "num_heads": 64, "head_dim": 128, "cp": 2, "tp": 4, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 2.260825538635254, "per_doc_latency": 3.169977569580078, "perseq_allgather_time": 0.17513279914855956, "perseq_attn_time": 2.0105216085910795, "perdoc_allgather_time": 1.0230543971061707, "perdoc_attn_time": 2.1400527954101562, "output_shape": [32768, 8, 128]}, "1": {"per_seq_latency": 2.572907257080078, "per_doc_latency": 3.170110321044922, "perseq_allgather_time": 0.5569440044462681, "perseq_attn_time": 2.009235215187073, "perdoc_allgather_time": 0.9957791984081268, "perdoc_attn_time": 2.167668807506561, "output_shape": [32768, 8, 128]}, "per_seq_latency": 0.32161340713500974, "per_doc_latency": 0.39626379013061525, "per_seq_allgather_latency": 0.06961800055578352, "per_seq_attn_latency": 0.25131520107388494, "per_doc_allgather_latency": 0.12788179963827134, "per_doc_attn_latency": 0.27095860093832014, "num_seq_in_batch": 8, "seq_len": 8192, "num_heads": 64, "head_dim": 128, "cp": 2, "tp": 8, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 25.717208862304688, "per_doc_latency": 34.434957885742186, "perseq_allgather_time": 0.4748832002282143, "perseq_attn_time": 25.23540153503418, "perdoc_allgather_time": 7.177726411819458, "perdoc_attn_time": 27.250318336486817, "output_shape": [32768, 64, 128]}, "1": {"per_seq_latency": 25.71326599121094, "per_doc_latency": 34.3446533203125, "perseq_allgather_time": 0.542799997329712, "perseq_attn_time": 25.163782596588135, "perdoc_allgather_time": 7.366975998878479, "perdoc_attn_time": 26.97101755142212, "output_shape": [32768, 64, 128]}, "per_seq_latency": 6.429302215576172, "per_doc_latency": 8.608739471435547, "per_seq_allgather_latency": 0.135699999332428, "per_seq_attn_latency": 6.308850383758545, "per_doc_allgather_latency": 1.8417439997196197, "per_doc_attn_latency": 6.812579584121704, "num_seq_in_batch": 4, "seq_len": 16384, "num_heads": 64, "head_dim": 128, "cp": 2, "tp": 1, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"1": {"per_seq_latency": 13.17855224609375, "per_doc_latency": 17.371664428710936, "perseq_allgather_time": 0.32172159999608996, "perseq_attn_time": 12.8501136302948, "perdoc_allgather_time": 3.699883186817169, "perdoc_attn_time": 13.665073490142822, "output_shape": [32768, 32, 128]}, "0": {"per_seq_latency": 13.1572021484375, "per_doc_latency": 17.394964599609374, "perseq_allgather_time": 0.2771919995546341, "perseq_attn_time": 12.87300639152527, "perdoc_allgather_time": 3.665491187572479, "perdoc_attn_time": 13.722444772720337, "output_shape": [32768, 32, 128]}, "per_seq_latency": 3.2946380615234374, "per_doc_latency": 4.348741149902343, "per_seq_allgather_latency": 0.08043039999902249, "per_seq_attn_latency": 3.2182515978813173, "per_doc_allgather_latency": 0.9249707967042923, "per_doc_attn_latency": 3.4306111931800842, "num_seq_in_batch": 4, "seq_len": 16384, "num_heads": 64, "head_dim": 128, "cp": 2, "tp": 2, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 6.920076751708985, "per_doc_latency": 8.885169219970702, "perseq_allgather_time": 0.18778719678521155, "perseq_attn_time": 6.721430420875549, "perdoc_allgather_time": 1.8813200116157531, "perdoc_attn_time": 6.996852827072144, "output_shape": [32768, 16, 128]}, "1": {"per_seq_latency": 7.279985809326172, "per_doc_latency": 8.880694580078124, "perseq_allgather_time": 0.5685504004359245, "perseq_attn_time": 6.704723167419433, "perdoc_allgather_time": 1.9081439912319182, "perdoc_attn_time": 6.965788841247559, "output_shape": [32768, 16, 128]}, "per_seq_latency": 1.819996452331543, "per_doc_latency": 2.2212923049926756, "per_seq_allgather_latency": 0.14213760010898113, "per_seq_attn_latency": 1.6803576052188873, "per_doc_allgather_latency": 0.47703599780797956, "per_doc_attn_latency": 1.749213206768036, "num_seq_in_batch": 4, "seq_len": 16384, "num_heads": 64, "head_dim": 128, "cp": 2, "tp": 4, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 3.9763072967529296, "per_doc_latency": 4.7459968566894535, "perseq_allgather_time": 0.19038400053977966, "perseq_attn_time": 3.7744144201278687, "perdoc_allgather_time": 1.0519936025142669, "perdoc_attn_time": 3.6871359825134276, "output_shape": [32768, 8, 128]}, "1": {"per_seq_latency": 4.402163314819336, "per_doc_latency": 4.7453857421875, "perseq_allgather_time": 0.6152032256126404, "perseq_attn_time": 3.7802560091018678, "perdoc_allgather_time": 0.985004797577858, "perdoc_attn_time": 3.7536783814430237, "output_shape": [32768, 8, 128]}, "per_seq_latency": 1.100540828704834, "per_doc_latency": 1.1864992141723634, "per_seq_allgather_latency": 0.1538008064031601, "per_seq_attn_latency": 0.9450640022754669, "per_doc_allgather_latency": 0.2629984006285667, "per_doc_attn_latency": 0.9384195953607559, "num_seq_in_batch": 4, "seq_len": 16384, "num_heads": 64, "head_dim": 128, "cp": 2, "tp": 8, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 50.818624877929686, "per_doc_latency": 60.0173095703125, "perseq_allgather_time": 0.4578048035502434, "perseq_attn_time": 50.35380210876465, "perdoc_allgather_time": 7.183920001983642, "perdoc_attn_time": 52.82638111114502, "output_shape": [32768, 64, 128]}, "1": {"per_seq_latency": 50.824685668945314, "per_doc_latency": 60.04031982421875, "perseq_allgather_time": 1.467214408516884, "perseq_attn_time": 49.350740623474124, "perdoc_allgather_time": 8.487939238548279, "perdoc_attn_time": 51.545609664916995, "output_shape": [32768, 64, 128]}, "per_seq_latency": 25.412342834472657, "per_doc_latency": 30.020159912109374, "per_seq_allgather_latency": 0.733607204258442, "per_seq_attn_latency": 25.176901054382324, "per_doc_allgather_latency": 4.243969619274139, "per_doc_attn_latency": 26.41319055557251, "num_seq_in_batch": 2, "seq_len": 32768, "num_heads": 64, "head_dim": 128, "cp": 2, "tp": 1, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"1": {"per_seq_latency": 25.26062927246094, "per_doc_latency": 30.026351928710938, "perseq_allgather_time": 0.35726879835128783, "perseq_attn_time": 24.89661455154419, "perdoc_allgather_time": 4.196016037464142, "perdoc_attn_time": 25.823659038543703, "output_shape": [32768, 32, 128]}, "0": {"per_seq_latency": 25.27698974609375, "per_doc_latency": 30.05534973144531, "perseq_allgather_time": 0.3691551998257637, "perseq_attn_time": 24.900843143463135, "perdoc_allgather_time": 3.7099552154541016, "perdoc_attn_time": 26.338449573516847, "output_shape": [32768, 32, 128]}, "per_seq_latency": 12.638494873046875, "per_doc_latency": 15.027674865722656, "per_seq_allgather_latency": 0.18457759991288186, "per_seq_attn_latency": 12.450421571731567, "per_doc_allgather_latency": 2.098008018732071, "per_doc_attn_latency": 13.169224786758424, "num_seq_in_batch": 2, "seq_len": 32768, "num_heads": 64, "head_dim": 128, "cp": 2, "tp": 2, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"1": {"per_seq_latency": 13.09990234375, "per_doc_latency": 15.055093383789062, "perseq_allgather_time": 0.2726640023291111, "perseq_attn_time": 12.820496034622192, "perdoc_allgather_time": 1.9256704032421113, "perdoc_attn_time": 13.12272481918335, "output_shape": [32768, 16, 128]}, "0": {"per_seq_latency": 13.086087036132813, "per_doc_latency": 15.050813293457031, "perseq_allgather_time": 0.22527680099010466, "perseq_attn_time": 12.85371675491333, "perdoc_allgather_time": 1.8873679876327514, "perdoc_attn_time": 13.156479978561402, "output_shape": [32768, 16, 128]}, "per_seq_latency": 6.549951171875, "per_doc_latency": 7.527546691894531, "per_seq_allgather_latency": 0.13633200116455554, "per_seq_attn_latency": 6.426858377456665, "per_doc_allgather_latency": 0.9628352016210556, "per_doc_attn_latency": 6.578239989280701, "num_seq_in_batch": 2, "seq_len": 32768, "num_heads": 64, "head_dim": 128, "cp": 2, "tp": 4, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 7.096247863769531, "per_doc_latency": 7.8856353759765625, "perseq_allgather_time": 0.22262079864740372, "perseq_attn_time": 6.8631247758865355, "perdoc_allgather_time": 1.0244559973478318, "perdoc_attn_time": 6.854276823997497, "output_shape": [32768, 8, 128]}, "1": {"per_seq_latency": 7.383168029785156, "per_doc_latency": 7.889060974121094, "perseq_allgather_time": 0.4631888009607792, "perseq_attn_time": 6.913316798210144, "perdoc_allgather_time": 0.9869648009538651, "perdoc_attn_time": 6.895440030097961, "output_shape": [32768, 8, 128]}, "per_seq_latency": 3.691584014892578, "per_doc_latency": 3.944530487060547, "per_seq_allgather_latency": 0.2315944004803896, "per_seq_attn_latency": 3.456658399105072, "per_doc_allgather_latency": 0.5122279986739159, "per_doc_attn_latency": 3.4477200150489806, "num_seq_in_batch": 2, "seq_len": 32768, "num_heads": 64, "head_dim": 128, "cp": 2, "tp": 8, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 100.167138671875, "per_doc_latency": 110.2523193359375, "perseq_allgather_time": 0.45863200128078463, "perseq_attn_time": 99.70149765014648, "perdoc_allgather_time": 7.265104007720947, "perdoc_attn_time": 102.98028335571288, "output_shape": [32768, 64, 128]}, "1": {"per_seq_latency": 100.39768676757812, "per_doc_latency": 110.26282958984375, "perseq_allgather_time": 3.6926511585712434, "perseq_attn_time": 96.69841537475585, "perdoc_allgather_time": 10.81107039451599, "perdoc_attn_time": 99.44519348144532, "output_shape": [32768, 64, 128]}, "per_seq_latency": 100.39768676757812, "per_doc_latency": 110.26282958984375, "per_seq_allgather_latency": 3.6926511585712434, "per_seq_attn_latency": 99.70149765014648, "per_doc_allgather_latency": 10.81107039451599, "per_doc_attn_latency": 102.98028335571288, "num_seq_in_batch": 1, "seq_len": 65536, "num_heads": 64, "head_dim": 128, "cp": 2, "tp": 1, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 50.928076171875, "per_doc_latency": 56.160528564453124, "perseq_allgather_time": 0.2737936019897461, "perseq_attn_time": 50.64721603393555, "perdoc_allgather_time": 3.718225598335266, "perdoc_attn_time": 52.43534545898437, "output_shape": [32768, 32, 128]}, "1": {"per_seq_latency": 50.958865356445315, "per_doc_latency": 56.14822998046875, "perseq_allgather_time": 1.3992079928517343, "perseq_attn_time": 49.552931213378905, "perdoc_allgather_time": 5.579403257369995, "perdoc_attn_time": 50.562080001831056, "output_shape": [32768, 32, 128]}, "per_seq_latency": 50.958865356445315, "per_doc_latency": 56.160528564453124, "per_seq_allgather_latency": 1.3992079928517343, "per_seq_attn_latency": 50.64721603393555, "per_doc_allgather_latency": 5.579403257369995, "per_doc_attn_latency": 52.43534545898437, "num_seq_in_batch": 1, "seq_len": 65536, "num_heads": 64, "head_dim": 128, "cp": 2, "tp": 2, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 25.430772399902345, "per_doc_latency": 28.09671630859375, "perseq_allgather_time": 0.3064543977379799, "perseq_attn_time": 25.117404842376708, "perdoc_allgather_time": 1.9411103904247284, "perdoc_attn_time": 26.1487024307251, "output_shape": [32768, 16, 128]}, "1": {"per_seq_latency": 25.405084228515626, "per_doc_latency": 28.10706481933594, "perseq_allgather_time": 0.2549055993556976, "perseq_attn_time": 25.143635272979736, "perdoc_allgather_time": 2.4027696013450623, "perdoc_attn_time": 25.69767999649048, "output_shape": [32768, 16, 128]}, "per_seq_latency": 25.430772399902345, "per_doc_latency": 28.10706481933594, "per_seq_allgather_latency": 0.3064543977379799, "per_seq_attn_latency": 25.143635272979736, "per_doc_allgather_latency": 2.4027696013450623, "per_doc_attn_latency": 26.1487024307251, "num_seq_in_batch": 1, "seq_len": 65536, "num_heads": 64, "head_dim": 128, "cp": 2, "tp": 4, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 13.226185607910157, "per_doc_latency": 14.294169616699218, "perseq_allgather_time": 0.29362240210175516, "perseq_attn_time": 12.925516843795776, "perdoc_allgather_time": 1.0466352075338363, "perdoc_attn_time": 13.24060640335083, "output_shape": [32768, 8, 128]}, "1": {"per_seq_latency": 13.226324462890625, "per_doc_latency": 14.311622619628906, "perseq_allgather_time": 0.15912320017814635, "perseq_attn_time": 13.060563135147095, "perdoc_allgather_time": 1.0400303959846497, "perdoc_attn_time": 13.264908838272095, "output_shape": [32768, 8, 128]}, "per_seq_latency": 13.226324462890625, "per_doc_latency": 14.311622619628906, "per_seq_allgather_latency": 0.29362240210175516, "per_seq_attn_latency": 13.060563135147095, "per_doc_allgather_latency": 1.0466352075338363, "per_doc_attn_latency": 13.264908838272095, "num_seq_in_batch": 1, "seq_len": 65536, "num_heads": 64, "head_dim": 128, "cp": 2, "tp": 8, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 1.2568559646606445, "per_doc_latency": 111.40789794921875, "perseq_allgather_time": 0.51873120367527, "perseq_attn_time": 0.7048127949237823, "perdoc_allgather_time": 87.22390327453613, "perdoc_attn_time": 24.160489559173584, "output_shape": [16384, 64, 128]}, "3": {"per_seq_latency": 2.333769607543945, "per_doc_latency": 107.903857421875, "perseq_allgather_time": 1.623702374100685, "perseq_attn_time": 0.703356796503067, "perdoc_allgather_time": 84.07627410888672, "perdoc_attn_time": 23.813486289978027, "output_shape": [16384, 64, 128]}, "2": {"per_seq_latency": 2.3333967208862303, "per_doc_latency": 108.2532958984375, "perseq_allgather_time": 1.6200495928525924, "perseq_attn_time": 0.7067967921495437, "perdoc_allgather_time": 84.62854881286621, "perdoc_attn_time": 23.6113263130188, "output_shape": [16384, 64, 128]}, "1": {"per_seq_latency": 2.3359920501708986, "per_doc_latency": 108.79434814453126, "perseq_allgather_time": 1.6229472398757934, "perseq_attn_time": 0.7066543966531753, "perdoc_allgather_time": 85.62574577331543, "perdoc_attn_time": 23.155590343475343, "output_shape": [16384, 64, 128]}, "per_seq_latency": 0.002281242236495018, "per_doc_latency": 0.10879677534103394, "per_seq_allgather_latency": 0.0015856468497077003, "per_seq_attn_latency": 0.0006902312423335388, "per_doc_allgather_latency": 0.08517959304153919, "per_doc_attn_latency": 0.023594228085130453, "num_seq_in_batch": 1024, "seq_len": 64, "num_heads": 64, "head_dim": 128, "cp": 4, "tp": 1, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 0.8003583908081054, "per_doc_latency": 104.902294921875, "perseq_allgather_time": 0.3385903984308243, "perseq_attn_time": 0.41270879507064817, "perdoc_allgather_time": 83.94759483337403, "perdoc_attn_time": 20.701908540725707, "output_shape": [16384, 32, 128]}, "3": {"per_seq_latency": 1.4190048217773437, "per_doc_latency": 107.05606689453126, "perseq_allgather_time": 1.006630390882492, "perseq_attn_time": 0.4056528002023697, "perdoc_allgather_time": 85.15076713562011, "perdoc_attn_time": 21.89044933319092, "output_shape": [16384, 32, 128]}, "1": {"per_seq_latency": 1.4182496070861816, "per_doc_latency": 104.95618896484375, "perseq_allgather_time": 1.0095695808529854, "perseq_attn_time": 0.4021583989262581, "perdoc_allgather_time": 83.72303314208985, "perdoc_attn_time": 21.218702268600463, "output_shape": [16384, 32, 128]}, "2": {"per_seq_latency": 1.4183103561401367, "per_doc_latency": 107.323876953125, "perseq_allgather_time": 1.0127647936344146, "perseq_attn_time": 0.39896639734506606, "perdoc_allgather_time": 85.35599327087402, "perdoc_attn_time": 21.953519821166992, "output_shape": [16384, 32, 128]}, "per_seq_latency": 0.0013857468962669372, "per_doc_latency": 0.10480847358703613, "per_seq_allgather_latency": 0.000989028118783608, "per_seq_attn_latency": 0.00040303593268617985, "per_doc_allgather_latency": 0.08335546217858791, "per_doc_attn_latency": 0.02143898420035839, "num_seq_in_batch": 1024, "seq_len": 64, "num_heads": 64, "head_dim": 128, "cp": 4, "tp": 2, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"3": {"per_seq_latency": 0.9812576293945312, "per_doc_latency": 105.5333740234375, "perseq_allgather_time": 0.5536880098283291, "perseq_attn_time": 0.4138080023229122, "perdoc_allgather_time": 84.94706192016602, "perdoc_attn_time": 20.42022075653076, "output_shape": [16384, 16, 128]}, "0": {"per_seq_latency": 0.6905776023864746, "per_doc_latency": 105.608203125, "perseq_allgather_time": 0.4062623977661133, "perseq_attn_time": 0.2522799991071224, "perdoc_allgather_time": 84.59237365722656, "perdoc_attn_time": 20.481163120269777, "output_shape": [16384, 16, 128]}, "2": {"per_seq_latency": 0.9806688308715821, "per_doc_latency": 105.164208984375, "perseq_allgather_time": 0.7210224144160747, "perseq_attn_time": 0.2530064009130001, "perdoc_allgather_time": 84.45924949645996, "perdoc_attn_time": 20.533361625671386, "output_shape": [16384, 16, 128]}, "1": {"per_seq_latency": 0.9810303688049317, "per_doc_latency": 105.145849609375, "perseq_allgather_time": 0.7039568141102791, "perseq_attn_time": 0.2706415973603725, "perdoc_allgather_time": 84.4479248046875, "perdoc_attn_time": 20.543502235412596, "output_shape": [16384, 16, 128]}, "per_seq_latency": 0.0009582594037055969, "per_doc_latency": 0.10313301086425782, "per_seq_allgather_latency": 0.000704123451578198, "per_seq_attn_latency": 0.00040410937726846895, "per_doc_allgather_latency": 0.08295611515641213, "per_doc_attn_latency": 0.020062013901770114, "num_seq_in_batch": 1024, "seq_len": 64, "num_heads": 64, "head_dim": 128, "cp": 4, "tp": 4, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"3": {"per_seq_latency": 1.0045056343078613, "per_doc_latency": 103.30185546875, "perseq_allgather_time": 0.8250368118286133, "perseq_attn_time": 0.17142719998955727, "perdoc_allgather_time": 83.00744895935058, "perdoc_attn_time": 19.93772134780884, "output_shape": [16384, 8, 128]}, "0": {"per_seq_latency": 0.5207248210906983, "per_doc_latency": 102.90762939453126, "perseq_allgather_time": 0.2739103987812996, "perseq_attn_time": 0.17566080018877983, "perdoc_allgather_time": 82.64597930908204, "perdoc_attn_time": 19.62768964767456, "output_shape": [16384, 8, 128]}, "1": {"per_seq_latency": 1.0052831649780274, "per_doc_latency": 103.5050537109375, "perseq_allgather_time": 0.8145743794739246, "perseq_attn_time": 0.17841279804706572, "perdoc_allgather_time": 83.71720886230469, "perdoc_attn_time": 19.444875526428223, "output_shape": [16384, 8, 128]}, "2": {"per_seq_latency": 1.0056943893432617, "per_doc_latency": 102.77025146484375, "perseq_allgather_time": 0.8252464056015014, "perseq_attn_time": 0.17229279950261117, "perdoc_allgather_time": 82.78912506103515, "perdoc_attn_time": 19.642747116088866, "output_shape": [16384, 8, 128]}, "per_seq_latency": 0.000982123427093029, "per_doc_latency": 0.1010791540145874, "per_seq_allgather_latency": 0.0008059046929702162, "per_seq_attn_latency": 0.00017423124809283762, "per_doc_allgather_latency": 0.08175508677959442, "per_doc_attn_latency": 0.01947043100371957, "num_seq_in_batch": 1024, "seq_len": 64, "num_heads": 64, "head_dim": 128, "cp": 4, "tp": 8, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"3": {"per_seq_latency": 1.7835615158081055, "per_doc_latency": 53.12178344726563, "perseq_allgather_time": 0.9992607951164245, "perseq_attn_time": 0.6621360033750534, "perdoc_allgather_time": 39.383740997314455, "perdoc_attn_time": 13.731296062469482, "output_shape": [16384, 64, 128]}, "0": {"per_seq_latency": 1.3682991981506347, "per_doc_latency": 55.26029663085937, "perseq_allgather_time": 0.6894704073667526, "perseq_attn_time": 0.658579197525978, "perdoc_allgather_time": 41.22582588195801, "perdoc_attn_time": 14.023892641067505, "output_shape": [16384, 64, 128]}, "2": {"per_seq_latency": 1.7826095581054688, "per_doc_latency": 53.77036743164062, "perseq_allgather_time": 1.1164352118968963, "perseq_attn_time": 0.6595887959003448, "perdoc_allgather_time": 39.985128021240236, "perdoc_attn_time": 13.778300857543945, "output_shape": [16384, 64, 128]}, "1": {"per_seq_latency": 1.7837568283081056, "per_doc_latency": 53.458746337890624, "perseq_allgather_time": 1.1206416189670563, "perseq_attn_time": 0.6566767930984497, "perdoc_allgather_time": 41.21474494934082, "perdoc_attn_time": 12.237537574768066, "output_shape": [16384, 64, 128]}, "per_seq_latency": 0.0034839000552892687, "per_doc_latency": 0.10793026685714721, "per_seq_allgather_latency": 0.002188753162045032, "per_seq_attn_latency": 0.0012932343815919012, "per_doc_allgather_latency": 0.08051919117569924, "per_doc_attn_latency": 0.02739041531458497, "num_seq_in_batch": 512, "seq_len": 128, "num_heads": 64, "head_dim": 128, "cp": 4, "tp": 1, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 0.7749567985534668, "per_doc_latency": 52.298760986328126, "perseq_allgather_time": 0.342732797563076, "perseq_attn_time": 0.38576320111751555, "perdoc_allgather_time": 42.10244522094727, "perdoc_attn_time": 10.119152069091797, "output_shape": [16384, 32, 128]}, "1": {"per_seq_latency": 1.1232768058776856, "per_doc_latency": 52.8293212890625, "perseq_allgather_time": 0.7313040062785149, "perseq_attn_time": 0.3855023980140686, "perdoc_allgather_time": 39.63917751312256, "perdoc_attn_time": 13.176815938949584, "output_shape": [16384, 32, 128]}, "3": {"per_seq_latency": 1.1230159759521485, "per_doc_latency": 52.05720825195313, "perseq_allgather_time": 0.7323232159018517, "perseq_attn_time": 0.38402559906244277, "perdoc_allgather_time": 39.41760787963867, "perdoc_attn_time": 12.624899196624757, "output_shape": [16384, 32, 128]}, "2": {"per_seq_latency": 1.1230112075805665, "per_doc_latency": 52.382757568359374, "perseq_allgather_time": 0.7363743931055069, "perseq_attn_time": 0.38003199845552443, "perdoc_allgather_time": 39.70331020355225, "perdoc_attn_time": 12.665598392486572, "output_shape": [16384, 32, 128]}, "per_seq_latency": 0.0021939000114798548, "per_doc_latency": 0.10318226814270019, "per_seq_allgather_latency": 0.0014382312365341932, "per_seq_attn_latency": 0.0007534437521826476, "per_doc_allgather_latency": 0.08223133832216263, "per_doc_attn_latency": 0.025735968630760907, "num_seq_in_batch": 512, "seq_len": 128, "num_heads": 64, "head_dim": 128, "cp": 4, "tp": 2, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 0.44647998809814454, "per_doc_latency": 51.19841613769531, "perseq_allgather_time": 0.1841600000858307, "perseq_attn_time": 0.24609919860959054, "perdoc_allgather_time": 39.48115692138672, "perdoc_attn_time": 11.490823936462402, "output_shape": [16384, 16, 128]}, "3": {"per_seq_latency": 0.7231760025024414, "per_doc_latency": 51.94178466796875, "perseq_allgather_time": 0.4752880044281483, "perseq_attn_time": 0.24112000167369843, "perdoc_allgather_time": 39.756971168518064, "perdoc_attn_time": 12.167092609405518, "output_shape": [16384, 16, 128]}, "2": {"per_seq_latency": 0.7233248233795166, "per_doc_latency": 52.636480712890624, "perseq_allgather_time": 0.4725104033946991, "perseq_attn_time": 0.24425920024514197, "perdoc_allgather_time": 40.54276599884033, "perdoc_attn_time": 12.062609577178955, "output_shape": [16384, 16, 128]}, "1": {"per_seq_latency": 0.722763204574585, "per_doc_latency": 52.10404663085937, "perseq_allgather_time": 0.4710223965346813, "perseq_attn_time": 0.24508799985051155, "perdoc_allgather_time": 39.75290412902832, "perdoc_attn_time": 12.335611248016358, "output_shape": [16384, 16, 128]}, "per_seq_latency": 0.0014127437956631184, "per_doc_latency": 0.1028056263923645, "per_seq_allgather_latency": 0.0009282968836487271, "per_seq_attn_latency": 0.0004806624972843565, "per_doc_allgather_latency": 0.07918508984148502, "per_doc_attn_latency": 0.02409299071878195, "num_seq_in_batch": 512, "seq_len": 128, "num_heads": 64, "head_dim": 128, "cp": 4, "tp": 4, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 0.45567998886108396, "per_doc_latency": 50.03058776855469, "perseq_allgather_time": 0.2468639999628067, "perseq_attn_time": 0.17504960298538208, "perdoc_allgather_time": 38.53859977722168, "perdoc_attn_time": 11.156646490097046, "output_shape": [16384, 8, 128]}, "2": {"per_seq_latency": 0.9738991737365723, "per_doc_latency": 50.240945434570314, "perseq_allgather_time": 0.7992800131440163, "perseq_attn_time": 0.16498240008950232, "perdoc_allgather_time": 38.79903717041016, "perdoc_attn_time": 11.299094486236573, "output_shape": [16384, 8, 128]}, "3": {"per_seq_latency": 0.9740575790405274, "per_doc_latency": 50.47240295410156, "perseq_allgather_time": 0.7960271812975407, "perseq_attn_time": 0.16824160069227218, "perdoc_allgather_time": 38.976440048217775, "perdoc_attn_time": 11.333193492889404, "output_shape": [16384, 8, 128]}, "1": {"per_seq_latency": 0.9737343788146973, "per_doc_latency": 50.34053955078125, "perseq_allgather_time": 0.7968528047204018, "perseq_attn_time": 0.167247998714447, "perdoc_allgather_time": 38.86428642272949, "perdoc_attn_time": 11.323687934875489, "output_shape": [16384, 8, 128]}, "per_seq_latency": 0.00190245620906353, "per_doc_latency": 0.09857891201972961, "per_seq_allgather_latency": 0.0015610937756719069, "per_seq_attn_latency": 0.0003418937558308244, "per_doc_allgather_latency": 0.07612585946917534, "per_doc_attn_latency": 0.022135143540799616, "num_seq_in_batch": 512, "seq_len": 128, "num_heads": 64, "head_dim": 128, "cp": 4, "tp": 8, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"3": {"per_seq_latency": 1.9131296157836915, "per_doc_latency": 27.49674072265625, "perseq_allgather_time": 1.08609439432621, "perseq_attn_time": 0.8203231960535049, "perdoc_allgather_time": 21.214830207824708, "perdoc_attn_time": 6.275222420692444, "output_shape": [16384, 64, 128]}, "0": {"per_seq_latency": 1.3478464126586913, "per_doc_latency": 27.588906860351564, "perseq_allgather_time": 0.5217392027378083, "perseq_attn_time": 0.8163376003503799, "perdoc_allgather_time": 21.28099822998047, "perdoc_attn_time": 6.3013935565948485, "output_shape": [16384, 64, 128]}, "2": {"per_seq_latency": 1.9129600524902344, "per_doc_latency": 27.598870849609376, "perseq_allgather_time": 1.0926703989505768, "perseq_attn_time": 0.8137215971946716, "perdoc_allgather_time": 21.725808143615723, "perdoc_attn_time": 5.8665199995040895, "output_shape": [16384, 64, 128]}, "1": {"per_seq_latency": 1.911307144165039, "per_doc_latency": 27.75552978515625, "perseq_allgather_time": 1.086603182554245, "perseq_attn_time": 0.8182719975709916, "perdoc_allgather_time": 21.369622325897218, "perdoc_attn_time": 6.379516839981079, "output_shape": [16384, 64, 128]}, "per_seq_latency": 0.007473162561655045, "per_doc_latency": 0.1084200382232666, "per_seq_allgather_latency": 0.004268243745900691, "per_seq_attn_latency": 0.0032043874845840035, "per_doc_allgather_latency": 0.08486643806099892, "per_doc_attn_latency": 0.02491998765617609, "num_seq_in_batch": 256, "seq_len": 256, "num_heads": 64, "head_dim": 128, "cp": 4, "tp": 1, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"3": {"per_seq_latency": 1.1912336349487305, "per_doc_latency": 26.690325927734374, "perseq_allgather_time": 0.7284655809402466, "perseq_attn_time": 0.4560303956270218, "perdoc_allgather_time": 21.110782432556153, "perdoc_attn_time": 5.572787165641785, "output_shape": [16384, 32, 128]}, "2": {"per_seq_latency": 1.1916319847106933, "per_doc_latency": 26.23066101074219, "perseq_allgather_time": 0.7242832005023956, "perseq_attn_time": 0.46078080087900164, "perdoc_allgather_time": 20.671228694915772, "perdoc_attn_time": 5.552932834625244, "output_shape": [16384, 32, 128]}, "0": {"per_seq_latency": 0.8414400100708008, "per_doc_latency": 26.70975341796875, "perseq_allgather_time": 0.3301568031311035, "perseq_attn_time": 0.4658543989062309, "perdoc_allgather_time": 21.098174381256104, "perdoc_attn_time": 5.56684000492096, "output_shape": [16384, 32, 128]}, "1": {"per_seq_latency": 1.1917872428894043, "per_doc_latency": 26.487713623046876, "perseq_allgather_time": 0.7255151927471161, "perseq_attn_time": 0.45978560000658036, "perdoc_allgather_time": 20.888019180297853, "perdoc_attn_time": 5.593238401412964, "output_shape": [16384, 32, 128]}, "per_seq_latency": 0.0046554189175367355, "per_doc_latency": 0.10433497428894042, "per_seq_allgather_latency": 0.0028455686755478383, "per_seq_attn_latency": 0.0018197437457274646, "per_doc_allgather_latency": 0.08246399387717247, "per_doc_attn_latency": 0.02184858750551939, "num_seq_in_batch": 256, "seq_len": 256, "num_heads": 64, "head_dim": 128, "cp": 4, "tp": 2, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"3": {"per_seq_latency": 1.0399920463562011, "per_doc_latency": 25.826214599609376, "perseq_allgather_time": 0.750204810500145, "perseq_attn_time": 0.28300160020589826, "perdoc_allgather_time": 20.487174415588377, "perdoc_attn_time": 5.324199962615967, "output_shape": [16384, 16, 128]}, "0": {"per_seq_latency": 0.5760015964508056, "per_doc_latency": 26.001956176757812, "perseq_allgather_time": 0.23627519756555557, "perseq_attn_time": 0.28741919845342634, "perdoc_allgather_time": 20.56368637084961, "perdoc_attn_time": 5.3370976686477665, "output_shape": [16384, 16, 128]}, "1": {"per_seq_latency": 1.040459156036377, "per_doc_latency": 25.775408935546874, "perseq_allgather_time": 0.7498911984264851, "perseq_attn_time": 0.2841616004705429, "perdoc_allgather_time": 20.411654567718507, "perdoc_attn_time": 5.347004747390747, "output_shape": [16384, 16, 128]}, "2": {"per_seq_latency": 1.040223979949951, "per_doc_latency": 26.0427978515625, "perseq_allgather_time": 0.7530335858464241, "perseq_attn_time": 0.280598396062851, "perdoc_allgather_time": 20.666550159454346, "perdoc_attn_time": 5.36290557384491, "output_shape": [16384, 16, 128]}, "per_seq_latency": 0.0040642935782670975, "per_doc_latency": 0.10172967910766602, "per_seq_allgather_latency": 0.002941537444712594, "per_seq_attn_latency": 0.0011227312439586966, "per_doc_allgather_latency": 0.08072871156036854, "per_doc_attn_latency": 0.02094884989783168, "num_seq_in_batch": 256, "seq_len": 256, "num_heads": 64, "head_dim": 128, "cp": 4, "tp": 4, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 0.5049071788787842, "per_doc_latency": 25.99468994140625, "perseq_allgather_time": 0.24732480198144913, "perseq_attn_time": 0.1967119976878166, "perdoc_allgather_time": 22.4443151473999, "perdoc_attn_time": 3.3949311852455137, "output_shape": [16384, 8, 128]}, "3": {"per_seq_latency": 0.8054719924926758, "per_doc_latency": 26.256005859375, "perseq_allgather_time": 0.6071856074035168, "perseq_attn_time": 0.18991360142827035, "perdoc_allgather_time": 21.23473310470581, "perdoc_attn_time": 4.942947173118592, "output_shape": [16384, 8, 128]}, "1": {"per_seq_latency": 0.8056320190429688, "per_doc_latency": 26.04510498046875, "perseq_allgather_time": 0.6060207799077034, "perseq_attn_time": 0.192009599506855, "perdoc_allgather_time": 21.045548820495604, "perdoc_attn_time": 4.932371187210083, "output_shape": [16384, 8, 128]}, "2": {"per_seq_latency": 0.8056544303894043, "per_doc_latency": 26.007717895507813, "perseq_allgather_time": 0.6079856224358082, "perseq_attn_time": 0.18990400061011314, "perdoc_allgather_time": 20.976620960235596, "perdoc_attn_time": 4.946662402153015, "output_shape": [16384, 8, 128]}, "per_seq_latency": 0.0031470876187086106, "per_doc_latency": 0.1025625228881836, "per_seq_allgather_latency": 0.002374943837639876, "per_seq_attn_latency": 0.0007684062409680336, "per_doc_allgather_latency": 0.08767310604453087, "per_doc_attn_latency": 0.019322900008410214, "num_seq_in_batch": 256, "seq_len": 256, "num_heads": 64, "head_dim": 128, "cp": 4, "tp": 8, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"3": {"per_seq_latency": 2.228256034851074, "per_doc_latency": 17.513002014160158, "perseq_allgather_time": 1.2013456165790557, "perseq_attn_time": 1.0200800061225892, "perdoc_allgather_time": 13.095728158950806, "perdoc_attn_time": 4.410502362251282, "output_shape": [16384, 64, 128]}, "0": {"per_seq_latency": 1.5732640266418456, "per_doc_latency": 17.499058532714844, "perseq_allgather_time": 0.5208207994699479, "perseq_attn_time": 1.020665603876114, "perdoc_allgather_time": 12.786683130264283, "perdoc_attn_time": 4.701790404319763, "output_shape": [16384, 64, 128]}, "2": {"per_seq_latency": 2.2279327392578123, "per_doc_latency": 17.537303161621093, "perseq_allgather_time": 1.2085311859846115, "perseq_attn_time": 1.012827205657959, "perdoc_allgather_time": 13.021462392807006, "perdoc_attn_time": 4.509248065948486, "output_shape": [16384, 64, 128]}, "1": {"per_seq_latency": 2.2267391204833986, "per_doc_latency": 17.434605407714844, "perseq_allgather_time": 1.2026575922966003, "perseq_attn_time": 1.0177791953086852, "perdoc_allgather_time": 12.719969606399536, "perdoc_attn_time": 4.698140811920166, "output_shape": [16384, 64, 128]}, "per_seq_latency": 0.017408250272274016, "per_doc_latency": 0.1370101809501648, "per_seq_allgather_latency": 0.009441649890504777, "per_seq_attn_latency": 0.00797395003028214, "per_doc_allgather_latency": 0.10231037624180317, "per_doc_attn_latency": 0.03673273753374815, "num_seq_in_batch": 128, "seq_len": 512, "num_heads": 64, "head_dim": 128, "cp": 4, "tp": 1, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 0.944001579284668, "per_doc_latency": 15.472987365722656, "perseq_allgather_time": 0.3016160011291504, "perseq_attn_time": 0.5684239983558654, "perdoc_allgather_time": 12.266582345962524, "perdoc_attn_time": 3.1955471873283385, "output_shape": [16384, 32, 128]}, "3": {"per_seq_latency": 1.3983087539672852, "per_doc_latency": 15.264480590820312, "perseq_allgather_time": 0.8225152179598808, "perseq_attn_time": 0.5689664036035538, "perdoc_allgather_time": 12.112737607955932, "perdoc_attn_time": 3.1425504207611086, "output_shape": [16384, 32, 128]}, "2": {"per_seq_latency": 1.398574447631836, "per_doc_latency": 15.176084899902344, "perseq_allgather_time": 0.8219711914658546, "perseq_attn_time": 0.5699456006288528, "perdoc_allgather_time": 12.018975925445556, "perdoc_attn_time": 3.150145637989044, "output_shape": [16384, 32, 128]}, "1": {"per_seq_latency": 1.3981599807739258, "per_doc_latency": 15.318460083007812, "perseq_allgather_time": 0.8141840025782585, "perseq_attn_time": 0.5775296032428742, "perdoc_allgather_time": 12.281182241439819, "perdoc_attn_time": 3.0308703899383547, "output_shape": [16384, 32, 128]}, "per_seq_latency": 0.010926362872123719, "per_doc_latency": 0.12088271379470825, "per_seq_allgather_latency": 0.006425900140311569, "per_seq_attn_latency": 0.0045119500253349544, "per_doc_allgather_latency": 0.09594673626124858, "per_doc_attn_latency": 0.024965212401002645, "num_seq_in_batch": 128, "seq_len": 512, "num_heads": 64, "head_dim": 128, "cp": 4, "tp": 2, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 0.6470448017120362, "per_doc_latency": 15.38670654296875, "perseq_allgather_time": 0.240904001891613, "perseq_attn_time": 0.355001600086689, "perdoc_allgather_time": 12.40168318748474, "perdoc_attn_time": 2.8849776148796082, "output_shape": [16384, 16, 128]}, "2": {"per_seq_latency": 1.0771408081054688, "per_doc_latency": 15.983950805664062, "perseq_allgather_time": 0.7212943963706493, "perseq_attn_time": 0.34876159727573397, "perdoc_allgather_time": 13.37380805015564, "perdoc_attn_time": 2.603473591804504, "output_shape": [16384, 16, 128]}, "3": {"per_seq_latency": 1.0769776344299316, "per_doc_latency": 15.749842834472656, "perseq_allgather_time": 0.7267632111907005, "perseq_attn_time": 0.3435696020722389, "perdoc_allgather_time": 13.020510387420654, "perdoc_attn_time": 2.722601580619812, "output_shape": [16384, 16, 128]}, "1": {"per_seq_latency": 1.0772383689880372, "per_doc_latency": 15.483885192871094, "perseq_allgather_time": 0.7267888158559799, "perseq_attn_time": 0.34398720115423204, "perdoc_allgather_time": 12.861222410202027, "perdoc_attn_time": 2.616214394569397, "output_shape": [16384, 16, 128]}, "per_seq_latency": 0.00841592475771904, "per_doc_latency": 0.12487461566925048, "per_seq_allgather_latency": 0.005678037623874843, "per_seq_attn_latency": 0.002773450000677258, "per_doc_allgather_latency": 0.10448287539184094, "per_doc_attn_latency": 0.02253888761624694, "num_seq_in_batch": 128, "seq_len": 512, "num_heads": 64, "head_dim": 128, "cp": 4, "tp": 4, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 0.5417327880859375, "per_doc_latency": 14.566282653808594, "perseq_allgather_time": 0.2550992019474506, "perseq_attn_time": 0.23295200020074844, "perdoc_allgather_time": 11.59331192970276, "perdoc_attn_time": 2.8612287878990172, "output_shape": [16384, 8, 128]}, "3": {"per_seq_latency": 1.0246591567993164, "per_doc_latency": 14.38103790283203, "perseq_allgather_time": 0.7916672185063363, "perseq_attn_time": 0.2260880008339882, "perdoc_allgather_time": 11.56020803451538, "perdoc_attn_time": 2.775260806083679, "output_shape": [16384, 8, 128]}, "1": {"per_seq_latency": 1.0242159843444825, "per_doc_latency": 14.415155029296875, "perseq_allgather_time": 0.7916208110749722, "perseq_attn_time": 0.2261247992515564, "perdoc_allgather_time": 11.633785581588745, "perdoc_attn_time": 2.761647975444794, "output_shape": [16384, 8, 128]}, "2": {"per_seq_latency": 1.0242688179016113, "per_doc_latency": 14.385614013671875, "perseq_allgather_time": 0.7899184055626393, "perseq_attn_time": 0.22769759893417357, "perdoc_allgather_time": 12.360843276977539, "perdoc_attn_time": 1.9998127937316894, "output_shape": [16384, 8, 128]}, "per_seq_latency": 0.00800514966249466, "per_doc_latency": 0.11379908323287964, "per_seq_allgather_latency": 0.006184900144580752, "per_seq_attn_latency": 0.0018199375015683472, "per_doc_allgather_latency": 0.09656908810138702, "per_doc_attn_latency": 0.022353349905461072, "num_seq_in_batch": 128, "seq_len": 512, "num_heads": 64, "head_dim": 128, "cp": 4, "tp": 8, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 1.8879135131835938, "per_doc_latency": 12.280838775634766, "perseq_allgather_time": 0.5267215967178345, "perseq_attn_time": 1.338804793357849, "perdoc_allgather_time": 8.183270502090455, "perdoc_attn_time": 4.087247967720032, "output_shape": [16384, 64, 128]}, "3": {"per_seq_latency": 2.286654472351074, "per_doc_latency": 12.304472351074219, "perseq_allgather_time": 0.934860783815384, "perseq_attn_time": 1.3450271904468536, "perdoc_allgather_time": 8.508049488067627, "perdoc_attn_time": 3.7897135972976685, "output_shape": [16384, 64, 128]}, "2": {"per_seq_latency": 2.285505676269531, "per_doc_latency": 12.301862335205078, "perseq_allgather_time": 0.949483209848404, "perseq_attn_time": 1.3294831931591033, "perdoc_allgather_time": 8.3932288646698, "perdoc_attn_time": 3.9020944118499754, "output_shape": [16384, 64, 128]}, "1": {"per_seq_latency": 2.2857616424560545, "per_doc_latency": 12.301195526123047, "perseq_allgather_time": 0.9434592217206955, "perseq_attn_time": 1.3357680022716523, "perdoc_allgather_time": 8.32887511253357, "perdoc_attn_time": 3.9658559918403626, "output_shape": [16384, 64, 128]}, "per_seq_latency": 0.035728976130485535, "per_doc_latency": 0.19225738048553467, "per_seq_allgather_latency": 0.014835675153881312, "per_seq_attn_latency": 0.021016049850732087, "per_doc_allgather_latency": 0.13293827325105667, "per_doc_attn_latency": 0.0638632494956255, "num_seq_in_batch": 64, "seq_len": 1024, "num_heads": 64, "head_dim": 128, "cp": 4, "tp": 1, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"3": {"per_seq_latency": 1.5652624130249024, "per_doc_latency": 7.976020812988281, "perseq_allgather_time": 0.8115920171141624, "perseq_attn_time": 0.7470160037279129, "perdoc_allgather_time": 5.692659211158753, "perdoc_attn_time": 2.2766799926757812, "output_shape": [16384, 32, 128]}, "0": {"per_seq_latency": 1.155624008178711, "per_doc_latency": 8.029608154296875, "perseq_allgather_time": 0.36698399633169176, "perseq_attn_time": 0.7519279986619949, "perdoc_allgather_time": 5.439483237266541, "perdoc_attn_time": 2.5761247873306274, "output_shape": [16384, 32, 128]}, "2": {"per_seq_latency": 1.5646080017089843, "per_doc_latency": 8.077918243408202, "perseq_allgather_time": 0.8143168106675148, "perseq_attn_time": 0.7436912059783936, "perdoc_allgather_time": 5.733019208908081, "perdoc_attn_time": 2.3374623894691466, "output_shape": [16384, 32, 128]}, "1": {"per_seq_latency": 1.5654000282287597, "per_doc_latency": 8.032061004638672, "perseq_allgather_time": 0.7825551733374596, "perseq_attn_time": 0.7660367965698243, "perdoc_allgather_time": 5.676707243919372, "perdoc_attn_time": 2.3489248037338255, "output_shape": [16384, 32, 128]}, "per_seq_latency": 0.02445937544107437, "per_doc_latency": 0.12621747255325316, "per_seq_allgather_latency": 0.012723700166679919, "per_seq_attn_latency": 0.011969324946403504, "per_doc_allgather_latency": 0.08957842513918876, "per_doc_attn_latency": 0.040251949802041054, "num_seq_in_batch": 64, "seq_len": 1024, "num_heads": 64, "head_dim": 128, "cp": 4, "tp": 2, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 0.7152095794677734, "per_doc_latency": 7.002094268798828, "perseq_allgather_time": 0.22030559927225113, "perseq_attn_time": 0.45921439826488497, "perdoc_allgather_time": 5.259099125862122, "perdoc_attn_time": 1.7029807984828949, "output_shape": [16384, 16, 128]}, "3": {"per_seq_latency": 1.1441807746887207, "per_doc_latency": 6.782901000976563, "perseq_allgather_time": 0.686944018304348, "perseq_attn_time": 0.4504671975970268, "perdoc_allgather_time": 5.171479988098144, "perdoc_attn_time": 1.6038656115531922, "output_shape": [16384, 16, 128]}, "2": {"per_seq_latency": 1.1435728073120117, "per_doc_latency": 6.869694519042969, "perseq_allgather_time": 0.6879519894719124, "perseq_attn_time": 0.4489760011434555, "perdoc_allgather_time": 5.287476801872254, "perdoc_attn_time": 1.5657984137535095, "output_shape": [16384, 16, 128]}, "1": {"per_seq_latency": 1.1437312126159669, "per_doc_latency": 6.973417663574219, "perseq_allgather_time": 0.6907135985791684, "perseq_attn_time": 0.4465376004576683, "perdoc_allgather_time": 5.320243263244629, "perdoc_attn_time": 1.6467023968696595, "output_shape": [16384, 16, 128]}, "per_seq_latency": 0.01787782460451126, "per_doc_latency": 0.10940772294998169, "per_seq_allgather_latency": 0.010792399977799506, "per_seq_attn_latency": 0.007175224972888828, "per_doc_allgather_latency": 0.08312880098819733, "per_doc_attn_latency": 0.026609074976295232, "num_seq_in_batch": 64, "seq_len": 1024, "num_heads": 64, "head_dim": 128, "cp": 4, "tp": 4, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 0.5848512172698974, "per_doc_latency": 6.559960174560547, "perseq_allgather_time": 0.2538383975625038, "perseq_attn_time": 0.3030816033482552, "perdoc_allgather_time": 4.992972779273987, "perdoc_attn_time": 1.496775996685028, "output_shape": [16384, 8, 128]}, "3": {"per_seq_latency": 0.9964256286621094, "per_doc_latency": 6.496782684326172, "perseq_allgather_time": 0.6962335795164108, "perseq_attn_time": 0.2934943988919258, "perdoc_allgather_time": 4.983657646179199, "perdoc_attn_time": 1.487391996383667, "output_shape": [16384, 8, 128]}, "2": {"per_seq_latency": 0.9969807624816894, "per_doc_latency": 6.661534118652344, "perseq_allgather_time": 0.6942479901015759, "perseq_attn_time": 0.29622880071401597, "perdoc_allgather_time": 5.187055969238282, "perdoc_attn_time": 1.4660319924354552, "output_shape": [16384, 8, 128]}, "1": {"per_seq_latency": 0.9964960098266602, "per_doc_latency": 6.549327850341797, "perseq_allgather_time": 0.6917568050324917, "perseq_attn_time": 0.29792320132255556, "perdoc_allgather_time": 5.062707233428955, "perdoc_attn_time": 1.4790480077266692, "output_shape": [16384, 8, 128]}, "per_seq_latency": 0.015577824413776397, "per_doc_latency": 0.10408647060394287, "per_seq_allgather_latency": 0.01087864967994392, "per_seq_attn_latency": 0.004735650052316487, "per_doc_allgather_latency": 0.08104774951934815, "per_doc_attn_latency": 0.023387124948203563, "num_seq_in_batch": 64, "seq_len": 1024, "num_heads": 64, "head_dim": 128, "cp": 4, "tp": 8, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 2.6132671356201174, "per_doc_latency": 12.495995330810548, "perseq_allgather_time": 0.517891201376915, "perseq_attn_time": 2.085422384738922, "perdoc_allgather_time": 8.037913632392883, "perdoc_attn_time": 4.451507234573365, "output_shape": [16384, 64, 128]}, "3": {"per_seq_latency": 2.971151924133301, "per_doc_latency": 12.49609146118164, "perseq_allgather_time": 0.8884208053350449, "perseq_attn_time": 2.0760543823242186, "perdoc_allgather_time": 8.110847997665406, "perdoc_attn_time": 4.378600025177002, "output_shape": [16384, 64, 128]}, "2": {"per_seq_latency": 2.9743776321411133, "per_doc_latency": 12.49462890625, "perseq_allgather_time": 0.8904704004526138, "perseq_attn_time": 2.0773488163948057, "perdoc_allgather_time": 8.091344022750855, "perdoc_attn_time": 4.396697640419006, "output_shape": [16384, 64, 128]}, "1": {"per_seq_latency": 2.9730976104736326, "per_doc_latency": 12.495256042480468, "perseq_allgather_time": 0.8839007884263992, "perseq_attn_time": 2.0826704025268556, "perdoc_allgather_time": 8.061887907981873, "perdoc_attn_time": 4.426947164535522, "output_shape": [16384, 64, 128]}, "per_seq_latency": 0.09294930100440979, "per_doc_latency": 0.39050285816192626, "per_seq_allgather_latency": 0.027827200014144182, "per_seq_attn_latency": 0.06516944952309131, "per_doc_allgather_latency": 0.25346399992704394, "per_doc_attn_latency": 0.13910960108041764, "num_seq_in_batch": 32, "seq_len": 2048, "num_heads": 64, "head_dim": 128, "cp": 4, "tp": 1, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"1": {"per_seq_latency": 2.0937503814697265, "per_doc_latency": 6.744137573242187, "perseq_allgather_time": 0.9422911882400513, "perseq_attn_time": 1.1450495958328246, "perdoc_allgather_time": 4.357868790626526, "perdoc_attn_time": 2.3798992037773132, "output_shape": [16384, 32, 128]}, "3": {"per_seq_latency": 2.129494476318359, "per_doc_latency": 6.7450927734375, "perseq_allgather_time": 0.9800799861550331, "perseq_attn_time": 1.14268319606781, "perdoc_allgather_time": 4.443147230148315, "perdoc_attn_time": 2.295246398448944, "output_shape": [16384, 32, 128]}, "0": {"per_seq_latency": 1.4780287742614746, "per_doc_latency": 6.747975921630859, "perseq_allgather_time": 0.3088687971234322, "perseq_attn_time": 1.1449552059173584, "perdoc_allgather_time": 4.267384028434753, "perdoc_attn_time": 2.4683952212333677, "output_shape": [16384, 32, 128]}, "2": {"per_seq_latency": 2.128124809265137, "per_doc_latency": 6.743740844726562, "perseq_allgather_time": 0.9798576250672341, "perseq_attn_time": 1.1416511952877044, "perdoc_allgather_time": 4.411339211463928, "perdoc_attn_time": 2.3257791996002197, "output_shape": [16384, 32, 128]}, "per_seq_latency": 0.06654670238494872, "per_doc_latency": 0.21087424755096434, "per_seq_allgather_latency": 0.030627499567344785, "per_seq_attn_latency": 0.03578279986977577, "per_doc_allgather_latency": 0.13884835094213485, "per_doc_attn_latency": 0.07713735066354274, "num_seq_in_batch": 32, "seq_len": 2048, "num_heads": 64, "head_dim": 128, "cp": 4, "tp": 2, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"1": {"per_seq_latency": 1.3946144104003906, "per_doc_latency": 4.608801651000976, "perseq_allgather_time": 0.7182127811014652, "perseq_attn_time": 0.6699952036142349, "perdoc_allgather_time": 3.188654386997223, "perdoc_attn_time": 1.413721603155136, "output_shape": [16384, 16, 128]}, "2": {"per_seq_latency": 1.3937631607055665, "per_doc_latency": 4.619863891601563, "perseq_allgather_time": 0.7142496049404145, "perseq_attn_time": 0.6729568004608154, "perdoc_allgather_time": 3.220678412914276, "perdoc_attn_time": 1.392608004808426, "output_shape": [16384, 16, 128]}, "0": {"per_seq_latency": 0.941004753112793, "per_doc_latency": 4.593753433227539, "perseq_allgather_time": 0.22358400002121925, "perseq_attn_time": 0.6766399949789047, "perdoc_allgather_time": 3.102296006679535, "perdoc_attn_time": 1.4535360097885133, "output_shape": [16384, 16, 128]}, "3": {"per_seq_latency": 1.3935040473937987, "per_doc_latency": 4.619846343994141, "perseq_allgather_time": 0.7116832137107849, "perseq_attn_time": 0.6749744027853012, "perdoc_allgather_time": 3.2523631930351256, "perdoc_attn_time": 1.36075679063797, "output_shape": [16384, 16, 128]}, "per_seq_latency": 0.043581700325012206, "per_doc_latency": 0.14437074661254884, "per_seq_allgather_latency": 0.02244414940942079, "per_seq_attn_latency": 0.021144999843090772, "per_doc_allgather_latency": 0.10163634978234767, "per_doc_attn_latency": 0.04542300030589104, "num_seq_in_batch": 32, "seq_len": 2048, "num_heads": 64, "head_dim": 128, "cp": 4, "tp": 4, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"3": {"per_seq_latency": 1.167854404449463, "per_doc_latency": 3.9026161193847657, "perseq_allgather_time": 0.7226399920880795, "perseq_attn_time": 0.43849759846925734, "perdoc_allgather_time": 2.811419200897217, "perdoc_attn_time": 1.0837711930274962, "output_shape": [16384, 8, 128]}, "0": {"per_seq_latency": 0.7206960201263428, "per_doc_latency": 3.8334430694580077, "perseq_allgather_time": 0.22900640219449997, "perseq_attn_time": 0.44576640278100965, "perdoc_allgather_time": 2.8315712094306944, "perdoc_attn_time": 0.9833344012498856, "output_shape": [16384, 8, 128]}, "2": {"per_seq_latency": 1.169337558746338, "per_doc_latency": 3.998625564575195, "perseq_allgather_time": 0.7298335872590542, "perseq_attn_time": 0.4329599991440773, "perdoc_allgather_time": 3.0400495886802674, "perdoc_attn_time": 0.9520351946353912, "output_shape": [16384, 8, 128]}, "1": {"per_seq_latency": 1.1683952331542968, "per_doc_latency": 3.963025665283203, "perseq_allgather_time": 0.7244864210486412, "perseq_attn_time": 0.4374863997101784, "perdoc_allgather_time": 2.955121600627899, "perdoc_attn_time": 1.001444798707962, "output_shape": [16384, 8, 128]}, "per_seq_latency": 0.03654179871082306, "per_doc_latency": 0.12495704889297485, "per_seq_allgather_latency": 0.022807299601845445, "per_seq_attn_latency": 0.013930200086906552, "per_doc_allgather_latency": 0.09500154964625836, "per_doc_attn_latency": 0.03386784978210926, "num_seq_in_batch": 32, "seq_len": 2048, "num_heads": 64, "head_dim": 128, "cp": 4, "tp": 8, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"3": {"per_seq_latency": 4.343014526367187, "per_doc_latency": 13.790411376953125, "perseq_allgather_time": 0.7573200076818466, "perseq_attn_time": 3.5789152145385743, "perdoc_allgather_time": 7.993644833564758, "perdoc_attn_time": 5.7901183605194095, "output_shape": [16384, 64, 128]}, "0": {"per_seq_latency": 4.107769775390625, "per_doc_latency": 13.790519714355469, "perseq_allgather_time": 0.5276863962411881, "perseq_attn_time": 3.5699023842811584, "perdoc_allgather_time": 7.963195204734802, "perdoc_attn_time": 5.820654439926147, "output_shape": [16384, 64, 128]}, "1": {"per_seq_latency": 4.3418113708496096, "per_doc_latency": 13.792239379882812, "perseq_allgather_time": 0.7696911871433259, "perseq_attn_time": 3.5655984044075013, "perdoc_allgather_time": 7.986888003349304, "perdoc_attn_time": 5.798923206329346, "output_shape": [16384, 64, 128]}, "2": {"per_seq_latency": 4.343431854248047, "per_doc_latency": 13.788710021972657, "perseq_allgather_time": 0.7674191951751709, "perseq_attn_time": 3.569444787502289, "perdoc_allgather_time": 7.99890251159668, "perdoc_attn_time": 5.783286476135254, "output_shape": [16384, 64, 128]}, "per_seq_latency": 0.27146449089050295, "per_doc_latency": 0.8620149612426757, "per_seq_allgather_latency": 0.048105699196457866, "per_seq_attn_latency": 0.2236822009086609, "per_doc_allgather_latency": 0.4999314069747925, "per_doc_attn_latency": 0.3637909024953842, "num_seq_in_batch": 16, "seq_len": 4096, "num_heads": 64, "head_dim": 128, "cp": 4, "tp": 1, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"3": {"per_seq_latency": 2.960732841491699, "per_doc_latency": 7.193225860595703, "perseq_allgather_time": 1.0211024031043052, "perseq_attn_time": 1.9327855944633483, "perdoc_allgather_time": 4.1633295774459835, "perdoc_attn_time": 3.0231327772140504, "output_shape": [16384, 32, 128]}, "0": {"per_seq_latency": 2.2463775634765626, "per_doc_latency": 7.1935569763183596, "perseq_allgather_time": 0.29810080081224444, "perseq_attn_time": 1.9383120119571686, "perdoc_allgather_time": 4.174734401702881, "perdoc_attn_time": 3.0122496128082275, "output_shape": [16384, 32, 128]}, "1": {"per_seq_latency": 2.9588176727294924, "per_doc_latency": 7.193830108642578, "perseq_allgather_time": 1.0168863952159881, "perseq_attn_time": 1.9354719877243043, "perdoc_allgather_time": 4.183027195930481, "perdoc_attn_time": 3.004369616508484, "output_shape": [16384, 32, 128]}, "2": {"per_seq_latency": 2.9590768814086914, "per_doc_latency": 7.19372329711914, "perseq_allgather_time": 1.0231791868805886, "perseq_attn_time": 1.9294336020946503, "perdoc_allgather_time": 4.177460813522339, "perdoc_attn_time": 3.009774386882782, "output_shape": [16384, 32, 128]}, "per_seq_latency": 0.1850458025932312, "per_doc_latency": 0.4496143817901611, "per_seq_allgather_latency": 0.06394869918003679, "per_seq_attn_latency": 0.12114450074732304, "per_doc_allgather_latency": 0.26143919974565505, "per_doc_attn_latency": 0.18894579857587815, "num_seq_in_batch": 16, "seq_len": 4096, "num_heads": 64, "head_dim": 128, "cp": 4, "tp": 2, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"3": {"per_seq_latency": 1.8933504104614258, "per_doc_latency": 4.01068000793457, "perseq_allgather_time": 0.7694447845220566, "perseq_attn_time": 1.1171536028385163, "perdoc_allgather_time": 2.308571195602417, "perdoc_attn_time": 1.695337599515915, "output_shape": [16384, 16, 128]}, "0": {"per_seq_latency": 1.3232144355773925, "per_doc_latency": 3.996905517578125, "perseq_allgather_time": 0.19594559893012048, "perseq_attn_time": 1.1157968044281006, "perdoc_allgather_time": 2.287716829776764, "perdoc_attn_time": 1.6986640095710754, "output_shape": [16384, 16, 128]}, "1": {"per_seq_latency": 1.891054344177246, "per_doc_latency": 4.011068725585938, "perseq_allgather_time": 0.7689088195562362, "perseq_attn_time": 1.1158096075057984, "perdoc_allgather_time": 2.4043232202529907, "perdoc_attn_time": 1.6003744006156921, "output_shape": [16384, 16, 128]}, "2": {"per_seq_latency": 1.8911424636840821, "per_doc_latency": 4.010806274414063, "perseq_allgather_time": 0.7609376013278961, "perseq_attn_time": 1.1236352026462555, "perdoc_allgather_time": 2.3997983932495117, "perdoc_attn_time": 1.604390400648117, "output_shape": [16384, 16, 128]}, "per_seq_latency": 0.11833440065383911, "per_doc_latency": 0.2506917953491211, "per_seq_allgather_latency": 0.048090299032628535, "per_seq_attn_latency": 0.07022720016539097, "per_doc_allgather_latency": 0.15027020126581192, "per_doc_attn_latency": 0.10616650059819221, "num_seq_in_batch": 16, "seq_len": 4096, "num_heads": 64, "head_dim": 128, "cp": 4, "tp": 4, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"3": {"per_seq_latency": 1.4565088272094726, "per_doc_latency": 2.5809711456298827, "perseq_allgather_time": 0.7417680218815803, "perseq_attn_time": 0.7080208003520966, "perdoc_allgather_time": 1.683599978685379, "perdoc_attn_time": 0.890649601817131, "output_shape": [16384, 8, 128]}, "0": {"per_seq_latency": 0.9495264053344726, "per_doc_latency": 2.5303247451782225, "perseq_allgather_time": 0.19574079886078835, "perseq_attn_time": 0.7082608044147491, "perdoc_allgather_time": 1.5220288038253784, "perdoc_attn_time": 0.9793776035308838, "output_shape": [16384, 8, 128]}, "2": {"per_seq_latency": 1.4555824279785157, "per_doc_latency": 2.538948822021484, "perseq_allgather_time": 0.7361008048057556, "perseq_attn_time": 0.7129343986511231, "perdoc_allgather_time": 1.6254208028316497, "perdoc_attn_time": 0.9069903999567032, "output_shape": [16384, 8, 128]}, "1": {"per_seq_latency": 1.4545727729797364, "per_doc_latency": 2.563910484313965, "perseq_allgather_time": 0.7361520089209079, "perseq_attn_time": 0.7120432049036026, "perdoc_allgather_time": 1.6187952041625977, "perdoc_attn_time": 0.9387631982564926, "output_shape": [16384, 8, 128]}, "per_seq_latency": 0.09103180170059204, "per_doc_latency": 0.16131069660186767, "per_seq_allgather_latency": 0.04636050136759877, "per_seq_attn_latency": 0.04455839991569519, "per_doc_allgather_latency": 0.10522499866783619, "per_doc_attn_latency": 0.061211100220680235, "num_seq_in_batch": 16, "seq_len": 4096, "num_heads": 64, "head_dim": 128, "cp": 4, "tp": 8, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 7.216254425048828, "per_doc_latency": 16.624420166015625, "perseq_allgather_time": 0.6560064017772674, "perseq_attn_time": 6.550403141975403, "perdoc_allgather_time": 7.950969600677491, "perdoc_attn_time": 8.666703987121583, "output_shape": [16384, 64, 128]}, "3": {"per_seq_latency": 7.426700592041016, "per_doc_latency": 16.623658752441408, "perseq_allgather_time": 0.8167519897222519, "perseq_attn_time": 6.603278422355652, "perdoc_allgather_time": 7.9621055841445925, "perdoc_attn_time": 8.654908752441406, "output_shape": [16384, 64, 128]}, "2": {"per_seq_latency": 7.4138236999511715, "per_doc_latency": 16.62645568847656, "perseq_allgather_time": 0.720934396982193, "perseq_attn_time": 6.686332821846008, "perdoc_allgather_time": 7.974748826026916, "perdoc_attn_time": 8.64518074989319, "output_shape": [16384, 64, 128]}, "1": {"per_seq_latency": 7.424662780761719, "per_doc_latency": 16.622157287597656, "perseq_allgather_time": 0.8360352009534836, "perseq_attn_time": 6.582262396812439, "perdoc_allgather_time": 7.988820791244507, "perdoc_attn_time": 8.626924753189087, "output_shape": [16384, 64, 128]}, "per_seq_latency": 0.928337574005127, "per_doc_latency": 2.07830696105957, "per_seq_allgather_latency": 0.10450440011918545, "per_seq_attn_latency": 0.835791602730751, "per_doc_allgather_latency": 0.9986025989055634, "per_doc_attn_latency": 1.0833379983901978, "num_seq_in_batch": 8, "seq_len": 8192, "num_heads": 64, "head_dim": 128, "cp": 4, "tp": 1, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"3": {"per_seq_latency": 4.5933185577392575, "per_doc_latency": 8.564539337158203, "perseq_allgather_time": 1.0538639917969703, "perseq_attn_time": 3.532755196094513, "perdoc_allgather_time": 4.091950368881226, "perdoc_attn_time": 4.465927982330323, "output_shape": [16384, 32, 128]}, "0": {"per_seq_latency": 3.8897121429443358, "per_doc_latency": 8.565428924560546, "perseq_allgather_time": 0.3507728025317192, "perseq_attn_time": 3.5285728096961977, "perdoc_allgather_time": 4.080849552154541, "perdoc_attn_time": 4.47803680896759, "output_shape": [16384, 32, 128]}, "2": {"per_seq_latency": 4.591772842407226, "per_doc_latency": 8.56760025024414, "perseq_allgather_time": 1.082190401852131, "perseq_attn_time": 3.502963197231293, "perdoc_allgather_time": 4.102664041519165, "perdoc_attn_time": 4.458387231826782, "output_shape": [16384, 32, 128]}, "1": {"per_seq_latency": 4.592657470703125, "per_doc_latency": 8.569818878173828, "perseq_allgather_time": 1.0664367765188216, "perseq_attn_time": 3.5197199821472167, "perdoc_allgather_time": 4.09204797744751, "perdoc_attn_time": 4.4712928295135494, "output_shape": [16384, 32, 128]}, "per_seq_latency": 0.5741648197174072, "per_doc_latency": 1.0712273597717286, "per_seq_allgather_latency": 0.13527380023151636, "per_seq_attn_latency": 0.4415943995118141, "per_doc_allgather_latency": 0.5128330051898956, "per_doc_attn_latency": 0.5597546011209488, "num_seq_in_batch": 8, "seq_len": 8192, "num_heads": 64, "head_dim": 128, "cp": 4, "tp": 2, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 2.3644432067871093, "per_doc_latency": 4.559203338623047, "perseq_allgather_time": 0.3350031912326813, "perseq_attn_time": 2.0180063903331757, "perdoc_allgather_time": 2.2080480098724364, "perdoc_attn_time": 2.3446383833885194, "output_shape": [16384, 16, 128]}, "2": {"per_seq_latency": 2.7814863204956053, "per_doc_latency": 4.558046340942383, "perseq_allgather_time": 0.7543839953839779, "perseq_attn_time": 2.020454412698746, "perdoc_allgather_time": 2.2046288013458253, "perdoc_attn_time": 2.3468224167823792, "output_shape": [16384, 16, 128]}, "3": {"per_seq_latency": 2.7837568283081056, "per_doc_latency": 4.557796859741211, "perseq_allgather_time": 0.7329375885426999, "perseq_attn_time": 2.044124799966812, "perdoc_allgather_time": 2.204419183731079, "perdoc_attn_time": 2.3467135548591616, "output_shape": [16384, 16, 128]}, "1": {"per_seq_latency": 2.7785455703735353, "per_doc_latency": 4.559284973144531, "perseq_allgather_time": 0.7597983941435814, "perseq_attn_time": 2.012334418296814, "perdoc_allgather_time": 2.2089136123657225, "perdoc_attn_time": 2.344009590148926, "output_shape": [16384, 16, 128]}, "per_seq_latency": 0.3479696035385132, "per_doc_latency": 0.5699106216430664, "per_seq_allgather_latency": 0.09497479926794768, "per_seq_attn_latency": 0.2555155999958515, "per_doc_allgather_latency": 0.2761142015457153, "per_doc_attn_latency": 0.2933528020977974, "num_seq_in_batch": 8, "seq_len": 8192, "num_heads": 64, "head_dim": 128, "cp": 4, "tp": 4, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"3": {"per_seq_latency": 1.9107391357421875, "per_doc_latency": 2.4759071350097654, "perseq_allgather_time": 0.633508813381195, "perseq_attn_time": 1.2705839991569519, "perdoc_allgather_time": 1.197083204984665, "perdoc_attn_time": 1.2721855998039246, "output_shape": [16384, 8, 128]}, "0": {"per_seq_latency": 1.5005776405334472, "per_doc_latency": 2.4506303787231447, "perseq_allgather_time": 0.2053744003176689, "perseq_attn_time": 1.2848831951618194, "perdoc_allgather_time": 1.1654623985290526, "perdoc_attn_time": 1.2668399870395661, "output_shape": [16384, 8, 128]}, "2": {"per_seq_latency": 1.9100095748901367, "per_doc_latency": 2.4746639251708986, "perseq_allgather_time": 0.6326399959623814, "perseq_attn_time": 1.2708191871643066, "perdoc_allgather_time": 1.1951104044914245, "perdoc_attn_time": 1.2729807913303375, "output_shape": [16384, 8, 128]}, "1": {"per_seq_latency": 1.9124368667602538, "per_doc_latency": 2.47772159576416, "perseq_allgather_time": 0.6230128198862076, "perseq_attn_time": 1.28294078707695, "perdoc_allgather_time": 1.1982720077037812, "perdoc_attn_time": 1.2730223894119264, "output_shape": [16384, 8, 128]}, "per_seq_latency": 0.23905460834503173, "per_doc_latency": 0.30971519947052, "per_seq_allgather_latency": 0.07918860167264938, "per_seq_attn_latency": 0.16061039939522742, "per_doc_allgather_latency": 0.14978400096297265, "per_doc_attn_latency": 0.1591277986764908, "num_seq_in_batch": 8, "seq_len": 8192, "num_heads": 64, "head_dim": 128, "cp": 4, "tp": 8, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 13.4112548828125, "per_doc_latency": 22.444306945800783, "perseq_allgather_time": 0.9164879977703094, "perseq_attn_time": 12.4881582736969, "perdoc_allgather_time": 8.044702434539795, "perdoc_attn_time": 14.393017482757568, "output_shape": [16384, 64, 128]}, "3": {"per_seq_latency": 13.411767578125, "per_doc_latency": 22.439045715332032, "perseq_allgather_time": 0.8981663912534714, "perseq_attn_time": 12.506807947158814, "perdoc_allgather_time": 8.037852764129639, "perdoc_attn_time": 14.394379091262817, "output_shape": [16384, 64, 128]}, "2": {"per_seq_latency": 13.410275268554688, "per_doc_latency": 22.443434143066405, "perseq_allgather_time": 0.5149631947278976, "perseq_attn_time": 12.888710403442383, "perdoc_allgather_time": 7.961332750320435, "perdoc_attn_time": 14.475516653060913, "output_shape": [16384, 64, 128]}, "1": {"per_seq_latency": 13.414085388183594, "per_doc_latency": 22.436717224121093, "perseq_allgather_time": 0.9778735965490342, "perseq_attn_time": 12.429732704162598, "perdoc_allgather_time": 8.123161506652831, "perdoc_attn_time": 14.307191944122314, "output_shape": [16384, 64, 128]}, "per_seq_latency": 3.3535213470458984, "per_doc_latency": 5.611076736450196, "per_seq_allgather_latency": 0.24446839913725854, "per_seq_attn_latency": 3.222177600860596, "per_doc_allgather_latency": 2.030790376663208, "per_doc_attn_latency": 3.618879163265228, "num_seq_in_batch": 4, "seq_len": 16384, "num_heads": 64, "head_dim": 128, "cp": 4, "tp": 1, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"3": {"per_seq_latency": 7.198540496826172, "per_doc_latency": 11.499030303955077, "perseq_allgather_time": 0.7266591921448707, "perseq_attn_time": 6.465152025222778, "perdoc_allgather_time": 4.129012775421143, "perdoc_attn_time": 7.363431978225708, "output_shape": [16384, 32, 128]}, "0": {"per_seq_latency": 6.870247650146484, "per_doc_latency": 11.498484802246093, "perseq_allgather_time": 0.3878495991230011, "perseq_attn_time": 6.47241439819336, "perdoc_allgather_time": 4.137841606140137, "perdoc_attn_time": 7.354160022735596, "output_shape": [16384, 32, 128]}, "2": {"per_seq_latency": 7.202601623535156, "per_doc_latency": 11.495526123046876, "perseq_allgather_time": 0.6419119939208031, "perseq_attn_time": 6.55416476726532, "perdoc_allgather_time": 4.073201608657837, "perdoc_attn_time": 7.415747165679932, "output_shape": [16384, 32, 128]}, "1": {"per_seq_latency": 7.197227478027344, "per_doc_latency": 11.499921417236328, "perseq_allgather_time": 0.6792416036128998, "perseq_attn_time": 6.511552047729492, "perdoc_allgather_time": 4.137166380882263, "perdoc_attn_time": 7.356256031990052, "output_shape": [16384, 32, 128]}, "per_seq_latency": 1.800650405883789, "per_doc_latency": 2.874980354309082, "per_seq_allgather_latency": 0.18166479803621768, "per_seq_attn_latency": 1.63854119181633, "per_doc_allgather_latency": 1.0344604015350343, "per_doc_attn_latency": 1.853936791419983, "num_seq_in_batch": 4, "seq_len": 16384, "num_heads": 64, "head_dim": 128, "cp": 4, "tp": 2, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 3.803035354614258, "per_doc_latency": 5.9966880798339846, "perseq_allgather_time": 0.20384000092744828, "perseq_attn_time": 3.589073622226715, "perdoc_allgather_time": 2.1426671981811523, "perdoc_attn_time": 3.847491192817688, "output_shape": [16384, 16, 128]}, "3": {"per_seq_latency": 4.023195266723633, "per_doc_latency": 5.998630523681641, "perseq_allgather_time": 0.4254671990871429, "perseq_attn_time": 3.5910704016685484, "perdoc_allgather_time": 2.10796959400177, "perdoc_attn_time": 3.884046399593353, "output_shape": [16384, 16, 128]}, "1": {"per_seq_latency": 4.024102401733399, "per_doc_latency": 5.994835281372071, "perseq_allgather_time": 0.4603279888629913, "perseq_attn_time": 3.557417607307434, "perdoc_allgather_time": 2.122452807426453, "perdoc_attn_time": 3.8660127758979796, "output_shape": [16384, 16, 128]}, "2": {"per_seq_latency": 4.0311134338378904, "per_doc_latency": 5.997545623779297, "perseq_allgather_time": 0.47790560200810434, "perseq_attn_time": 3.5467392086982725, "perdoc_allgather_time": 2.1229904174804686, "perdoc_attn_time": 3.867948794364929, "output_shape": [16384, 16, 128]}, "per_seq_latency": 1.0077783584594726, "per_doc_latency": 1.4996576309204102, "per_seq_allgather_latency": 0.11947640050202608, "per_seq_attn_latency": 0.8977676004171371, "per_doc_allgather_latency": 0.5356667995452881, "per_doc_attn_latency": 0.9710115998983383, "num_seq_in_batch": 4, "seq_len": 16384, "num_heads": 64, "head_dim": 128, "cp": 4, "tp": 4, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"3": {"per_seq_latency": 2.8213823318481444, "per_doc_latency": 3.1790176391601563, "perseq_allgather_time": 0.7307696007192135, "perseq_attn_time": 2.083833599090576, "perdoc_allgather_time": 1.1089311957359314, "perdoc_attn_time": 2.0633392095565797, "output_shape": [16384, 8, 128]}, "0": {"per_seq_latency": 2.3019487380981447, "per_doc_latency": 3.181174468994141, "perseq_allgather_time": 0.20066240057349205, "perseq_attn_time": 2.0913023948669434, "perdoc_allgather_time": 1.1268703997135163, "perdoc_attn_time": 2.0477360010147097, "output_shape": [16384, 8, 128]}, "1": {"per_seq_latency": 2.8174047470092773, "per_doc_latency": 3.1811328887939454, "perseq_allgather_time": 0.7232671968638897, "perseq_attn_time": 2.0875231981277467, "perdoc_allgather_time": 1.1078288197517394, "perdoc_attn_time": 2.066803181171417, "output_shape": [16384, 8, 128]}, "2": {"per_seq_latency": 2.79849910736084, "per_doc_latency": 3.1816432952880858, "perseq_allgather_time": 0.6994799770414829, "perseq_attn_time": 2.0923327803611755, "perdoc_allgather_time": 1.1229088008403778, "perdoc_attn_time": 2.05214239358902, "output_shape": [16384, 8, 128]}, "per_seq_latency": 0.7053455829620361, "per_doc_latency": 0.7954108238220214, "per_seq_allgather_latency": 0.18269240017980337, "per_seq_attn_latency": 0.5230831950902939, "per_doc_allgather_latency": 0.2817175999283791, "per_doc_attn_latency": 0.5167007952928543, "num_seq_in_batch": 4, "seq_len": 16384, "num_heads": 64, "head_dim": 128, "cp": 4, "tp": 8, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 25.59736022949219, "per_doc_latency": 34.982174682617185, "perseq_allgather_time": 1.137156793475151, "perseq_attn_time": 24.453656005859376, "perdoc_allgather_time": 8.39304006099701, "perdoc_attn_time": 26.582611274719238, "output_shape": [16384, 64, 128]}, "3": {"per_seq_latency": 25.5880126953125, "per_doc_latency": 34.97608337402344, "perseq_allgather_time": 1.169705617427826, "perseq_attn_time": 24.411636734008788, "perdoc_allgather_time": 8.576926445960998, "perdoc_attn_time": 26.392439937591554, "output_shape": [16384, 64, 128]}, "2": {"per_seq_latency": 25.593443298339842, "per_doc_latency": 35.00987548828125, "perseq_allgather_time": 0.515531200170517, "perseq_attn_time": 25.071360111236572, "perdoc_allgather_time": 8.221790337562561, "perdoc_attn_time": 26.78157901763916, "output_shape": [16384, 64, 128]}, "1": {"per_seq_latency": 25.589518737792968, "per_doc_latency": 34.98665161132813, "perseq_allgather_time": 1.2879104048013688, "perseq_attn_time": 24.295199966430665, "perdoc_allgather_time": 8.650920009613037, "perdoc_attn_time": 26.329327869415284, "output_shape": [16384, 64, 128]}, "per_seq_latency": 12.798680114746094, "per_doc_latency": 17.504937744140626, "per_seq_allgather_latency": 0.6439552024006844, "per_seq_attn_latency": 12.535680055618286, "per_doc_allgather_latency": 4.325460004806518, "per_doc_attn_latency": 13.39078950881958, "num_seq_in_batch": 2, "seq_len": 32768, "num_heads": 64, "head_dim": 128, "cp": 4, "tp": 1, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 13.14770965576172, "per_doc_latency": 17.603396606445312, "perseq_allgather_time": 0.6952255979180336, "perseq_attn_time": 12.44595193862915, "perdoc_allgather_time": 4.286425614356995, "perdoc_attn_time": 13.310479927062989, "output_shape": [16384, 32, 128]}, "1": {"per_seq_latency": 13.15399169921875, "per_doc_latency": 17.59819641113281, "perseq_allgather_time": 0.6722719997167588, "perseq_attn_time": 12.475312089920044, "perdoc_allgather_time": 4.2773727655410765, "perdoc_attn_time": 13.314465618133545, "output_shape": [16384, 32, 128]}, "3": {"per_seq_latency": 13.160609436035156, "per_doc_latency": 17.602784729003908, "perseq_allgather_time": 0.6508624017238617, "perseq_attn_time": 12.502979183197022, "perdoc_allgather_time": 4.188276839256287, "perdoc_attn_time": 13.407731294631958, "output_shape": [16384, 32, 128]}, "2": {"per_seq_latency": 13.15874786376953, "per_doc_latency": 17.668739318847656, "perseq_allgather_time": 0.2907871976494789, "perseq_attn_time": 12.861393547058105, "perdoc_allgather_time": 4.117649626731873, "perdoc_attn_time": 13.544496154785156, "output_shape": [16384, 32, 128]}, "per_seq_latency": 6.580304718017578, "per_doc_latency": 8.834369659423828, "per_seq_allgather_latency": 0.3476127989590168, "per_seq_attn_latency": 6.430696773529053, "per_doc_allgather_latency": 2.1432128071784975, "per_doc_attn_latency": 6.772248077392578, "num_seq_in_batch": 2, "seq_len": 32768, "num_heads": 64, "head_dim": 128, "cp": 4, "tp": 2, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"3": {"per_seq_latency": 7.117318725585937, "per_doc_latency": 9.032286071777344, "perseq_allgather_time": 0.6018847994506359, "perseq_attn_time": 6.508614420890808, "perdoc_allgather_time": 2.158420777320862, "perdoc_attn_time": 6.867121601104737, "output_shape": [16384, 16, 128]}, "0": {"per_seq_latency": 6.833782196044922, "per_doc_latency": 9.031639862060548, "perseq_allgather_time": 0.29793279990553856, "perseq_attn_time": 6.5238384246826175, "perdoc_allgather_time": 2.2136991739273073, "perdoc_attn_time": 6.811479997634888, "output_shape": [16384, 16, 128]}, "1": {"per_seq_latency": 7.112558746337891, "per_doc_latency": 9.025014495849609, "perseq_allgather_time": 0.5155776046216488, "perseq_attn_time": 6.590663981437683, "perdoc_allgather_time": 2.166152000427246, "perdoc_attn_time": 6.852460861206055, "output_shape": [16384, 16, 128]}, "2": {"per_seq_latency": 7.1168769836425785, "per_doc_latency": 9.027432250976563, "perseq_allgather_time": 0.4962591893970966, "perseq_attn_time": 6.614052796363831, "perdoc_allgather_time": 2.098857605457306, "perdoc_attn_time": 6.9219999551773075, "output_shape": [16384, 16, 128]}, "per_seq_latency": 3.5586593627929686, "per_doc_latency": 4.516143035888672, "per_seq_allgather_latency": 0.30094239972531794, "per_seq_attn_latency": 3.3070263981819155, "per_doc_allgather_latency": 1.1068495869636537, "per_doc_attn_latency": 3.4609999775886537, "num_seq_in_batch": 2, "seq_len": 32768, "num_heads": 64, "head_dim": 128, "cp": 4, "tp": 4, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"3": {"per_seq_latency": 4.395342254638672, "per_doc_latency": 4.773896026611328, "perseq_allgather_time": 0.8280640006065368, "perseq_attn_time": 3.560531210899353, "perdoc_allgather_time": 1.130040019750595, "perdoc_attn_time": 3.6371663928031923, "output_shape": [16384, 8, 128]}, "0": {"per_seq_latency": 3.85827522277832, "per_doc_latency": 4.773287963867188, "perseq_allgather_time": 0.28775679916143415, "perseq_attn_time": 3.5604591846466063, "perdoc_allgather_time": 1.1457567989826203, "perdoc_attn_time": 3.6210912227630616, "output_shape": [16384, 8, 128]}, "2": {"per_seq_latency": 4.394806289672852, "per_doc_latency": 4.77752799987793, "perseq_allgather_time": 0.7227280184626579, "perseq_attn_time": 3.6653088092803956, "perdoc_allgather_time": 1.1200735926628114, "perdoc_attn_time": 3.650878405570984, "output_shape": [16384, 8, 128]}, "1": {"per_seq_latency": 4.3971294403076175, "per_doc_latency": 4.775353622436524, "perseq_allgather_time": 0.7255071781575679, "perseq_attn_time": 3.6653280019760133, "perdoc_allgather_time": 1.1020352005958558, "perdoc_attn_time": 3.6668863892555237, "output_shape": [16384, 8, 128]}, "per_seq_latency": 2.1985647201538088, "per_doc_latency": 2.388763999938965, "per_seq_allgather_latency": 0.4140320003032684, "per_seq_attn_latency": 1.8326640009880066, "per_doc_allgather_latency": 0.5728783994913101, "per_doc_attn_latency": 1.8334431946277618, "num_seq_in_batch": 2, "seq_len": 32768, "num_heads": 64, "head_dim": 128, "cp": 4, "tp": 8, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 51.21036987304687, "per_doc_latency": 59.87581787109375, "perseq_allgather_time": 2.080784001946449, "perseq_attn_time": 49.12309799194336, "perdoc_allgather_time": 9.167206430435181, "perdoc_attn_time": 50.70207061767578, "output_shape": [16384, 64, 128]}, "3": {"per_seq_latency": 51.226995849609374, "per_doc_latency": 59.871697998046876, "perseq_allgather_time": 2.2169936150312424, "perseq_attn_time": 49.003428840637206, "perdoc_allgather_time": 9.296532773971558, "perdoc_attn_time": 50.56853122711182, "output_shape": [16384, 64, 128]}, "2": {"per_seq_latency": 51.239044189453125, "per_doc_latency": 59.928594970703124, "perseq_allgather_time": 0.6656511932611465, "perseq_attn_time": 50.566806602478025, "perdoc_allgather_time": 8.25472149848938, "perdoc_attn_time": 51.667345428466795, "output_shape": [16384, 64, 128]}, "1": {"per_seq_latency": 51.28779907226563, "per_doc_latency": 59.86491088867187, "perseq_allgather_time": 2.5505824059247972, "perseq_attn_time": 48.73083686828613, "perdoc_allgather_time": 9.941116762161254, "perdoc_attn_time": 49.91743831634521, "output_shape": [16384, 64, 128]}, "per_seq_latency": 51.28779907226563, "per_doc_latency": 59.928594970703124, "per_seq_allgather_latency": 2.5505824059247972, "per_seq_attn_latency": 50.566806602478025, "per_doc_allgather_latency": 9.941116762161254, "per_doc_attn_latency": 51.667345428466795, "num_seq_in_batch": 1, "seq_len": 65536, "num_heads": 64, "head_dim": 128, "cp": 4, "tp": 1, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 25.488772583007812, "per_doc_latency": 30.180694580078125, "perseq_allgather_time": 0.8496016055345536, "perseq_attn_time": 24.632610988616943, "perdoc_allgather_time": 4.841118359565735, "perdoc_attn_time": 25.332999992370606, "output_shape": [16384, 32, 128]}, "1": {"per_seq_latency": 25.535174560546874, "per_doc_latency": 30.184716796875, "perseq_allgather_time": 0.9682320073246956, "perseq_attn_time": 24.560407829284667, "perdoc_allgather_time": 4.945257568359375, "perdoc_attn_time": 25.232987213134766, "output_shape": [16384, 32, 128]}, "3": {"per_seq_latency": 25.491239929199217, "per_doc_latency": 30.1702392578125, "perseq_allgather_time": 0.8748656064271927, "perseq_attn_time": 24.609716987609865, "perdoc_allgather_time": 4.693887948989868, "perdoc_attn_time": 25.469673538208006, "output_shape": [16384, 32, 128]}, "2": {"per_seq_latency": 25.515745544433592, "per_doc_latency": 30.253024291992187, "perseq_allgather_time": 0.29124800115823746, "perseq_attn_time": 25.217872047424315, "perdoc_allgather_time": 4.23523359298706, "perdoc_attn_time": 26.011190700531007, "output_shape": [16384, 32, 128]}, "per_seq_latency": 25.535174560546874, "per_doc_latency": 30.253024291992187, "per_seq_allgather_latency": 0.9682320073246956, "per_seq_attn_latency": 25.217872047424315, "per_doc_allgather_latency": 4.945257568359375, "per_doc_attn_latency": 26.011190700531007, "num_seq_in_batch": 1, "seq_len": 65536, "num_heads": 64, "head_dim": 128, "cp": 4, "tp": 2, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"3": {"per_seq_latency": 13.162753295898437, "per_doc_latency": 15.162725830078125, "perseq_allgather_time": 0.5183231979608536, "perseq_attn_time": 12.63778567314148, "perdoc_allgather_time": 2.2989471912384034, "perdoc_attn_time": 12.857094383239746, "output_shape": [16384, 16, 128]}, "0": {"per_seq_latency": 13.162307739257812, "per_doc_latency": 15.158421325683594, "perseq_allgather_time": 0.7826575964689255, "perseq_attn_time": 12.373182392120361, "perdoc_allgather_time": 2.431385600566864, "perdoc_attn_time": 12.720503997802734, "output_shape": [16384, 16, 128]}, "1": {"per_seq_latency": 13.1522216796875, "per_doc_latency": 15.156364440917969, "perseq_allgather_time": 0.696284806728363, "perseq_attn_time": 12.449408054351807, "perdoc_allgather_time": 2.4088207840919496, "perdoc_attn_time": 12.741049575805665, "output_shape": [16384, 16, 128]}, "2": {"per_seq_latency": 13.153089904785157, "per_doc_latency": 15.164228820800782, "perseq_allgather_time": 0.1760304018855095, "perseq_attn_time": 12.970491170883179, "perdoc_allgather_time": 2.0989520072937013, "perdoc_attn_time": 13.058670377731323, "output_shape": [16384, 16, 128]}, "per_seq_latency": 13.162753295898437, "per_doc_latency": 15.164228820800782, "per_seq_allgather_latency": 0.7826575964689255, "per_seq_attn_latency": 12.970491170883179, "per_doc_allgather_latency": 2.431385600566864, "per_doc_attn_latency": 13.058670377731323, "num_seq_in_batch": 1, "seq_len": 65536, "num_heads": 64, "head_dim": 128, "cp": 4, "tp": 4, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 6.809967803955078, "per_doc_latency": 7.889849853515625, "perseq_allgather_time": 0.31473439931869507, "perseq_attn_time": 6.485046410560608, "perdoc_allgather_time": 1.2453152060508728, "perdoc_attn_time": 6.6379520177841185, "output_shape": [16384, 8, 128]}, "3": {"per_seq_latency": 7.196356964111328, "per_doc_latency": 7.8877410888671875, "perseq_allgather_time": 0.5928896099328995, "perseq_attn_time": 6.596815967559815, "perdoc_allgather_time": 1.151632010936737, "perdoc_attn_time": 6.729444813728333, "output_shape": [16384, 8, 128]}, "2": {"per_seq_latency": 7.200572967529297, "per_doc_latency": 7.889147186279297, "perseq_allgather_time": 0.5678943961858749, "perseq_attn_time": 6.626060795783997, "perdoc_allgather_time": 1.0980703949928283, "perdoc_attn_time": 6.7844048023223875, "output_shape": [16384, 8, 128]}, "1": {"per_seq_latency": 7.193566131591797, "per_doc_latency": 7.892635345458984, "perseq_allgather_time": 0.6158128112554551, "perseq_attn_time": 6.571231985092163, "perdoc_allgather_time": 1.1803823947906493, "perdoc_attn_time": 6.7057535409927365, "output_shape": [16384, 8, 128]}, "per_seq_latency": 7.200572967529297, "per_doc_latency": 7.892635345458984, "per_seq_allgather_latency": 0.6158128112554551, "per_seq_attn_latency": 6.626060795783997, "per_doc_allgather_latency": 1.2453152060508728, "per_doc_attn_latency": 6.7844048023223875, "num_seq_in_batch": 1, "seq_len": 65536, "num_heads": 64, "head_dim": 128, "cp": 4, "tp": 8, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 1.1059375762939454, "per_doc_latency": 271.6392822265625, "perseq_allgather_time": 0.6433631926774979, "perseq_attn_time": 0.44704640060663225, "perdoc_allgather_time": 240.06465606689454, "perdoc_attn_time": 31.537383937835692, "output_shape": [8192, 64, 128]}, "7": {"per_seq_latency": 1.6892303466796874, "per_doc_latency": 263.0569091796875, "perseq_allgather_time": 1.212526398897171, "perseq_attn_time": 0.46765120327472687, "perdoc_allgather_time": 232.89686431884766, "perdoc_attn_time": 30.137974548339844, "output_shape": [8192, 64, 128]}, "3": {"per_seq_latency": 1.6895599365234375, "per_doc_latency": 269.0311279296875, "perseq_allgather_time": 1.2256303966045379, "perseq_attn_time": 0.4558799996972084, "perdoc_allgather_time": 238.65765533447265, "perdoc_attn_time": 30.352348709106444, "output_shape": [8192, 64, 128]}, "2": {"per_seq_latency": 1.6887184143066407, "per_doc_latency": 270.890185546875, "perseq_allgather_time": 1.2356576085090638, "perseq_attn_time": 0.44583200216293334, "perdoc_allgather_time": 240.5708885192871, "perdoc_attn_time": 30.297806549072266, "output_shape": [8192, 64, 128]}, "5": {"per_seq_latency": 1.6900672912597656, "per_doc_latency": 268.1824951171875, "perseq_allgather_time": 1.2328992038965225, "perseq_attn_time": 0.45051359534263613, "perdoc_allgather_time": 239.7927360534668, "perdoc_attn_time": 28.370631885528564, "output_shape": [8192, 64, 128]}, "4": {"per_seq_latency": 1.6896543502807617, "per_doc_latency": 270.6259521484375, "perseq_allgather_time": 1.216404777765274, "perseq_attn_time": 0.46472799926996233, "perdoc_allgather_time": 243.91541595458983, "perdoc_attn_time": 26.693779468536377, "output_shape": [8192, 64, 128]}, "1": {"per_seq_latency": 1.6888992309570312, "per_doc_latency": 274.2505126953125, "perseq_allgather_time": 1.236291202902794, "perseq_attn_time": 0.44549760073423383, "perdoc_allgather_time": 243.07261810302734, "perdoc_attn_time": 31.155484867095947, "output_shape": [8192, 64, 128]}, "6": {"per_seq_latency": 1.6898000717163086, "per_doc_latency": 267.60947265625, "perseq_allgather_time": 1.2347952038049699, "perseq_attn_time": 0.44827680140733717, "perdoc_allgather_time": 236.80320892333984, "perdoc_attn_time": 30.78464298248291, "output_shape": [8192, 64, 128]}, "per_seq_latency": 0.0016504563391208649, "per_doc_latency": 0.26782276630401614, "per_seq_allgather_latency": 0.0012073156278347597, "per_seq_attn_latency": 0.00045669062819797546, "per_doc_allgather_latency": 0.23819864839315413, "per_doc_attn_latency": 0.030798226501792668, "num_seq_in_batch": 1024, "seq_len": 64, "num_heads": 64, "head_dim": 128, "cp": 8, "tp": 1, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"7": {"per_seq_latency": 1.091430377960205, "per_doc_latency": 267.8000244140625, "perseq_allgather_time": 0.7708575919270515, "perseq_attn_time": 0.2980719983577728, "perdoc_allgather_time": 239.52442169189453, "perdoc_attn_time": 28.07612810134888, "output_shape": [8192, 32, 128]}, "0": {"per_seq_latency": 0.8458576202392578, "per_doc_latency": 276.1662841796875, "perseq_allgather_time": 0.4948080003261566, "perseq_attn_time": 0.29676959812641146, "perdoc_allgather_time": 245.22649765014648, "perdoc_attn_time": 30.358398628234863, "output_shape": [8192, 32, 128]}, "6": {"per_seq_latency": 1.0912896156311036, "per_doc_latency": 271.3525634765625, "perseq_allgather_time": 0.7747280016541481, "perseq_attn_time": 0.2963039979338646, "perdoc_allgather_time": 246.8935348510742, "perdoc_attn_time": 24.28305592536926, "output_shape": [8192, 32, 128]}, "4": {"per_seq_latency": 1.0913999557495118, "per_doc_latency": 277.0561767578125, "perseq_allgather_time": 0.791606391966343, "perseq_attn_time": 0.28725759983062743, "perdoc_allgather_time": 248.55380325317384, "perdoc_attn_time": 28.226791763305663, "output_shape": [8192, 32, 128]}, "1": {"per_seq_latency": 1.0913583755493164, "per_doc_latency": 276.5394287109375, "perseq_allgather_time": 0.7946640089154243, "perseq_attn_time": 0.28272159993648527, "perdoc_allgather_time": 247.9058822631836, "perdoc_attn_time": 28.428621006011962, "output_shape": [8192, 32, 128]}, "2": {"per_seq_latency": 1.0912960052490235, "per_doc_latency": 276.1605224609375, "perseq_allgather_time": 0.7770816057920455, "perseq_attn_time": 0.297665598988533, "perdoc_allgather_time": 247.70268173217772, "perdoc_attn_time": 28.29264965057373, "output_shape": [8192, 32, 128]}, "5": {"per_seq_latency": 1.091487979888916, "per_doc_latency": 274.7480224609375, "perseq_allgather_time": 0.793793597817421, "perseq_attn_time": 0.2854864031076431, "perdoc_allgather_time": 245.75130615234374, "perdoc_attn_time": 28.810528087615968, "output_shape": [8192, 32, 128]}, "3": {"per_seq_latency": 1.0911744117736817, "per_doc_latency": 274.3583740234375, "perseq_allgather_time": 0.7874671995639801, "perseq_attn_time": 0.28967679888010023, "perdoc_allgather_time": 246.52765045166015, "perdoc_attn_time": 27.61907501220703, "output_shape": [8192, 32, 128]}, "per_seq_latency": 0.0010659062303602696, "per_doc_latency": 0.2705626726150513, "per_seq_allgather_latency": 0.0007760390712064691, "per_seq_attn_latency": 0.0002910859358962625, "per_doc_allgather_latency": 0.24272832348942758, "per_doc_attn_latency": 0.029646873660385608, "num_seq_in_batch": 1024, "seq_len": 64, "num_heads": 64, "head_dim": 128, "cp": 8, "tp": 2, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 0.7941423892974854, "per_doc_latency": 273.8811767578125, "perseq_allgather_time": 0.36159520149230956, "perseq_attn_time": 0.29774400144815444, "perdoc_allgather_time": 242.34643020629883, "perdoc_attn_time": 30.678575801849366, "output_shape": [8192, 16, 128]}, "7": {"per_seq_latency": 1.0586560249328614, "per_doc_latency": 275.8164794921875, "perseq_allgather_time": 0.7658527925610542, "perseq_attn_time": 0.22633919939398767, "perdoc_allgather_time": 247.82135848999025, "perdoc_attn_time": 27.376430416107176, "output_shape": [8192, 16, 128]}, "4": {"per_seq_latency": 1.0600095748901368, "per_doc_latency": 266.330126953125, "perseq_allgather_time": 0.7516207873821259, "perseq_attn_time": 0.2361407995223999, "perdoc_allgather_time": 238.5010498046875, "perdoc_attn_time": 27.375930976867675, "output_shape": [8192, 16, 128]}, "5": {"per_seq_latency": 1.0586511611938476, "per_doc_latency": 264.9162353515625, "perseq_allgather_time": 0.7574127972126007, "perseq_attn_time": 0.2322367988526821, "perdoc_allgather_time": 236.75366592407227, "perdoc_attn_time": 27.70434856414795, "output_shape": [8192, 16, 128]}, "3": {"per_seq_latency": 1.0592255592346191, "per_doc_latency": 270.416259765625, "perseq_allgather_time": 0.7652016133069992, "perseq_attn_time": 0.2258432000875473, "perdoc_allgather_time": 242.02436218261718, "perdoc_attn_time": 27.904961776733398, "output_shape": [8192, 16, 128]}, "1": {"per_seq_latency": 1.0594143867492676, "per_doc_latency": 268.2248779296875, "perseq_allgather_time": 0.759260793030262, "perseq_attn_time": 0.2308304004371166, "perdoc_allgather_time": 241.5036277770996, "perdoc_attn_time": 26.189921569824218, "output_shape": [8192, 16, 128]}, "2": {"per_seq_latency": 1.0605839729309081, "per_doc_latency": 272.406201171875, "perseq_allgather_time": 0.7463760048151016, "perseq_attn_time": 0.24031680151820184, "perdoc_allgather_time": 243.87939224243163, "perdoc_attn_time": 28.040595149993898, "output_shape": [8192, 16, 128]}, "6": {"per_seq_latency": 1.0586992263793946, "per_doc_latency": 272.46728515625, "perseq_allgather_time": 0.7549456015229226, "perseq_attn_time": 0.23514719903469086, "perdoc_allgather_time": 244.8723892211914, "perdoc_attn_time": 27.026390266418456, "output_shape": [8192, 16, 128]}, "per_seq_latency": 0.00103572653606534, "per_doc_latency": 0.26935203075408937, "per_seq_allgather_latency": 0.0007479031177354045, "per_seq_attn_latency": 0.0002907656264142133, "per_doc_allgather_latency": 0.2420130454003811, "per_doc_attn_latency": 0.02995954668149352, "num_seq_in_batch": 1024, "seq_len": 64, "num_heads": 64, "head_dim": 128, "cp": 8, "tp": 4, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"7": {"per_seq_latency": 0.9698224067687988, "per_doc_latency": 276.85078125, "perseq_allgather_time": 0.6634816020727158, "perseq_attn_time": 0.21768000200390816, "perdoc_allgather_time": 249.3705924987793, "perdoc_attn_time": 26.71280174255371, "output_shape": [8192, 8, 128]}, "0": {"per_seq_latency": 0.7567696094512939, "per_doc_latency": 279.1479736328125, "perseq_allgather_time": 0.3492032065987587, "perseq_attn_time": 0.27169919982552526, "perdoc_allgather_time": 250.6884422302246, "perdoc_attn_time": 27.29993782043457, "output_shape": [8192, 8, 128]}, "4": {"per_seq_latency": 0.9740976333618164, "per_doc_latency": 266.91337890625, "perseq_allgather_time": 0.675828792154789, "perseq_attn_time": 0.20907519906759262, "perdoc_allgather_time": 240.95676498413087, "perdoc_attn_time": 25.34095993041992, "output_shape": [8192, 8, 128]}, "6": {"per_seq_latency": 0.9721648216247558, "per_doc_latency": 270.143798828125, "perseq_allgather_time": 0.6709952026605606, "perseq_attn_time": 0.21195679977536203, "perdoc_allgather_time": 246.42487106323242, "perdoc_attn_time": 23.099033880233765, "output_shape": [8192, 8, 128]}, "2": {"per_seq_latency": 0.9240927696228027, "per_doc_latency": 273.514306640625, "perseq_allgather_time": 0.6239456102252007, "perseq_attn_time": 0.20802560001611708, "perdoc_allgather_time": 245.8461555480957, "perdoc_attn_time": 26.955798053741454, "output_shape": [8192, 8, 128]}, "5": {"per_seq_latency": 0.9720959663391113, "per_doc_latency": 269.31650390625, "perseq_allgather_time": 0.6687759920954705, "perseq_attn_time": 0.2132767990231514, "perdoc_allgather_time": 241.13241806030274, "perdoc_attn_time": 27.436412620544434, "output_shape": [8192, 8, 128]}, "3": {"per_seq_latency": 0.9721903800964355, "per_doc_latency": 268.131787109375, "perseq_allgather_time": 0.6687824040651321, "perseq_attn_time": 0.21386399790644645, "perdoc_allgather_time": 241.16151428222656, "perdoc_attn_time": 26.262532711029053, "output_shape": [8192, 8, 128]}, "1": {"per_seq_latency": 0.9717184066772461, "per_doc_latency": 274.1144775390625, "perseq_allgather_time": 0.644998399913311, "perseq_attn_time": 0.23313120007514954, "perdoc_allgather_time": 246.0134162902832, "perdoc_attn_time": 27.39734058380127, "output_shape": [8192, 8, 128]}, "per_seq_latency": 0.0009512672200798989, "per_doc_latency": 0.2726054430007935, "per_seq_allgather_latency": 0.0006599890548386611, "per_seq_attn_latency": 0.0002653312498296145, "per_doc_allgather_latency": 0.24481293186545372, "per_doc_attn_latency": 0.026793371699750424, "num_seq_in_batch": 1024, "seq_len": 64, "num_heads": 64, "head_dim": 128, "cp": 8, "tp": 8, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"7": {"per_seq_latency": 1.274745559692383, "per_doc_latency": 130.01240234375, "perseq_allgather_time": 0.8260447949171066, "perseq_attn_time": 0.44149279594421387, "perdoc_allgather_time": 115.12521896362304, "perdoc_attn_time": 14.868611240386963, "output_shape": [8192, 64, 128]}, "0": {"per_seq_latency": 1.0657567977905273, "per_doc_latency": 135.4979248046875, "perseq_allgather_time": 0.6135487914085388, "perseq_attn_time": 0.437814399600029, "perdoc_allgather_time": 118.32777481079101, "perdoc_attn_time": 17.150296020507813, "output_shape": [8192, 64, 128]}, "4": {"per_seq_latency": 1.275011157989502, "per_doc_latency": 130.54117431640626, "perseq_allgather_time": 0.8306320011615753, "perseq_attn_time": 0.43757599890232085, "perdoc_allgather_time": 115.02311973571777, "perdoc_attn_time": 15.49784321784973, "output_shape": [8192, 64, 128]}, "1": {"per_seq_latency": 1.2752351760864258, "per_doc_latency": 130.99132080078124, "perseq_allgather_time": 0.8178544104099273, "perseq_attn_time": 0.44829919636249543, "perdoc_allgather_time": 115.49011535644532, "perdoc_attn_time": 15.478452825546265, "output_shape": [8192, 64, 128]}, "5": {"per_seq_latency": 1.2747695922851563, "per_doc_latency": 131.47476806640626, "perseq_allgather_time": 0.8321439951658249, "perseq_attn_time": 0.43586719781160355, "perdoc_allgather_time": 115.9390380859375, "perdoc_attn_time": 15.515606451034547, "output_shape": [8192, 64, 128]}, "2": {"per_seq_latency": 1.2749551773071288, "per_doc_latency": 129.23909912109374, "perseq_allgather_time": 0.830715212225914, "perseq_attn_time": 0.4372111976146698, "perdoc_allgather_time": 113.87940330505371, "perdoc_attn_time": 15.3397647857666, "output_shape": [8192, 64, 128]}, "3": {"per_seq_latency": 1.2751199722290039, "per_doc_latency": 130.70919189453124, "perseq_allgather_time": 0.8319023996591568, "perseq_attn_time": 0.43606879711151125, "perdoc_allgather_time": 115.01766052246094, "perdoc_attn_time": 15.671475219726563, "output_shape": [8192, 64, 128]}, "6": {"per_seq_latency": 1.2751551628112794, "per_doc_latency": 131.45377197265626, "perseq_allgather_time": 0.8343071907758712, "perseq_attn_time": 0.4340848013758659, "perdoc_allgather_time": 115.92575721740722, "perdoc_attn_time": 15.50676326751709, "output_shape": [8192, 64, 128]}, "per_seq_latency": 0.0024906937032938004, "per_doc_latency": 0.2646443843841553, "per_seq_allgather_latency": 0.0016295062319841235, "per_seq_attn_latency": 0.0008755843678954989, "per_doc_allgather_latency": 0.2311089351773262, "per_doc_attn_latency": 0.03349667191505432, "num_seq_in_batch": 512, "seq_len": 128, "num_heads": 64, "head_dim": 128, "cp": 8, "tp": 1, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"7": {"per_seq_latency": 1.0892831802368164, "per_doc_latency": 129.8605224609375, "perseq_allgather_time": 0.7870111897587776, "perseq_attn_time": 0.28609439730644226, "perdoc_allgather_time": 116.1365249633789, "perdoc_attn_time": 13.687472105026245, "output_shape": [8192, 32, 128]}, "0": {"per_seq_latency": 0.8922831535339355, "per_doc_latency": 135.11483154296874, "perseq_allgather_time": 0.5121935993432999, "perseq_attn_time": 0.3087487995624542, "perdoc_allgather_time": 117.19259643554688, "perdoc_attn_time": 17.75842080116272, "output_shape": [8192, 32, 128]}, "1": {"per_seq_latency": 1.0889472007751464, "per_doc_latency": 129.73912353515624, "perseq_allgather_time": 0.7760448053479194, "perseq_attn_time": 0.29130719900131224, "perdoc_allgather_time": 116.18122711181641, "perdoc_attn_time": 13.53686876296997, "output_shape": [8192, 32, 128]}, "5": {"per_seq_latency": 1.0887455940246582, "per_doc_latency": 133.95792236328126, "perseq_allgather_time": 0.7832144156098366, "perseq_attn_time": 0.28744159936904906, "perdoc_allgather_time": 120.24184112548828, "perdoc_attn_time": 13.695416116714478, "output_shape": [8192, 32, 128]}, "6": {"per_seq_latency": 1.1067760467529297, "per_doc_latency": 135.82135009765625, "perseq_allgather_time": 0.7721999928355217, "perseq_attn_time": 0.3025920018553734, "perdoc_allgather_time": 122.06839027404786, "perdoc_attn_time": 13.72648482322693, "output_shape": [8192, 32, 128]}, "4": {"per_seq_latency": 1.0886799812316894, "per_doc_latency": 133.022607421875, "perseq_allgather_time": 0.790350404381752, "perseq_attn_time": 0.28434560149908067, "perdoc_allgather_time": 119.18806381225586, "perdoc_attn_time": 13.814443254470826, "output_shape": [8192, 32, 128]}, "3": {"per_seq_latency": 1.0884623527526855, "per_doc_latency": 132.40689697265626, "perseq_allgather_time": 0.7719792038202286, "perseq_attn_time": 0.29382880181074145, "perdoc_allgather_time": 118.65241088867188, "perdoc_attn_time": 13.734460878372193, "output_shape": [8192, 32, 128]}, "2": {"per_seq_latency": 1.0887136459350586, "per_doc_latency": 129.09505615234374, "perseq_allgather_time": 0.7926064088940621, "perseq_attn_time": 0.2829472005367279, "perdoc_allgather_time": 115.24441261291504, "perdoc_attn_time": 13.829944133758545, "output_shape": [8192, 32, 128]}, "per_seq_latency": 0.002161671966314316, "per_doc_latency": 0.26527607440948486, "per_seq_allgather_latency": 0.001548059392371215, "per_seq_attn_latency": 0.0006030249991454184, "per_doc_allgather_latency": 0.23841482475399972, "per_doc_attn_latency": 0.03468441562727094, "num_seq_in_batch": 512, "seq_len": 128, "num_heads": 64, "head_dim": 128, "cp": 8, "tp": 2, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"7": {"per_seq_latency": 1.0076144218444825, "per_doc_latency": 126.3181640625, "perseq_allgather_time": 0.6994048014283181, "perseq_attn_time": 0.2370015986263752, "perdoc_allgather_time": 113.50676193237305, "perdoc_attn_time": 12.68212957382202, "output_shape": [8192, 16, 128]}, "0": {"per_seq_latency": 0.7892879962921142, "per_doc_latency": 133.28133544921874, "perseq_allgather_time": 0.37538560181856157, "perseq_attn_time": 0.2893375962972641, "perdoc_allgather_time": 117.54247360229492, "perdoc_attn_time": 15.264656019210815, "output_shape": [8192, 16, 128]}, "3": {"per_seq_latency": 1.0091919898986816, "per_doc_latency": 133.26942138671876, "perseq_allgather_time": 0.6917423903942108, "perseq_attn_time": 0.2423231989145279, "perdoc_allgather_time": 120.37088623046876, "perdoc_attn_time": 12.766303968429565, "output_shape": [8192, 16, 128]}, "1": {"per_seq_latency": 1.0101200103759767, "per_doc_latency": 129.3821044921875, "perseq_allgather_time": 0.6914448067545891, "perseq_attn_time": 0.2414768010377884, "perdoc_allgather_time": 118.87393798828126, "perdoc_attn_time": 10.405543971061707, "output_shape": [8192, 16, 128]}, "4": {"per_seq_latency": 1.0059087753295899, "per_doc_latency": 128.2354736328125, "perseq_allgather_time": 0.6783295899629593, "perseq_attn_time": 0.248038399964571, "perdoc_allgather_time": 117.60774993896484, "perdoc_attn_time": 10.496783924102782, "output_shape": [8192, 16, 128]}, "2": {"per_seq_latency": 1.0079279899597169, "per_doc_latency": 127.40107421875, "perseq_allgather_time": 0.6865792006254197, "perseq_attn_time": 0.24420960023999214, "perdoc_allgather_time": 114.48575286865234, "perdoc_attn_time": 12.79024796485901, "output_shape": [8192, 16, 128]}, "5": {"per_seq_latency": 1.0077024459838868, "per_doc_latency": 130.2445068359375, "perseq_allgather_time": 0.7047664001584053, "perseq_attn_time": 0.23354400098323821, "perdoc_allgather_time": 117.70830307006835, "perdoc_attn_time": 12.383604836463928, "output_shape": [8192, 16, 128]}, "6": {"per_seq_latency": 1.0078384399414062, "per_doc_latency": 133.4195556640625, "perseq_allgather_time": 0.6890736073255539, "perseq_attn_time": 0.24232639893889427, "perdoc_allgather_time": 120.37775382995605, "perdoc_attn_time": 12.841555213928222, "output_shape": [8192, 16, 128]}, "per_seq_latency": 0.0019728906452655794, "per_doc_latency": 0.26058506965637207, "per_seq_allgather_latency": 0.0013764968753093854, "per_seq_attn_latency": 0.0005651124927680939, "per_doc_allgather_latency": 0.2351128004491329, "per_doc_attn_latency": 0.029813781287521122, "num_seq_in_batch": 512, "seq_len": 128, "num_heads": 64, "head_dim": 128, "cp": 8, "tp": 4, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 0.733619213104248, "per_doc_latency": 131.63558349609374, "perseq_allgather_time": 0.3770160049200058, "perseq_attn_time": 0.2296527996659279, "perdoc_allgather_time": 115.22227401733399, "perdoc_attn_time": 15.62965922355652, "output_shape": [8192, 8, 128]}, "7": {"per_seq_latency": 0.9557359695434571, "per_doc_latency": 129.78240966796875, "perseq_allgather_time": 0.6411280080676078, "perseq_attn_time": 0.2223024010658264, "perdoc_allgather_time": 117.08922843933105, "perdoc_attn_time": 12.41169285774231, "output_shape": [8192, 8, 128]}, "4": {"per_seq_latency": 0.9554832458496094, "per_doc_latency": 131.066552734375, "perseq_allgather_time": 0.6458367943763733, "perseq_attn_time": 0.21533279940485955, "perdoc_allgather_time": 118.50207023620605, "perdoc_attn_time": 12.27740478515625, "output_shape": [8192, 8, 128]}, "1": {"per_seq_latency": 0.9576687812805176, "per_doc_latency": 129.54254150390625, "perseq_allgather_time": 0.6104959964752197, "perseq_attn_time": 0.24785759598016738, "perdoc_allgather_time": 116.80925750732422, "perdoc_attn_time": 12.441956806182862, "output_shape": [8192, 8, 128]}, "3": {"per_seq_latency": 0.9529279708862305, "per_doc_latency": 132.85733642578126, "perseq_allgather_time": 0.652771209180355, "perseq_attn_time": 0.21183360144495963, "perdoc_allgather_time": 120.17701644897461, "perdoc_attn_time": 12.399857521057129, "output_shape": [8192, 8, 128]}, "6": {"per_seq_latency": 0.9559472084045411, "per_doc_latency": 127.38670654296875, "perseq_allgather_time": 0.6537535935640335, "perseq_attn_time": 0.21204959899187087, "perdoc_allgather_time": 114.81599082946778, "perdoc_attn_time": 12.29041919708252, "output_shape": [8192, 8, 128]}, "5": {"per_seq_latency": 0.9553999900817871, "per_doc_latency": 127.817626953125, "perseq_allgather_time": 0.60364800542593, "perseq_attn_time": 0.2546112038195133, "perdoc_allgather_time": 115.2233512878418, "perdoc_attn_time": 12.28857593536377, "output_shape": [8192, 8, 128]}, "2": {"per_seq_latency": 0.9573792457580567, "per_doc_latency": 130.31182861328125, "perseq_allgather_time": 0.6550095975399017, "perseq_attn_time": 0.21283199787139892, "perdoc_allgather_time": 117.55868530273438, "perdoc_attn_time": 12.450553607940673, "output_shape": [8192, 8, 128]}, "per_seq_latency": 0.001870446838438511, "per_doc_latency": 0.259486985206604, "per_seq_allgather_latency": 0.0012793156201951206, "per_seq_attn_latency": 0.0004972875074599869, "per_doc_allgather_latency": 0.23472073525190354, "per_doc_attn_latency": 0.030526678171008827, "num_seq_in_batch": 512, "seq_len": 128, "num_heads": 64, "head_dim": 128, "cp": 8, "tp": 8, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"7": {"per_seq_latency": 1.3166959762573243, "per_doc_latency": 66.24313354492188, "perseq_allgather_time": 0.8066735982894897, "perseq_attn_time": 0.5032464042305946, "perdoc_allgather_time": 57.492513465881345, "perdoc_attn_time": 8.739537572860717, "output_shape": [8192, 64, 128]}, "0": {"per_seq_latency": 1.126155185699463, "per_doc_latency": 67.14893188476563, "perseq_allgather_time": 0.5828447937965393, "perseq_attn_time": 0.5147296011447906, "perdoc_allgather_time": 57.85153942108154, "perdoc_attn_time": 9.283451271057128, "output_shape": [8192, 64, 128]}, "4": {"per_seq_latency": 1.315337562561035, "per_doc_latency": 68.1054931640625, "perseq_allgather_time": 0.8000272035598754, "perseq_attn_time": 0.5050543949007988, "perdoc_allgather_time": 59.171366119384764, "perdoc_attn_time": 8.92293438911438, "output_shape": [8192, 64, 128]}, "2": {"per_seq_latency": 1.316220760345459, "per_doc_latency": 67.21431884765624, "perseq_allgather_time": 0.8026303946971893, "perseq_attn_time": 0.5063616022467613, "perdoc_allgather_time": 58.03651866912842, "perdoc_attn_time": 9.165412759780883, "output_shape": [8192, 64, 128]}, "5": {"per_seq_latency": 1.3162575721740724, "per_doc_latency": 66.99602661132812, "perseq_allgather_time": 0.80381920337677, "perseq_attn_time": 0.505675196647644, "perdoc_allgather_time": 58.24117240905762, "perdoc_attn_time": 8.742564868927001, "output_shape": [8192, 64, 128]}, "6": {"per_seq_latency": 1.316915225982666, "per_doc_latency": 65.28850708007812, "perseq_allgather_time": 0.8032448053359985, "perseq_attn_time": 0.5069632008671761, "perdoc_allgather_time": 56.43644275665283, "perdoc_attn_time": 8.841811180114746, "output_shape": [8192, 64, 128]}, "1": {"per_seq_latency": 1.316380786895752, "per_doc_latency": 66.54974365234375, "perseq_allgather_time": 0.8099359959363938, "perseq_attn_time": 0.4994367972016335, "perdoc_allgather_time": 57.821332931518555, "perdoc_attn_time": 8.718632173538207, "output_shape": [8192, 64, 128]}, "3": {"per_seq_latency": 1.3151488304138184, "per_doc_latency": 67.922900390625, "perseq_allgather_time": 0.80278559923172, "perseq_attn_time": 0.5051200047135354, "perdoc_allgather_time": 58.866768264770506, "perdoc_attn_time": 9.045657634735107, "output_shape": [8192, 64, 128]}, "per_seq_latency": 0.005144200101494789, "per_doc_latency": 0.2660370826721191, "per_seq_allgather_latency": 0.003163812484126538, "per_seq_attn_latency": 0.0020106625044718383, "per_doc_allgather_latency": 0.23113814890384674, "per_doc_attn_latency": 0.03626348152756691, "num_seq_in_batch": 256, "seq_len": 256, "num_heads": 64, "head_dim": 128, "cp": 8, "tp": 1, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 0.8157648086547852, "per_doc_latency": 68.87909545898438, "perseq_allgather_time": 0.45194239616394044, "perseq_attn_time": 0.3183615982532501, "perdoc_allgather_time": 60.91673564910889, "perdoc_attn_time": 7.844492769241333, "output_shape": [8192, 32, 128]}, "7": {"per_seq_latency": 1.0360416412353515, "per_doc_latency": 67.09537353515626, "perseq_allgather_time": 0.6992208048701286, "perseq_attn_time": 0.3234175994992256, "perdoc_allgather_time": 60.3172794342041, "perdoc_attn_time": 6.763590383529663, "output_shape": [8192, 32, 128]}, "1": {"per_seq_latency": 1.0364303588867188, "per_doc_latency": 66.53211059570313, "perseq_allgather_time": 0.6972031936049461, "perseq_attn_time": 0.3293152004480362, "perdoc_allgather_time": 59.020406341552736, "perdoc_attn_time": 7.493108797073364, "output_shape": [8192, 32, 128]}, "2": {"per_seq_latency": 1.035976028442383, "per_doc_latency": 67.00826416015624, "perseq_allgather_time": 0.7112719997763634, "perseq_attn_time": 0.3124640017747879, "perdoc_allgather_time": 59.55889949798584, "perdoc_attn_time": 7.43109278678894, "output_shape": [8192, 32, 128]}, "5": {"per_seq_latency": 1.0361632347106933, "per_doc_latency": 67.21910400390625, "perseq_allgather_time": 0.7086799934506416, "perseq_attn_time": 0.31793759763240814, "perdoc_allgather_time": 59.756218910217285, "perdoc_attn_time": 7.418015956878662, "output_shape": [8192, 32, 128]}, "6": {"per_seq_latency": 1.0363823890686035, "per_doc_latency": 67.08513793945312, "perseq_allgather_time": 0.7108303934335709, "perseq_attn_time": 0.3138480007648468, "perdoc_allgather_time": 59.60792903900146, "perdoc_attn_time": 7.458574414253235, "output_shape": [8192, 32, 128]}, "4": {"per_seq_latency": 1.0351519584655762, "per_doc_latency": 67.45791625976562, "perseq_allgather_time": 0.7052127882838249, "perseq_attn_time": 0.3195008009672165, "perdoc_allgather_time": 60.77120304107666, "perdoc_attn_time": 6.67139048576355, "output_shape": [8192, 32, 128]}, "3": {"per_seq_latency": 1.0362624168395995, "per_doc_latency": 66.84742431640625, "perseq_allgather_time": 0.7100991904735565, "perseq_attn_time": 0.3172784000635147, "perdoc_allgather_time": 59.24511833190918, "perdoc_attn_time": 7.584427237510681, "output_shape": [8192, 32, 128]}, "per_seq_latency": 0.004048556089401245, "per_doc_latency": 0.26905896663665774, "per_seq_allgather_latency": 0.0027784062491264193, "per_seq_attn_latency": 0.0012863875017501414, "per_doc_allgather_latency": 0.2379559986293316, "per_doc_attn_latency": 0.030642549879848956, "num_seq_in_batch": 256, "seq_len": 256, "num_heads": 64, "head_dim": 128, "cp": 8, "tp": 2, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 0.8555295944213868, "per_doc_latency": 67.18795776367188, "perseq_allgather_time": 0.4702496036887169, "perseq_attn_time": 0.26755999997258184, "perdoc_allgather_time": 60.168568229675294, "perdoc_attn_time": 6.861800050735473, "output_shape": [8192, 16, 128]}, "7": {"per_seq_latency": 1.0838560104370116, "per_doc_latency": 65.20162963867188, "perseq_allgather_time": 0.7595663994550705, "perseq_attn_time": 0.25177439823746683, "perdoc_allgather_time": 59.24822521209717, "perdoc_attn_time": 5.881905579566956, "output_shape": [8192, 16, 128]}, "1": {"per_seq_latency": 1.0834239959716796, "per_doc_latency": 64.929931640625, "perseq_allgather_time": 0.7628431960940361, "perseq_attn_time": 0.24939039945602418, "perdoc_allgather_time": 58.75583553314209, "perdoc_attn_time": 6.135660791397095, "output_shape": [8192, 16, 128]}, "4": {"per_seq_latency": 1.0798048019409179, "per_doc_latency": 64.04457397460938, "perseq_allgather_time": 0.753022401034832, "perseq_attn_time": 0.2596144013106823, "perdoc_allgather_time": 57.234507942199706, "perdoc_attn_time": 6.7330447912216185, "output_shape": [8192, 16, 128]}, "2": {"per_seq_latency": 1.0833680152893066, "per_doc_latency": 63.98301391601562, "perseq_allgather_time": 0.7522543996572495, "perseq_attn_time": 0.2604175999760628, "perdoc_allgather_time": 57.18026065826416, "perdoc_attn_time": 6.756979203224182, "output_shape": [8192, 16, 128]}, "5": {"per_seq_latency": 1.0891887664794921, "per_doc_latency": 64.05466918945312, "perseq_allgather_time": 0.7692047983407975, "perseq_attn_time": 0.2520495980978012, "perdoc_allgather_time": 58.08500652313232, "perdoc_attn_time": 5.896494436264038, "output_shape": [8192, 16, 128]}, "6": {"per_seq_latency": 1.0825519561767578, "per_doc_latency": 66.043798828125, "perseq_allgather_time": 0.7713776111602784, "perseq_attn_time": 0.24720319956541062, "perdoc_allgather_time": 60.906873321533205, "perdoc_attn_time": 5.07778080701828, "output_shape": [8192, 16, 128]}, "3": {"per_seq_latency": 1.0827775955200196, "per_doc_latency": 64.724365234375, "perseq_allgather_time": 0.7774528115987778, "perseq_attn_time": 0.23965919986367226, "perdoc_allgather_time": 57.818270683288574, "perdoc_attn_time": 6.87359037399292, "output_shape": [8192, 16, 128]}, "per_seq_latency": 0.004254643619060516, "per_doc_latency": 0.26245296001434326, "per_seq_allgather_latency": 0.0030369250453077257, "per_seq_attn_latency": 0.0010451562498928978, "per_doc_allgather_latency": 0.23791747391223908, "per_doc_attn_latency": 0.026849962398409845, "num_seq_in_batch": 256, "seq_len": 256, "num_heads": 64, "head_dim": 128, "cp": 8, "tp": 4, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"7": {"per_seq_latency": 0.9445775985717774, "per_doc_latency": 65.29519653320312, "perseq_allgather_time": 0.6530352041125298, "perseq_attn_time": 0.2050831988453865, "perdoc_allgather_time": 58.79867382049561, "perdoc_attn_time": 6.286268746852874, "output_shape": [8192, 8, 128]}, "0": {"per_seq_latency": 0.7156288146972656, "per_doc_latency": 65.24854125976563, "perseq_allgather_time": 0.3415184020996094, "perseq_attn_time": 0.25571359917521475, "perdoc_allgather_time": 58.30872001647949, "perdoc_attn_time": 6.547596788406372, "output_shape": [8192, 8, 128]}, "3": {"per_seq_latency": 0.9412783622741699, "per_doc_latency": 63.734246826171876, "perseq_allgather_time": 0.6268047988414764, "perseq_attn_time": 0.2205760009586811, "perdoc_allgather_time": 57.17956657409668, "perdoc_attn_time": 6.391292834281922, "output_shape": [8192, 8, 128]}, "6": {"per_seq_latency": 0.9489935874938965, "per_doc_latency": 64.13779296875, "perseq_allgather_time": 0.632443206012249, "perseq_attn_time": 0.21997919902205468, "perdoc_allgather_time": 57.89712657928467, "perdoc_attn_time": 6.0570672154426575, "output_shape": [8192, 8, 128]}, "4": {"per_seq_latency": 0.9433247566223144, "per_doc_latency": 63.813909912109374, "perseq_allgather_time": 0.652449594438076, "perseq_attn_time": 0.20205920040607453, "perdoc_allgather_time": 57.09364280700684, "perdoc_attn_time": 6.508078384399414, "output_shape": [8192, 8, 128]}, "1": {"per_seq_latency": 0.9445487976074218, "per_doc_latency": 63.94608764648437, "perseq_allgather_time": 0.6114159896969795, "perseq_attn_time": 0.23641760125756264, "perdoc_allgather_time": 57.29439144134521, "perdoc_attn_time": 6.486500811576843, "output_shape": [8192, 8, 128]}, "5": {"per_seq_latency": 0.9479200363159179, "per_doc_latency": 66.16217651367188, "perseq_allgather_time": 0.6233951970934868, "perseq_attn_time": 0.2269648015499115, "perdoc_allgather_time": 59.600776290893556, "perdoc_attn_time": 6.383479952812195, "output_shape": [8192, 8, 128]}, "2": {"per_seq_latency": 0.9428112030029296, "per_doc_latency": 63.54058837890625, "perseq_allgather_time": 0.6495871931314469, "perseq_attn_time": 0.20540320128202438, "perdoc_allgather_time": 56.80989112854004, "perdoc_attn_time": 6.565049576759338, "output_shape": [8192, 8, 128]}, "per_seq_latency": 0.0037070062011480332, "per_doc_latency": 0.2584460020065308, "per_seq_allgather_latency": 0.0025509187660645695, "per_seq_attn_latency": 0.0009988812467781826, "per_doc_allgather_latency": 0.23281553238630295, "per_doc_attn_latency": 0.025644724909216165, "num_seq_in_batch": 256, "seq_len": 256, "num_heads": 64, "head_dim": 128, "cp": 8, "tp": 8, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"7": {"per_seq_latency": 1.4866448402404786, "per_doc_latency": 35.071051025390624, "perseq_allgather_time": 0.8608911901712417, "perseq_attn_time": 0.6188575983047485, "perdoc_allgather_time": 30.03889102935791, "perdoc_attn_time": 5.024062371253967, "output_shape": [8192, 64, 128]}, "0": {"per_seq_latency": 1.2556544303894044, "per_doc_latency": 35.59600830078125, "perseq_allgather_time": 0.5967824012041092, "perseq_attn_time": 0.625134402513504, "perdoc_allgather_time": 30.08657102584839, "perdoc_attn_time": 5.495771217346191, "output_shape": [8192, 64, 128]}, "2": {"per_seq_latency": 1.4862128257751466, "per_doc_latency": 34.919253540039065, "perseq_allgather_time": 0.8647008061408996, "perseq_attn_time": 0.6144015967845917, "perdoc_allgather_time": 29.571454429626463, "perdoc_attn_time": 5.33896484375, "output_shape": [8192, 64, 128]}, "6": {"per_seq_latency": 1.4861599922180175, "per_doc_latency": 35.22091369628906, "perseq_allgather_time": 0.8530096054077149, "perseq_attn_time": 0.6264080047607422, "perdoc_allgather_time": 30.09089756011963, "perdoc_attn_time": 5.121609616279602, "output_shape": [8192, 64, 128]}, "1": {"per_seq_latency": 1.4862431526184081, "per_doc_latency": 34.972348022460935, "perseq_allgather_time": 0.8734784007072449, "perseq_attn_time": 0.6057792007923126, "perdoc_allgather_time": 29.459856033325195, "perdoc_attn_time": 5.504521584510803, "output_shape": [8192, 64, 128]}, "4": {"per_seq_latency": 1.4847200393676758, "per_doc_latency": 35.145074462890626, "perseq_allgather_time": 0.8723759979009629, "perseq_attn_time": 0.6055808037519455, "perdoc_allgather_time": 29.80306396484375, "perdoc_attn_time": 5.332692790031433, "output_shape": [8192, 64, 128]}, "5": {"per_seq_latency": 1.4849056243896483, "per_doc_latency": 35.512637329101565, "perseq_allgather_time": 0.8691231936216355, "perseq_attn_time": 0.6089344054460526, "perdoc_allgather_time": 30.335032176971435, "perdoc_attn_time": 5.170124840736389, "output_shape": [8192, 64, 128]}, "3": {"per_seq_latency": 1.485540771484375, "per_doc_latency": 34.907354736328124, "perseq_allgather_time": 0.8625839978456498, "perseq_attn_time": 0.6157903999090195, "perdoc_allgather_time": 29.741414546966553, "perdoc_attn_time": 5.157960033416748, "output_shape": [8192, 64, 128]}, "per_seq_latency": 0.011614412814378739, "per_doc_latency": 0.2780938148498535, "per_seq_allgather_latency": 0.006824050005525351, "per_seq_attn_latency": 0.0048938125371932985, "per_doc_allgather_latency": 0.23699243888258933, "per_doc_attn_latency": 0.04300407487899065, "num_seq_in_batch": 128, "seq_len": 512, "num_heads": 64, "head_dim": 128, "cp": 8, "tp": 1, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"7": {"per_seq_latency": 1.1449376106262208, "per_doc_latency": 33.713070678710935, "perseq_allgather_time": 0.7519840002059937, "perseq_attn_time": 0.38198399990797044, "perdoc_allgather_time": 30.20806255340576, "perdoc_attn_time": 3.498136019706726, "output_shape": [8192, 32, 128]}, "0": {"per_seq_latency": 0.8876015663146972, "per_doc_latency": 33.940371704101565, "perseq_allgather_time": 0.4392415970563889, "perseq_attn_time": 0.40259040147066116, "perdoc_allgather_time": 29.88562078475952, "perdoc_attn_time": 3.99557603597641, "output_shape": [8192, 32, 128]}, "6": {"per_seq_latency": 1.1446335792541504, "per_doc_latency": 33.602352905273435, "perseq_allgather_time": 0.7452575922012329, "perseq_attn_time": 0.390801602602005, "perdoc_allgather_time": 29.078049755096437, "perdoc_attn_time": 4.513119959831238, "output_shape": [8192, 32, 128]}, "1": {"per_seq_latency": 1.1451007843017578, "per_doc_latency": 33.597625732421875, "perseq_allgather_time": 0.7594384014606476, "perseq_attn_time": 0.37665440142154694, "perdoc_allgather_time": 29.038347244262695, "perdoc_attn_time": 4.5484415769577025, "output_shape": [8192, 32, 128]}, "5": {"per_seq_latency": 1.1450511932373046, "per_doc_latency": 33.671636962890624, "perseq_allgather_time": 0.7653168022632599, "perseq_attn_time": 0.37298719882965087, "perdoc_allgather_time": 29.783376026153565, "perdoc_attn_time": 3.880188834667206, "output_shape": [8192, 32, 128]}, "3": {"per_seq_latency": 1.1451871871948243, "per_doc_latency": 34.348757934570315, "perseq_allgather_time": 0.7327488020062447, "perseq_attn_time": 0.4010943979024887, "perdoc_allgather_time": 29.63378095626831, "perdoc_attn_time": 4.703169584274292, "output_shape": [8192, 32, 128]}, "2": {"per_seq_latency": 1.1452336311340332, "per_doc_latency": 33.154547119140624, "perseq_allgather_time": 0.7469472020864487, "perseq_attn_time": 0.3803919985890388, "perdoc_allgather_time": 29.134833526611327, "perdoc_attn_time": 4.009884774684906, "output_shape": [8192, 32, 128]}, "4": {"per_seq_latency": 1.1450816154479981, "per_doc_latency": 33.533511352539065, "perseq_allgather_time": 0.7658752009272576, "perseq_attn_time": 0.37247679829597474, "perdoc_allgather_time": 29.025595569610594, "perdoc_attn_time": 4.4975823879241945, "output_shape": [8192, 32, 128]}, "per_seq_latency": 0.008947137743234634, "per_doc_latency": 0.2683496713638306, "per_seq_allgather_latency": 0.0059834000072442, "per_seq_attn_latency": 0.0031452375114895403, "per_doc_allgather_latency": 0.2360004886984825, "per_doc_attn_latency": 0.036743512377142906, "num_seq_in_batch": 128, "seq_len": 512, "num_heads": 64, "head_dim": 128, "cp": 8, "tp": 2, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 0.7914576053619384, "per_doc_latency": 33.230615234375, "perseq_allgather_time": 0.38987360894680023, "perseq_attn_time": 0.3122160017490387, "perdoc_allgather_time": 29.391190338134766, "perdoc_attn_time": 3.704076826572418, "output_shape": [8192, 16, 128]}, "7": {"per_seq_latency": 1.0919520378112793, "per_doc_latency": 33.318389892578125, "perseq_allgather_time": 0.7764400094747543, "perseq_attn_time": 0.26571040153503417, "perdoc_allgather_time": 29.374267196655275, "perdoc_attn_time": 3.8856335997581484, "output_shape": [8192, 16, 128]}, "5": {"per_seq_latency": 1.091539192199707, "per_doc_latency": 32.96502685546875, "perseq_allgather_time": 0.7874623939394951, "perseq_attn_time": 0.26034080013632777, "perdoc_allgather_time": 29.02770233154297, "perdoc_attn_time": 3.8954415798187254, "output_shape": [8192, 16, 128]}, "4": {"per_seq_latency": 1.1002703666687013, "per_doc_latency": 32.628726196289065, "perseq_allgather_time": 0.7640671983361245, "perseq_attn_time": 0.282284801453352, "perdoc_allgather_time": 29.043337440490724, "perdoc_attn_time": 3.558467209339142, "output_shape": [8192, 16, 128]}, "2": {"per_seq_latency": 1.0910719871520995, "per_doc_latency": 32.678125, "perseq_allgather_time": 0.7423472002148628, "perseq_attn_time": 0.2936383992433548, "perdoc_allgather_time": 28.704420852661134, "perdoc_attn_time": 3.9428655982017515, "output_shape": [8192, 16, 128]}, "1": {"per_seq_latency": 1.0926272392272949, "per_doc_latency": 33.35708923339844, "perseq_allgather_time": 0.7433264091610908, "perseq_attn_time": 0.29171519801020623, "perdoc_allgather_time": 29.333183765411377, "perdoc_attn_time": 3.9713120222091676, "output_shape": [8192, 16, 128]}, "3": {"per_seq_latency": 1.0944463729858398, "per_doc_latency": 32.642181396484375, "perseq_allgather_time": 0.7947920128703118, "perseq_attn_time": 0.2570528000593185, "perdoc_allgather_time": 28.657102584838867, "perdoc_attn_time": 3.944851207733154, "output_shape": [8192, 16, 128]}, "6": {"per_seq_latency": 1.0931407928466796, "per_doc_latency": 33.48761901855469, "perseq_allgather_time": 0.7766207829117775, "perseq_attn_time": 0.26950719878077506, "perdoc_allgather_time": 29.502524757385252, "perdoc_attn_time": 3.922000002861023, "output_shape": [8192, 16, 128]}, "per_seq_latency": 0.008595862239599229, "per_doc_latency": 0.2616220235824585, "per_seq_allgather_latency": 0.006209312600549311, "per_seq_attn_latency": 0.0024391875136643647, "per_doc_allgather_latency": 0.23048847466707229, "per_doc_attn_latency": 0.03102587517350912, "num_seq_in_batch": 128, "seq_len": 512, "num_heads": 64, "head_dim": 128, "cp": 8, "tp": 4, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"7": {"per_seq_latency": 0.9833375930786132, "per_doc_latency": 31.767703247070312, "perseq_allgather_time": 0.681224012374878, "perseq_attn_time": 0.21261759847402573, "perdoc_allgather_time": 28.13447198867798, "perdoc_attn_time": 3.4773136019706725, "output_shape": [8192, 8, 128]}, "0": {"per_seq_latency": 0.7764463901519776, "per_doc_latency": 33.10295715332031, "perseq_allgather_time": 0.3847375988960266, "perseq_attn_time": 0.25432799831032754, "perdoc_allgather_time": 29.295115184783935, "perdoc_attn_time": 3.5906639814376833, "output_shape": [8192, 8, 128]}, "3": {"per_seq_latency": 0.9833647727966308, "per_doc_latency": 32.42052307128906, "perseq_allgather_time": 0.6856399893760681, "perseq_attn_time": 0.21045919880270958, "perdoc_allgather_time": 28.746894454956056, "perdoc_attn_time": 3.529916822910309, "output_shape": [8192, 8, 128]}, "6": {"per_seq_latency": 0.9876895904541015, "per_doc_latency": 31.903036499023436, "perseq_allgather_time": 0.6580896094441414, "perseq_attn_time": 0.23364959955215453, "perdoc_allgather_time": 28.199591827392577, "perdoc_attn_time": 3.4967648148536683, "output_shape": [8192, 8, 128]}, "2": {"per_seq_latency": 0.986184024810791, "per_doc_latency": 31.6485107421875, "perseq_allgather_time": 0.6771664127707482, "perseq_attn_time": 0.21471680030226709, "perdoc_allgather_time": 28.00001745223999, "perdoc_attn_time": 3.526728022098541, "output_shape": [8192, 8, 128]}, "1": {"per_seq_latency": 0.9834192276000977, "per_doc_latency": 32.121054077148436, "perseq_allgather_time": 0.6556544005870819, "perseq_attn_time": 0.22940800040960313, "perdoc_allgather_time": 28.48807849884033, "perdoc_attn_time": 3.528774380683899, "output_shape": [8192, 8, 128]}, "4": {"per_seq_latency": 0.9831952095031739, "per_doc_latency": 31.922390747070313, "perseq_allgather_time": 0.6688672006130219, "perseq_attn_time": 0.22085760161280632, "perdoc_allgather_time": 29.140558528900147, "perdoc_attn_time": 2.661260795593262, "output_shape": [8192, 8, 128]}, "5": {"per_seq_latency": 0.9828240394592285, "per_doc_latency": 32.25516357421875, "perseq_allgather_time": 0.6827311933040618, "perseq_attn_time": 0.21117120012640953, "perdoc_allgather_time": 28.595670700073242, "perdoc_attn_time": 3.5110016226768495, "output_shape": [8192, 8, 128]}, "per_seq_latency": 0.007716324925422668, "per_doc_latency": 0.25861685276031493, "per_seq_allgather_latency": 0.005356562417000532, "per_seq_attn_latency": 0.001986937486799434, "per_doc_allgather_latency": 0.2288680873811245, "per_doc_attn_latency": 0.0280520623549819, "num_seq_in_batch": 128, "seq_len": 512, "num_heads": 64, "head_dim": 128, "cp": 8, "tp": 8, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 1.4359295845031739, "per_doc_latency": 21.431202697753907, "perseq_allgather_time": 0.6349887937307358, "perseq_attn_time": 0.7817823976278305, "perdoc_allgather_time": 17.064366388320924, "perdoc_attn_time": 4.359680008888245, "output_shape": [8192, 64, 128]}, "7": {"per_seq_latency": 1.660041618347168, "per_doc_latency": 21.481451416015624, "perseq_allgather_time": 0.8634447991847992, "perseq_attn_time": 0.7898624062538147, "perdoc_allgather_time": 17.49212336540222, "perdoc_attn_time": 3.9827216029167176, "output_shape": [8192, 64, 128]}, "3": {"per_seq_latency": 1.6591104507446288, "per_doc_latency": 21.488804626464844, "perseq_allgather_time": 0.8667871981859208, "perseq_attn_time": 0.7850784003734589, "perdoc_allgather_time": 17.30996952056885, "perdoc_attn_time": 4.171624040603637, "output_shape": [8192, 64, 128]}, "2": {"per_seq_latency": 1.6586368560791016, "per_doc_latency": 21.523365783691407, "perseq_allgather_time": 0.8638016015291214, "perseq_attn_time": 0.7876176059246063, "perdoc_allgather_time": 17.29306564331055, "perdoc_attn_time": 4.223112034797668, "output_shape": [8192, 64, 128]}, "4": {"per_seq_latency": 1.6588943481445313, "per_doc_latency": 21.504971313476563, "perseq_allgather_time": 0.8508912056684494, "perseq_attn_time": 0.7990112006664276, "perdoc_allgather_time": 17.385508918762206, "perdoc_attn_time": 4.112795209884643, "output_shape": [8192, 64, 128]}, "1": {"per_seq_latency": 1.6590047836303712, "per_doc_latency": 21.487657165527345, "perseq_allgather_time": 0.8425455838441849, "perseq_attn_time": 0.8091792076826095, "perdoc_allgather_time": 17.20091986656189, "perdoc_attn_time": 4.279510402679444, "output_shape": [8192, 64, 128]}, "6": {"per_seq_latency": 1.6606592178344726, "per_doc_latency": 21.629566955566407, "perseq_allgather_time": 0.8652208179235459, "perseq_attn_time": 0.7887600004673004, "perdoc_allgather_time": 17.607404804229738, "perdoc_attn_time": 4.015468776226044, "output_shape": [8192, 64, 128]}, "5": {"per_seq_latency": 1.6600175857543946, "per_doc_latency": 21.350164794921874, "perseq_allgather_time": 0.8721103996038437, "perseq_attn_time": 0.7812095999717712, "perdoc_allgather_time": 17.21554880142212, "perdoc_attn_time": 4.127921628952026, "output_shape": [8192, 64, 128]}, "per_seq_latency": 0.025947800278663634, "per_doc_latency": 0.3379619836807251, "per_seq_allgather_latency": 0.013626724993810058, "per_seq_attn_latency": 0.012643425120040774, "per_doc_allgather_latency": 0.27511570006608965, "per_doc_attn_latency": 0.06812000013887883, "num_seq_in_batch": 64, "seq_len": 1024, "num_heads": 64, "head_dim": 128, "cp": 8, "tp": 1, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"7": {"per_seq_latency": 1.1869935989379883, "per_doc_latency": 19.485877990722656, "perseq_allgather_time": 0.7025648057460785, "perseq_attn_time": 0.47771520018577573, "perdoc_allgather_time": 16.88177146911621, "perdoc_attn_time": 2.5966143727302553, "output_shape": [8192, 32, 128]}, "0": {"per_seq_latency": 0.9806783676147461, "per_doc_latency": 19.539030456542967, "perseq_allgather_time": 0.46308480352163317, "perseq_attn_time": 0.48737759590148927, "perdoc_allgather_time": 16.76296172142029, "perdoc_attn_time": 2.744825577735901, "output_shape": [8192, 32, 128]}, "6": {"per_seq_latency": 1.1869071960449218, "per_doc_latency": 19.900987243652345, "perseq_allgather_time": 0.6926127880811691, "perseq_attn_time": 0.4861199989914894, "perdoc_allgather_time": 17.17372307777405, "perdoc_attn_time": 2.719041574001312, "output_shape": [8192, 32, 128]}, "4": {"per_seq_latency": 1.1864560127258301, "per_doc_latency": 19.399668884277343, "perseq_allgather_time": 0.687307195365429, "perseq_attn_time": 0.490388797223568, "perdoc_allgather_time": 16.744705724716187, "perdoc_attn_time": 2.6466880321502684, "output_shape": [8192, 32, 128]}, "1": {"per_seq_latency": 1.1864272117614747, "per_doc_latency": 19.554713439941406, "perseq_allgather_time": 0.6823840007185936, "perseq_attn_time": 0.4944432005286217, "perdoc_allgather_time": 16.815177488327027, "perdoc_attn_time": 2.718767988681793, "output_shape": [8192, 32, 128]}, "2": {"per_seq_latency": 1.1869359970092774, "per_doc_latency": 19.408416748046875, "perseq_allgather_time": 0.7000495970249176, "perseq_attn_time": 0.479851196706295, "perdoc_allgather_time": 16.692847967147827, "perdoc_attn_time": 2.707744002342224, "output_shape": [8192, 32, 128]}, "3": {"per_seq_latency": 1.1869024276733398, "per_doc_latency": 19.608973693847656, "perseq_allgather_time": 0.6602896094322205, "perseq_attn_time": 0.48018079847097395, "perdoc_allgather_time": 16.981742429733277, "perdoc_attn_time": 2.6201728105545046, "output_shape": [8192, 32, 128]}, "5": {"per_seq_latency": 1.1867535591125489, "per_doc_latency": 19.48656005859375, "perseq_allgather_time": 0.6894415900111198, "perseq_attn_time": 0.4895791977643967, "perdoc_allgather_time": 16.88719038963318, "perdoc_attn_time": 2.5925536155700684, "output_shape": [8192, 32, 128]}, "per_seq_latency": 0.018546774983406067, "per_doc_latency": 0.3109529256820679, "per_seq_allgather_latency": 0.010977575089782476, "per_seq_attn_latency": 0.007725675008259714, "per_doc_allgather_latency": 0.2683394230902195, "per_doc_attn_latency": 0.04288789965212345, "num_seq_in_batch": 64, "seq_len": 1024, "num_heads": 64, "head_dim": 128, "cp": 8, "tp": 2, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 0.8612303733825684, "per_doc_latency": 18.217044067382812, "perseq_allgather_time": 0.4732063993811607, "perseq_attn_time": 0.3524959996342659, "perdoc_allgather_time": 15.836112117767334, "perdoc_attn_time": 2.3295488238334654, "output_shape": [8192, 16, 128]}, "7": {"per_seq_latency": 1.1202768325805663, "per_doc_latency": 18.213777160644533, "perseq_allgather_time": 0.7611328095197678, "perseq_attn_time": 0.33844479769468305, "perdoc_allgather_time": 15.952350282669068, "perdoc_attn_time": 2.2343600034713744, "output_shape": [8192, 16, 128]}, "4": {"per_seq_latency": 1.1174256324768066, "per_doc_latency": 18.228126525878906, "perseq_allgather_time": 0.7673408031463623, "perseq_attn_time": 0.33050559312105177, "perdoc_allgather_time": 16.03554711341858, "perdoc_attn_time": 2.162028807401657, "output_shape": [8192, 16, 128]}, "5": {"per_seq_latency": 1.124852752685547, "per_doc_latency": 18.148129272460938, "perseq_allgather_time": 0.7661071881651879, "perseq_attn_time": 0.33684160113334655, "perdoc_allgather_time": 15.784135866165162, "perdoc_attn_time": 2.3416287899017334, "output_shape": [8192, 16, 128]}, "2": {"per_seq_latency": 1.1189552307128907, "per_doc_latency": 18.100169372558593, "perseq_allgather_time": 0.7672479972243309, "perseq_attn_time": 0.3289696007966995, "perdoc_allgather_time": 15.853476858139038, "perdoc_attn_time": 2.2388143956661226, "output_shape": [8192, 16, 128]}, "1": {"per_seq_latency": 1.1194191932678224, "per_doc_latency": 18.151995849609374, "perseq_allgather_time": 0.7706223800778389, "perseq_attn_time": 0.32957439720630644, "perdoc_allgather_time": 15.787785625457763, "perdoc_attn_time": 2.3445663928985594, "output_shape": [8192, 16, 128]}, "3": {"per_seq_latency": 1.1173775672912598, "per_doc_latency": 17.96864013671875, "perseq_allgather_time": 0.7693952098488808, "perseq_attn_time": 0.3262319967150688, "perdoc_allgather_time": 15.594267272949219, "perdoc_attn_time": 2.361299204826355, "output_shape": [8192, 16, 128]}, "6": {"per_seq_latency": 1.120894432067871, "per_doc_latency": 17.888328552246094, "perseq_allgather_time": 0.7207120046019554, "perseq_attn_time": 0.3617664039134979, "perdoc_allgather_time": 15.57783522605896, "perdoc_attn_time": 2.295425605773926, "output_shape": [8192, 16, 128]}, "per_seq_latency": 0.01757582426071167, "per_doc_latency": 0.2848144769668579, "per_seq_allgather_latency": 0.012040974688716233, "per_seq_attn_latency": 0.005652600061148405, "per_doc_allgather_latency": 0.2505554236471653, "per_doc_attn_latency": 0.036895300075411794, "num_seq_in_batch": 64, "seq_len": 1024, "num_heads": 64, "head_dim": 128, "cp": 8, "tp": 4, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 0.7813151836395263, "per_doc_latency": 18.705360412597656, "perseq_allgather_time": 0.39625599682331086, "perseq_attn_time": 0.26641279757022857, "perdoc_allgather_time": 16.446919775009157, "perdoc_attn_time": 2.12119197845459, "output_shape": [8192, 8, 128]}, "7": {"per_seq_latency": 1.009663963317871, "per_doc_latency": 18.044273376464844, "perseq_allgather_time": 0.7085663944482803, "perseq_attn_time": 0.23012800067663192, "perdoc_allgather_time": 15.987116861343384, "perdoc_attn_time": 1.9307503879070282, "output_shape": [8192, 8, 128]}, "4": {"per_seq_latency": 1.0091456413269042, "per_doc_latency": 18.19611511230469, "perseq_allgather_time": 0.6886208072304726, "perseq_attn_time": 0.24228159859776496, "perdoc_allgather_time": 16.22182869911194, "perdoc_attn_time": 1.8656031847000123, "output_shape": [8192, 8, 128]}, "5": {"per_seq_latency": 1.009347152709961, "per_doc_latency": 18.16077880859375, "perseq_allgather_time": 0.6568575903773308, "perseq_attn_time": 0.26365440115332606, "perdoc_allgather_time": 15.987854480743408, "perdoc_attn_time": 2.0517055869102476, "output_shape": [8192, 8, 128]}, "1": {"per_seq_latency": 1.0100048065185547, "per_doc_latency": 18.280194091796876, "perseq_allgather_time": 0.6970080137252808, "perseq_attn_time": 0.23775359839200974, "perdoc_allgather_time": 16.096833515167237, "perdoc_attn_time": 2.0930895805358887, "output_shape": [8192, 8, 128]}, "3": {"per_seq_latency": 1.0160752296447755, "per_doc_latency": 18.799539184570314, "perseq_allgather_time": 0.6447519928216934, "perseq_attn_time": 0.27572639659047127, "perdoc_allgather_time": 16.637268781661987, "perdoc_attn_time": 2.058747208118439, "output_shape": [8192, 8, 128]}, "6": {"per_seq_latency": 1.010153579711914, "per_doc_latency": 18.084889221191407, "perseq_allgather_time": 0.6875663980841636, "perseq_attn_time": 0.24493920356035231, "perdoc_allgather_time": 15.977640008926391, "perdoc_attn_time": 1.9805791914463042, "output_shape": [8192, 8, 128]}, "2": {"per_seq_latency": 1.0090800285339356, "per_doc_latency": 18.278140258789062, "perseq_allgather_time": 0.6833119928836823, "perseq_attn_time": 0.24602400064468383, "perdoc_allgather_time": 16.08292636871338, "perdoc_attn_time": 2.084414374828339, "output_shape": [8192, 8, 128]}, "per_seq_latency": 0.015876175463199617, "per_doc_latency": 0.29374279975891116, "per_seq_allgather_latency": 0.01107134991325438, "per_seq_attn_latency": 0.0043082249467261136, "per_doc_allgather_latency": 0.25995732471346855, "per_doc_attn_latency": 0.033143624663352966, "num_seq_in_batch": 64, "seq_len": 1024, "num_heads": 64, "head_dim": 128, "cp": 8, "tp": 8, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 1.7732479095458984, "per_doc_latency": 13.313990783691406, "perseq_allgather_time": 0.5827311962842942, "perseq_attn_time": 1.175822389125824, "perdoc_allgather_time": 9.334904050827026, "perdoc_attn_time": 3.9720383882522583, "output_shape": [8192, 64, 128]}, "7": {"per_seq_latency": 1.9835391998291017, "per_doc_latency": 13.313555908203124, "perseq_allgather_time": 0.8076976060867309, "perseq_attn_time": 1.1690831899642944, "perdoc_allgather_time": 9.636444854736329, "perdoc_attn_time": 3.670342409610748, "output_shape": [8192, 64, 128]}, "5": {"per_seq_latency": 1.9842063903808593, "per_doc_latency": 13.3091064453125, "perseq_allgather_time": 0.8009296119213104, "perseq_attn_time": 1.1765967965126038, "perdoc_allgather_time": 9.60687026977539, "perdoc_attn_time": 3.6954848051071165, "output_shape": [8192, 64, 128]}, "2": {"per_seq_latency": 1.9836944580078124, "per_doc_latency": 13.316917419433594, "perseq_allgather_time": 0.797956794500351, "perseq_attn_time": 1.1785263955593108, "perdoc_allgather_time": 9.461015987396241, "perdoc_attn_time": 3.848795199394226, "output_shape": [8192, 64, 128]}, "3": {"per_seq_latency": 1.9840768814086913, "per_doc_latency": 13.312174987792968, "perseq_allgather_time": 0.8009696006774902, "perseq_attn_time": 1.1760064005851745, "perdoc_allgather_time": 9.503107261657714, "perdoc_attn_time": 3.8019904017448427, "output_shape": [8192, 64, 128]}, "4": {"per_seq_latency": 1.9847856521606446, "per_doc_latency": 13.308757019042968, "perseq_allgather_time": 0.7960303843021392, "perseq_attn_time": 1.18195042014122, "perdoc_allgather_time": 9.551062297821044, "perdoc_attn_time": 3.750825583934784, "output_shape": [8192, 64, 128]}, "1": {"per_seq_latency": 1.9859424591064454, "per_doc_latency": 13.31457061767578, "perseq_allgather_time": 0.8075008004903793, "perseq_attn_time": 1.1713392078876494, "perdoc_allgather_time": 9.408313512802124, "perdoc_attn_time": 3.8990991830825807, "output_shape": [8192, 64, 128]}, "6": {"per_seq_latency": 1.984511947631836, "per_doc_latency": 13.309956359863282, "perseq_allgather_time": 0.8050560086965561, "perseq_attn_time": 1.1726143896579742, "perdoc_allgather_time": 9.591387176513672, "perdoc_attn_time": 3.7117680072784425, "output_shape": [8192, 64, 128]}, "per_seq_latency": 0.06206070184707642, "per_doc_latency": 0.4161536693572998, "per_seq_allgather_latency": 0.02524055019021034, "per_seq_attn_latency": 0.03693595062941313, "per_doc_allgather_latency": 0.3011389017105103, "per_doc_attn_latency": 0.12412619963288307, "num_seq_in_batch": 32, "seq_len": 2048, "num_heads": 64, "head_dim": 128, "cp": 8, "tp": 1, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 1.1541296005249024, "per_doc_latency": 9.692750549316406, "perseq_allgather_time": 0.40618400275707245, "perseq_attn_time": 0.7193199902772903, "perdoc_allgather_time": 7.399854421615601, "perdoc_attn_time": 2.2809759974479675, "output_shape": [8192, 32, 128]}, "7": {"per_seq_latency": 1.3793536186218263, "per_doc_latency": 9.639920043945313, "perseq_allgather_time": 0.6578400045633316, "perseq_attn_time": 0.7136063992977142, "perdoc_allgather_time": 7.5399264097213745, "perdoc_attn_time": 2.0931648135185243, "output_shape": [8192, 32, 128]}, "4": {"per_seq_latency": 1.3790399551391601, "per_doc_latency": 9.573091125488281, "perseq_allgather_time": 0.6763792142271996, "perseq_attn_time": 0.6958783984184265, "perdoc_allgather_time": 7.39389443397522, "perdoc_attn_time": 2.1718640089035035, "output_shape": [8192, 32, 128]}, "2": {"per_seq_latency": 1.379035186767578, "per_doc_latency": 9.66921157836914, "perseq_allgather_time": 0.6697391927242279, "perseq_attn_time": 0.7013663947582245, "perdoc_allgather_time": 7.444993591308593, "perdoc_attn_time": 2.2170719861984254, "output_shape": [8192, 32, 128]}, "5": {"per_seq_latency": 1.380729579925537, "per_doc_latency": 9.6309326171875, "perseq_allgather_time": 0.6580671966075897, "perseq_attn_time": 0.7129520058631897, "perdoc_allgather_time": 7.498916840553283, "perdoc_attn_time": 2.1251936078071596, "output_shape": [8192, 32, 128]}, "3": {"per_seq_latency": 1.379646396636963, "per_doc_latency": 9.602365112304687, "perseq_allgather_time": 0.6740960031747818, "perseq_attn_time": 0.6984495967626572, "perdoc_allgather_time": 7.352175998687744, "perdoc_attn_time": 2.2430767893791197, "output_shape": [8192, 32, 128]}, "6": {"per_seq_latency": 1.3796112060546875, "per_doc_latency": 9.620137786865234, "perseq_allgather_time": 0.6693232104182243, "perseq_attn_time": 0.7029920041561126, "perdoc_allgather_time": 7.513768029212952, "perdoc_attn_time": 2.0996224164962767, "output_shape": [8192, 32, 128]}, "1": {"per_seq_latency": 1.379475212097168, "per_doc_latency": 9.558968353271485, "perseq_allgather_time": 0.6723248049616813, "perseq_attn_time": 0.7000288039445877, "perdoc_allgather_time": 7.324830436706543, "perdoc_attn_time": 2.226979160308838, "output_shape": [8192, 32, 128]}, "per_seq_latency": 0.04314779937267303, "per_doc_latency": 0.3028984546661377, "per_seq_allgather_latency": 0.021136850444599987, "per_seq_attn_latency": 0.022478749696165323, "per_doc_allgather_latency": 0.23562270030379295, "per_doc_attn_latency": 0.07128049992024899, "num_seq_in_batch": 32, "seq_len": 2048, "num_heads": 64, "head_dim": 128, "cp": 8, "tp": 2, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"7": {"per_seq_latency": 1.1048751831054688, "per_doc_latency": 8.4934814453125, "perseq_allgather_time": 0.6289343908429146, "perseq_attn_time": 0.4684016019105911, "perdoc_allgather_time": 7.050452780723572, "perdoc_attn_time": 1.4167519986629487, "output_shape": [8192, 16, 128]}, "0": {"per_seq_latency": 0.8902704238891601, "per_doc_latency": 8.63977279663086, "perseq_allgather_time": 0.32969280034303666, "perseq_attn_time": 0.517163197696209, "perdoc_allgather_time": 7.08927845954895, "perdoc_attn_time": 1.52010880112648, "output_shape": [8192, 16, 128]}, "3": {"per_seq_latency": 1.1046751976013183, "per_doc_latency": 8.397332763671875, "perseq_allgather_time": 0.6085103906691074, "perseq_attn_time": 0.4843280017375946, "perdoc_allgather_time": 6.947887969017029, "perdoc_attn_time": 1.440304011106491, "output_shape": [8192, 16, 128]}, "4": {"per_seq_latency": 1.1046655654907227, "per_doc_latency": 8.50964126586914, "perseq_allgather_time": 0.641358396410942, "perseq_attn_time": 0.4566223993897438, "perdoc_allgather_time": 7.0938063859939575, "perdoc_attn_time": 1.4053232073783875, "output_shape": [8192, 16, 128]}, "5": {"per_seq_latency": 1.112452793121338, "per_doc_latency": 8.58249282836914, "perseq_allgather_time": 0.615731206536293, "perseq_attn_time": 0.4844992011785507, "perdoc_allgather_time": 7.122646403312683, "perdoc_attn_time": 1.4440671980381012, "output_shape": [8192, 16, 128]}, "2": {"per_seq_latency": 1.104047966003418, "per_doc_latency": 8.635523223876953, "perseq_allgather_time": 0.5970320053398609, "perseq_attn_time": 0.49339199513196946, "perdoc_allgather_time": 7.149860811233521, "perdoc_attn_time": 1.475107192993164, "output_shape": [8192, 16, 128]}, "6": {"per_seq_latency": 1.1042112350463866, "per_doc_latency": 8.543608093261719, "perseq_allgather_time": 0.6315584108233452, "perseq_attn_time": 0.46330719739198684, "perdoc_allgather_time": 7.093503928184509, "perdoc_attn_time": 1.4337472081184388, "output_shape": [8192, 16, 128]}, "1": {"per_seq_latency": 1.1043935775756837, "per_doc_latency": 8.45080337524414, "perseq_allgather_time": 0.6377360120415687, "perseq_attn_time": 0.4594976007938385, "perdoc_allgather_time": 6.9397104501724245, "perdoc_attn_time": 1.4894304037094117, "output_shape": [8192, 16, 128]}, "per_seq_latency": 0.03476414978504181, "per_doc_latency": 0.26999289989471437, "per_seq_allgather_latency": 0.02004244988784194, "per_seq_attn_latency": 0.01616134992800653, "per_doc_allgather_latency": 0.22343315035104752, "per_doc_attn_latency": 0.0475034000352025, "num_seq_in_batch": 32, "seq_len": 2048, "num_heads": 64, "head_dim": 128, "cp": 8, "tp": 4, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 0.7739568233489991, "per_doc_latency": 8.213471984863281, "perseq_allgather_time": 0.36177600026130674, "perseq_attn_time": 0.3563248008489609, "perdoc_allgather_time": 6.802494382858276, "perdoc_attn_time": 1.3298896074295044, "output_shape": [8192, 8, 128]}, "7": {"per_seq_latency": 1.0053407669067382, "per_doc_latency": 8.152079772949218, "perseq_allgather_time": 0.6553712129592896, "perseq_attn_time": 0.330862395465374, "perdoc_allgather_time": 6.803705620765686, "perdoc_attn_time": 1.250776007771492, "output_shape": [8192, 8, 128]}, "2": {"per_seq_latency": 1.0050607681274415, "per_doc_latency": 8.151665496826173, "perseq_allgather_time": 0.6372111976146698, "perseq_attn_time": 0.33569439947605134, "perdoc_allgather_time": 6.843068838119507, "perdoc_attn_time": 1.2466815888881684, "output_shape": [8192, 8, 128]}, "1": {"per_seq_latency": 1.0274415969848634, "per_doc_latency": 8.194937896728515, "perseq_allgather_time": 0.6315039932727814, "perseq_attn_time": 0.3596592009067535, "perdoc_allgather_time": 7.128628849983215, "perdoc_attn_time": 1.0094512045383452, "output_shape": [8192, 8, 128]}, "5": {"per_seq_latency": 1.0048111915588378, "per_doc_latency": 8.240601348876954, "perseq_allgather_time": 0.6194383949041367, "perseq_attn_time": 0.3534160017967224, "perdoc_allgather_time": 6.856436777114868, "perdoc_attn_time": 1.2981856048107148, "output_shape": [8192, 8, 128]}, "3": {"per_seq_latency": 1.0043904304504394, "per_doc_latency": 8.243977355957032, "perseq_allgather_time": 0.6392496138811111, "perseq_attn_time": 0.3368239998817444, "perdoc_allgather_time": 6.830020833015442, "perdoc_attn_time": 1.32425919175148, "output_shape": [8192, 8, 128]}, "6": {"per_seq_latency": 1.0049599647521972, "per_doc_latency": 8.211140441894532, "perseq_allgather_time": 0.6402559906244278, "perseq_attn_time": 0.3343567982316017, "perdoc_allgather_time": 6.841796827316284, "perdoc_attn_time": 1.2812911987304687, "output_shape": [8192, 8, 128]}, "4": {"per_seq_latency": 1.0050592422485352, "per_doc_latency": 8.131515502929688, "perseq_allgather_time": 0.6698095917701721, "perseq_attn_time": 0.3159248039126396, "perdoc_allgather_time": 6.765787243843079, "perdoc_attn_time": 1.2885263979434967, "output_shape": [8192, 8, 128]}, "per_seq_latency": 0.03210754990577698, "per_doc_latency": 0.25762429237365725, "per_seq_allgather_latency": 0.020931549742817877, "per_seq_attn_latency": 0.011239350028336047, "per_doc_allgather_latency": 0.22276965156197548, "per_doc_attn_latency": 0.04155905023217201, "num_seq_in_batch": 32, "seq_len": 2048, "num_heads": 64, "head_dim": 128, "cp": 8, "tp": 8, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"7": {"per_seq_latency": 2.819822311401367, "per_doc_latency": 13.594789123535156, "perseq_allgather_time": 0.841811203956604, "perseq_attn_time": 1.971065604686737, "perdoc_allgather_time": 9.26522707939148, "perdoc_attn_time": 4.322731137275696, "output_shape": [8192, 64, 128]}, "0": {"per_seq_latency": 2.624769592285156, "per_doc_latency": 13.594850158691406, "perseq_allgather_time": 0.6407984077930451, "perseq_attn_time": 1.9694559931755067, "perdoc_allgather_time": 9.16712818145752, "perdoc_attn_time": 4.420564770698547, "output_shape": [8192, 64, 128]}, "5": {"per_seq_latency": 2.8209823608398437, "per_doc_latency": 13.597625732421875, "perseq_allgather_time": 0.8358080059289932, "perseq_attn_time": 1.9782383859157562, "perdoc_allgather_time": 9.291676759719849, "perdoc_attn_time": 4.299129629135132, "output_shape": [8192, 64, 128]}, "3": {"per_seq_latency": 2.818516731262207, "per_doc_latency": 13.59717254638672, "perseq_allgather_time": 0.8150928050279618, "perseq_attn_time": 1.9961647927761077, "perdoc_allgather_time": 9.258036804199218, "perdoc_attn_time": 4.331958365440369, "output_shape": [8192, 64, 128]}, "6": {"per_seq_latency": 2.81918888092041, "per_doc_latency": 13.595852661132813, "perseq_allgather_time": 0.8648911863565445, "perseq_attn_time": 1.9475903928279876, "perdoc_allgather_time": 9.261124753952027, "perdoc_attn_time": 4.327913618087768, "output_shape": [8192, 64, 128]}, "2": {"per_seq_latency": 2.8183311462402343, "per_doc_latency": 13.59740753173828, "perseq_allgather_time": 0.7926927894353867, "perseq_attn_time": 2.018364804983139, "perdoc_allgather_time": 9.262329483032227, "perdoc_attn_time": 4.327905607223511, "output_shape": [8192, 64, 128]}, "1": {"per_seq_latency": 2.8208879470825194, "per_doc_latency": 13.595257568359376, "perseq_allgather_time": 0.8558080166578292, "perseq_attn_time": 1.95796799659729, "perdoc_allgather_time": 9.243031978607178, "perdoc_attn_time": 4.345209646224975, "output_shape": [8192, 64, 128]}, "4": {"per_seq_latency": 2.8196592330932617, "per_doc_latency": 13.596891784667969, "perseq_allgather_time": 0.8654000043869019, "perseq_attn_time": 1.94757279753685, "perdoc_allgather_time": 9.277140903472901, "perdoc_attn_time": 4.313041615486145, "output_shape": [8192, 64, 128]}, "per_seq_latency": 0.17631139755249023, "per_doc_latency": 0.8498516082763672, "per_seq_allgather_latency": 0.05408750027418137, "per_seq_attn_latency": 0.12614780031144618, "per_doc_allgather_latency": 0.5807297974824905, "per_doc_attn_latency": 0.2762852981686592, "num_seq_in_batch": 16, "seq_len": 4096, "num_heads": 64, "head_dim": 128, "cp": 8, "tp": 1, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 1.5574224472045899, "per_doc_latency": 7.310774230957032, "perseq_allgather_time": 0.37902719974517823, "perseq_attn_time": 1.1598143935203553, "perdoc_allgather_time": 4.873967981338501, "perdoc_attn_time": 2.4219696283340455, "output_shape": [8192, 32, 128]}, "7": {"per_seq_latency": 1.8018896102905273, "per_doc_latency": 7.313929748535156, "perseq_allgather_time": 0.6315472051501274, "perseq_attn_time": 1.1627295911312103, "perdoc_allgather_time": 5.028468823432922, "perdoc_attn_time": 2.2787087678909304, "output_shape": [8192, 32, 128]}, "5": {"per_seq_latency": 1.8030927658081055, "per_doc_latency": 7.314158630371094, "perseq_allgather_time": 0.631883193552494, "perseq_attn_time": 1.164406406879425, "perdoc_allgather_time": 5.064092779159546, "perdoc_attn_time": 2.2433055877685546, "output_shape": [8192, 32, 128]}, "6": {"per_seq_latency": 1.801046371459961, "per_doc_latency": 7.313587188720703, "perseq_allgather_time": 0.6456543922424316, "perseq_attn_time": 1.148659199476242, "perdoc_allgather_time": 5.061334347724914, "perdoc_attn_time": 2.245574390888214, "output_shape": [8192, 32, 128]}, "1": {"per_seq_latency": 1.8015424728393554, "per_doc_latency": 7.315789031982422, "perseq_allgather_time": 0.6595712006092072, "perseq_attn_time": 1.134790402650833, "perdoc_allgather_time": 4.961616015434265, "perdoc_attn_time": 2.347108805179596, "output_shape": [8192, 32, 128]}, "2": {"per_seq_latency": 1.805476760864258, "per_doc_latency": 7.317192077636719, "perseq_allgather_time": 0.6481263995170593, "perseq_attn_time": 1.1501312017440797, "perdoc_allgather_time": 5.0077552318573, "perdoc_attn_time": 2.302256000041962, "output_shape": [8192, 32, 128]}, "3": {"per_seq_latency": 1.803331184387207, "per_doc_latency": 7.316366577148438, "perseq_allgather_time": 0.6354799851775169, "perseq_attn_time": 1.1607231974601746, "perdoc_allgather_time": 5.044054388999939, "perdoc_attn_time": 2.265223968029022, "output_shape": [8192, 32, 128]}, "4": {"per_seq_latency": 1.8025999069213867, "per_doc_latency": 7.315609741210937, "perseq_allgather_time": 0.6531119927763939, "perseq_attn_time": 1.1426752090454102, "perdoc_allgather_time": 5.056003165245056, "perdoc_attn_time": 2.252782392501831, "output_shape": [8192, 32, 128]}, "per_seq_latency": 0.11284229755401612, "per_doc_latency": 0.4573245048522949, "per_seq_allgather_latency": 0.04122320003807545, "per_seq_attn_latency": 0.07277540042996407, "per_doc_allgather_latency": 0.31650579869747164, "per_doc_attn_latency": 0.15137310177087784, "num_seq_in_batch": 16, "seq_len": 4096, "num_heads": 64, "head_dim": 128, "cp": 8, "tp": 2, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"7": {"per_seq_latency": 1.319491195678711, "per_doc_latency": 6.5988914489746096, "perseq_allgather_time": 0.5839343927800655, "perseq_attn_time": 0.7286368042230607, "perdoc_allgather_time": 5.361463928222657, "perdoc_attn_time": 1.2306304097175598, "output_shape": [8192, 16, 128]}, "0": {"per_seq_latency": 1.030777645111084, "per_doc_latency": 6.657855987548828, "perseq_allgather_time": 0.28114560171961783, "perseq_attn_time": 0.7359648019075393, "perdoc_allgather_time": 5.230276823043823, "perdoc_attn_time": 1.4065311908721925, "output_shape": [8192, 16, 128]}, "4": {"per_seq_latency": 1.3187935829162598, "per_doc_latency": 6.619471740722656, "perseq_allgather_time": 0.5784015983343125, "perseq_attn_time": 0.7335439950227738, "perdoc_allgather_time": 5.304409587383271, "perdoc_attn_time": 1.307504004240036, "output_shape": [8192, 16, 128]}, "6": {"per_seq_latency": 1.3204560279846191, "per_doc_latency": 6.663893127441407, "perseq_allgather_time": 0.5629119887948036, "perseq_attn_time": 0.7505375981330872, "perdoc_allgather_time": 5.363070380687714, "perdoc_attn_time": 1.2940656125545502, "output_shape": [8192, 16, 128]}, "1": {"per_seq_latency": 1.3203840255737305, "per_doc_latency": 6.64306869506836, "perseq_allgather_time": 0.5884608037769794, "perseq_attn_time": 0.7246847927570343, "perdoc_allgather_time": 5.228947246074677, "perdoc_attn_time": 1.407038402557373, "output_shape": [8192, 16, 128]}, "2": {"per_seq_latency": 1.3208352088928224, "per_doc_latency": 6.602339172363282, "perseq_allgather_time": 0.5744943954050541, "perseq_attn_time": 0.7391200006008148, "perdoc_allgather_time": 5.259120047092438, "perdoc_attn_time": 1.336222392320633, "output_shape": [8192, 16, 128]}, "3": {"per_seq_latency": 1.3202095985412599, "per_doc_latency": 6.620990753173828, "perseq_allgather_time": 0.5538144089281559, "perseq_attn_time": 0.7552448004484177, "perdoc_allgather_time": 5.263831961154938, "perdoc_attn_time": 1.3499135971069336, "output_shape": [8192, 16, 128]}, "5": {"per_seq_latency": 1.3211135864257812, "per_doc_latency": 6.513925170898437, "perseq_allgather_time": 0.5776943936944008, "perseq_attn_time": 0.736025607585907, "perdoc_allgather_time": 5.220911979675293, "perdoc_attn_time": 1.275414389371872, "output_shape": [8192, 16, 128]}, "per_seq_latency": 0.08256959915161133, "per_doc_latency": 0.4164933204650879, "per_seq_allgather_latency": 0.03677880023606121, "per_seq_attn_latency": 0.047202800028026105, "per_doc_allgather_latency": 0.3351918987929821, "per_doc_attn_latency": 0.08793990015983581, "num_seq_in_batch": 16, "seq_len": 4096, "num_heads": 64, "head_dim": 128, "cp": 8, "tp": 4, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 0.9339664459228516, "per_doc_latency": 4.835895919799805, "perseq_allgather_time": 0.35532959923148155, "perseq_attn_time": 0.5410975947976112, "perdoc_allgather_time": 3.8133935928344727, "perdoc_attn_time": 0.9979039937257767, "output_shape": [8192, 8, 128]}, "7": {"per_seq_latency": 1.1691184043884277, "per_doc_latency": 4.840480041503906, "perseq_allgather_time": 0.654004792124033, "perseq_attn_time": 0.5081983998417854, "perdoc_allgather_time": 3.928772759437561, "perdoc_attn_time": 0.869420799612999, "output_shape": [8192, 8, 128]}, "5": {"per_seq_latency": 1.1673616409301757, "per_doc_latency": 4.8031982421875, "perseq_allgather_time": 0.6123072095215321, "perseq_attn_time": 0.5436783984303475, "perdoc_allgather_time": 3.940819203853607, "perdoc_attn_time": 0.8468111991882324, "output_shape": [8192, 8, 128]}, "6": {"per_seq_latency": 1.168387222290039, "per_doc_latency": 4.797129440307617, "perseq_allgather_time": 0.6057088047266006, "perseq_attn_time": 0.540324792265892, "perdoc_allgather_time": 3.8772943735122682, "perdoc_attn_time": 0.8919711947441101, "output_shape": [8192, 8, 128]}, "1": {"per_seq_latency": 1.1890144348144531, "per_doc_latency": 4.855392074584961, "perseq_allgather_time": 0.6521135896444321, "perseq_attn_time": 0.5286208003759384, "perdoc_allgather_time": 3.928150403499603, "perdoc_attn_time": 0.9161312043666839, "output_shape": [8192, 8, 128]}, "3": {"per_seq_latency": 1.170569610595703, "per_doc_latency": 4.801374435424805, "perseq_allgather_time": 0.6483743987977505, "perseq_attn_time": 0.5136304035782814, "perdoc_allgather_time": 3.896233630180359, "perdoc_attn_time": 0.8939935982227325, "output_shape": [8192, 8, 128]}, "4": {"per_seq_latency": 1.170257568359375, "per_doc_latency": 4.863905715942383, "perseq_allgather_time": 0.6423584088683129, "perseq_attn_time": 0.5193392008543014, "perdoc_allgather_time": 3.9161359906196593, "perdoc_attn_time": 0.9273119986057281, "output_shape": [8192, 8, 128]}, "2": {"per_seq_latency": 1.170414352416992, "per_doc_latency": 4.867580795288086, "perseq_allgather_time": 0.6266240008175373, "perseq_attn_time": 0.5342207953333855, "perdoc_allgather_time": 3.9431615829467774, "perdoc_attn_time": 0.9100783973932266, "output_shape": [8192, 8, 128]}, "per_seq_latency": 0.07431340217590332, "per_doc_latency": 0.3042237997055054, "per_seq_allgather_latency": 0.04087529950775206, "per_seq_attn_latency": 0.03397989990189672, "per_doc_allgather_latency": 0.2464475989341736, "per_doc_attn_latency": 0.06236899960786104, "num_seq_in_batch": 16, "seq_len": 4096, "num_heads": 64, "head_dim": 128, "cp": 8, "tp": 8, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 4.01685905456543, "per_doc_latency": 14.926747131347657, "perseq_allgather_time": 0.6116911977529526, "perseq_attn_time": 3.3912192225456237, "perdoc_allgather_time": 9.167569589614867, "perdoc_attn_time": 5.7519471645355225, "output_shape": [8192, 64, 128]}, "7": {"per_seq_latency": 4.16889762878418, "per_doc_latency": 14.926521301269531, "perseq_allgather_time": 0.7840303987264633, "perseq_attn_time": 3.3781856298446655, "perdoc_allgather_time": 9.158806371688843, "perdoc_attn_time": 5.761009573936462, "output_shape": [8192, 64, 128]}, "4": {"per_seq_latency": 4.168936157226563, "per_doc_latency": 14.924082946777343, "perseq_allgather_time": 0.7662271976470947, "perseq_attn_time": 3.396025598049164, "perdoc_allgather_time": 9.214135980606079, "perdoc_attn_time": 5.703294396400452, "output_shape": [8192, 64, 128]}, "2": {"per_seq_latency": 4.166633605957031, "per_doc_latency": 14.929620361328125, "perseq_allgather_time": 0.7395231932401657, "perseq_attn_time": 3.4198816061019897, "perdoc_allgather_time": 9.165196704864503, "perdoc_attn_time": 5.757228851318359, "output_shape": [8192, 64, 128]}, "1": {"per_seq_latency": 4.168913650512695, "per_doc_latency": 14.929756164550781, "perseq_allgather_time": 0.7486784070730209, "perseq_attn_time": 3.4131023645401, "perdoc_allgather_time": 9.161838340759278, "perdoc_attn_time": 5.760707211494446, "output_shape": [8192, 64, 128]}, "3": {"per_seq_latency": 4.169803237915039, "per_doc_latency": 14.9226806640625, "perseq_allgather_time": 0.7564528048038482, "perseq_attn_time": 3.4060959815979004, "perdoc_allgather_time": 9.194038438796998, "perdoc_attn_time": 5.721454358100891, "output_shape": [8192, 64, 128]}, "6": {"per_seq_latency": 4.171691131591797, "per_doc_latency": 14.918629455566407, "perseq_allgather_time": 0.7331488013267518, "perseq_attn_time": 3.4317999720573424, "perdoc_allgather_time": 9.14841914176941, "perdoc_attn_time": 5.763440036773682, "output_shape": [8192, 64, 128]}, "5": {"per_seq_latency": 4.170843124389648, "per_doc_latency": 14.92431182861328, "perseq_allgather_time": 0.7754464030265809, "perseq_attn_time": 3.388540804386139, "perdoc_allgather_time": 9.210244846343993, "perdoc_attn_time": 5.7072944164276125, "output_shape": [8192, 64, 128]}, "per_seq_latency": 0.5214613914489746, "per_doc_latency": 1.8662195205688477, "per_seq_allgather_latency": 0.09800379984080791, "per_seq_attn_latency": 0.4289749965071678, "per_doc_allgather_latency": 1.1517669975757598, "per_doc_attn_latency": 0.7204300045967102, "num_seq_in_batch": 8, "seq_len": 8192, "num_heads": 64, "head_dim": 128, "cp": 8, "tp": 1, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 2.3125247955322266, "per_doc_latency": 7.728923034667969, "perseq_allgather_time": 0.3714639976620674, "perseq_attn_time": 1.926903986930847, "perdoc_allgather_time": 4.698462390899659, "perdoc_attn_time": 3.0233360052108766, "output_shape": [8192, 32, 128]}, "7": {"per_seq_latency": 2.5075376510620115, "per_doc_latency": 7.728358459472656, "perseq_allgather_time": 0.5801215976476669, "perseq_attn_time": 1.9206480026245116, "perdoc_allgather_time": 4.726310396194458, "perdoc_attn_time": 2.995289611816406, "output_shape": [8192, 32, 128]}, "3": {"per_seq_latency": 2.503492736816406, "per_doc_latency": 7.727648162841797, "perseq_allgather_time": 0.5666543960571289, "perseq_attn_time": 1.9295471847057342, "perdoc_allgather_time": 4.708094334602356, "perdoc_attn_time": 3.0123775959014893, "output_shape": [8192, 32, 128]}, "4": {"per_seq_latency": 2.5033039093017577, "per_doc_latency": 7.7262451171875, "perseq_allgather_time": 0.5991727963089943, "perseq_attn_time": 1.8972671985626222, "perdoc_allgather_time": 4.766625642776489, "perdoc_attn_time": 2.9529775738716126, "output_shape": [8192, 32, 128]}, "5": {"per_seq_latency": 2.504417610168457, "per_doc_latency": 7.728702545166016, "perseq_allgather_time": 0.5674095943570137, "perseq_attn_time": 1.9301231980323792, "perdoc_allgather_time": 4.757278347015381, "perdoc_attn_time": 2.9645391941070556, "output_shape": [8192, 32, 128]}, "6": {"per_seq_latency": 2.5030399322509767, "per_doc_latency": 7.729646301269531, "perseq_allgather_time": 0.5799663931131362, "perseq_attn_time": 1.916312003135681, "perdoc_allgather_time": 4.726719999313355, "perdoc_attn_time": 2.996073603630066, "output_shape": [8192, 32, 128]}, "1": {"per_seq_latency": 2.503518486022949, "per_doc_latency": 7.72778091430664, "perseq_allgather_time": 0.5998464077711105, "perseq_attn_time": 1.8966415882110597, "perdoc_allgather_time": 4.726128053665161, "perdoc_attn_time": 2.9946159720420837, "output_shape": [8192, 32, 128]}, "2": {"per_seq_latency": 2.503411293029785, "per_doc_latency": 7.7284400939941404, "perseq_allgather_time": 0.5929599925875664, "perseq_attn_time": 1.9032592117786407, "perdoc_allgather_time": 4.725921583175659, "perdoc_attn_time": 2.995305573940277, "output_shape": [8192, 32, 128]}, "per_seq_latency": 0.31344220638275144, "per_doc_latency": 0.9662057876586914, "per_seq_allgather_latency": 0.07498080097138882, "per_seq_attn_latency": 0.2412653997540474, "per_doc_allgather_latency": 0.5958282053470612, "per_doc_attn_latency": 0.3779170006513596, "num_seq_in_batch": 8, "seq_len": 8192, "num_heads": 64, "head_dim": 128, "cp": 8, "tp": 2, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 1.440060806274414, "per_doc_latency": 4.30963363647461, "perseq_allgather_time": 0.26734239757061007, "perseq_attn_time": 1.157828801870346, "perdoc_allgather_time": 2.6289680123329164, "perdoc_attn_time": 1.6651888072490693, "output_shape": [8192, 16, 128]}, "7": {"per_seq_latency": 1.6656303405761719, "per_doc_latency": 4.3191486358642575, "perseq_allgather_time": 0.5180991925299168, "perseq_attn_time": 1.140809601545334, "perdoc_allgather_time": 2.7058815956115723, "perdoc_attn_time": 1.6065599918365479, "output_shape": [8192, 16, 128]}, "1": {"per_seq_latency": 1.6762704849243164, "per_doc_latency": 4.318286514282226, "perseq_allgather_time": 0.5072031952440739, "perseq_attn_time": 1.160257601737976, "perdoc_allgather_time": 2.706232023239136, "perdoc_attn_time": 1.6049808084964752, "output_shape": [8192, 16, 128]}, "2": {"per_seq_latency": 1.6766063690185546, "per_doc_latency": 4.318328094482422, "perseq_allgather_time": 0.5288400009274483, "perseq_attn_time": 1.140590387582779, "perdoc_allgather_time": 2.725704002380371, "perdoc_attn_time": 1.5854607939720153, "output_shape": [8192, 16, 128]}, "3": {"per_seq_latency": 1.6829120635986328, "per_doc_latency": 4.318726348876953, "perseq_allgather_time": 0.5204544052481651, "perseq_attn_time": 1.1538128077983856, "perdoc_allgather_time": 2.7109391927719115, "perdoc_attn_time": 1.6005407929420472, "output_shape": [8192, 16, 128]}, "6": {"per_seq_latency": 1.6786432266235352, "per_doc_latency": 4.3182624816894535, "perseq_allgather_time": 0.5185503929853439, "perseq_attn_time": 1.1531984090805054, "perdoc_allgather_time": 2.671769607067108, "perdoc_attn_time": 1.6397231996059418, "output_shape": [8192, 16, 128]}, "4": {"per_seq_latency": 1.6784095764160156, "per_doc_latency": 4.317790222167969, "perseq_allgather_time": 0.5398288130760193, "perseq_attn_time": 1.1318431973457337, "perdoc_allgather_time": 2.7201104044914244, "perdoc_attn_time": 1.5909488022327423, "output_shape": [8192, 16, 128]}, "5": {"per_seq_latency": 1.6809743881225585, "per_doc_latency": 4.318929672241211, "perseq_allgather_time": 0.5165936015546322, "perseq_attn_time": 1.1565648019313812, "perdoc_allgather_time": 2.7146767735481263, "perdoc_attn_time": 1.597404807806015, "output_shape": [8192, 16, 128]}, "per_seq_latency": 0.2103640079498291, "per_doc_latency": 0.5398935794830322, "per_seq_allgather_latency": 0.06747860163450241, "per_seq_attn_latency": 0.145032200217247, "per_doc_allgather_latency": 0.34071300029754636, "per_doc_attn_latency": 0.20814860090613366, "num_seq_in_batch": 8, "seq_len": 8192, "num_heads": 64, "head_dim": 128, "cp": 8, "tp": 4, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"7": {"per_seq_latency": 1.4491392135620118, "per_doc_latency": 3.3089950561523436, "perseq_allgather_time": 0.6756607994437218, "perseq_attn_time": 0.7236512005329132, "perdoc_allgather_time": 2.3849407911300657, "perdoc_attn_time": 0.9046288013458252, "output_shape": [8192, 8, 128]}, "0": {"per_seq_latency": 1.2190688133239747, "per_doc_latency": 3.2442222595214845, "perseq_allgather_time": 0.47909439727663994, "perseq_attn_time": 0.7165360003709793, "perdoc_allgather_time": 2.253152000904083, "perdoc_attn_time": 0.969564801454544, "output_shape": [8192, 8, 128]}, "2": {"per_seq_latency": 1.4473376274108887, "per_doc_latency": 3.264556884765625, "perseq_allgather_time": 0.7420768134295941, "perseq_attn_time": 0.6971583992242814, "perdoc_allgather_time": 2.333201563358307, "perdoc_attn_time": 0.9241375923156738, "output_shape": [8192, 8, 128]}, "3": {"per_seq_latency": 1.4483152389526368, "per_doc_latency": 3.259552001953125, "perseq_allgather_time": 0.6658111974596977, "perseq_attn_time": 0.7509824007749557, "perdoc_allgather_time": 2.351873588562012, "perdoc_attn_time": 0.9006256014108658, "output_shape": [8192, 8, 128]}, "5": {"per_seq_latency": 1.4576944351196288, "per_doc_latency": 3.2503120422363283, "perseq_allgather_time": 0.7006575912237167, "perseq_attn_time": 0.7366496026515961, "perdoc_allgather_time": 2.3451583981513977, "perdoc_attn_time": 0.8969184041023255, "output_shape": [8192, 8, 128]}, "1": {"per_seq_latency": 1.4472720146179199, "per_doc_latency": 3.229564666748047, "perseq_allgather_time": 0.700704000890255, "perseq_attn_time": 0.7300368010997772, "perdoc_allgather_time": 2.2853936076164247, "perdoc_attn_time": 0.9370655983686447, "output_shape": [8192, 8, 128]}, "4": {"per_seq_latency": 1.4468704223632813, "per_doc_latency": 3.2745838165283203, "perseq_allgather_time": 0.7522592127323151, "perseq_attn_time": 0.6878576010465622, "perdoc_allgather_time": 2.396062397956848, "perdoc_attn_time": 0.8717328011989594, "output_shape": [8192, 8, 128]}, "6": {"per_seq_latency": 1.4490320205688476, "per_doc_latency": 3.225724792480469, "perseq_allgather_time": 0.7394495896995068, "perseq_attn_time": 0.7019327998161315, "perdoc_allgather_time": 2.303623986244202, "perdoc_attn_time": 0.9017328023910522, "output_shape": [8192, 8, 128]}, "per_seq_latency": 0.1822118043899536, "per_doc_latency": 0.41362438201904295, "per_seq_allgather_latency": 0.09403240159153939, "per_seq_attn_latency": 0.09387280009686946, "per_doc_allgather_latency": 0.299507799744606, "per_doc_attn_latency": 0.121195600181818, "num_seq_in_batch": 8, "seq_len": 8192, "num_heads": 64, "head_dim": 128, "cp": 8, "tp": 8, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 7.067683410644531, "per_doc_latency": 17.85626983642578, "perseq_allgather_time": 0.7040256023406982, "perseq_attn_time": 6.356619167327881, "perdoc_allgather_time": 9.25270414352417, "perdoc_attn_time": 8.596571207046509, "output_shape": [8192, 64, 128]}, "7": {"per_seq_latency": 7.068856048583984, "per_doc_latency": 17.859909057617188, "perseq_allgather_time": 0.6612287998199463, "perseq_attn_time": 6.400796842575073, "perdoc_allgather_time": 9.21475510597229, "perdoc_attn_time": 8.638303995132446, "output_shape": [8192, 64, 128]}, "6": {"per_seq_latency": 7.074073791503906, "per_doc_latency": 17.847067260742186, "perseq_allgather_time": 0.7374336004257203, "perseq_attn_time": 6.329756784439087, "perdoc_allgather_time": 9.176823997497559, "perdoc_attn_time": 8.663425493240357, "output_shape": [8192, 64, 128]}, "4": {"per_seq_latency": 7.080248260498047, "per_doc_latency": 17.86248321533203, "perseq_allgather_time": 0.7151904016733169, "perseq_attn_time": 6.3583872556686405, "perdoc_allgather_time": 9.260342407226563, "perdoc_attn_time": 8.59537444114685, "output_shape": [8192, 64, 128]}, "3": {"per_seq_latency": 7.06982421875, "per_doc_latency": 17.865248107910155, "perseq_allgather_time": 0.7137295931577683, "perseq_attn_time": 6.348886442184448, "perdoc_allgather_time": 9.269460725784302, "perdoc_attn_time": 8.588647985458374, "output_shape": [8192, 64, 128]}, "5": {"per_seq_latency": 7.066150665283203, "per_doc_latency": 17.858155822753908, "perseq_allgather_time": 0.7145392000675201, "perseq_attn_time": 6.344747114181518, "perdoc_allgather_time": 9.26941113471985, "perdoc_attn_time": 8.581903982162476, "output_shape": [8192, 64, 128]}, "1": {"per_seq_latency": 7.0821388244628904, "per_doc_latency": 17.849153137207033, "perseq_allgather_time": 0.6751456052064896, "perseq_attn_time": 6.399964785575866, "perdoc_allgather_time": 9.136065578460693, "perdoc_attn_time": 8.706025648117066, "output_shape": [8192, 64, 128]}, "2": {"per_seq_latency": 7.071485137939453, "per_doc_latency": 17.85869903564453, "perseq_allgather_time": 0.6544800043106079, "perseq_attn_time": 6.409718370437622, "perdoc_allgather_time": 9.248408079147339, "perdoc_attn_time": 8.603139162063599, "output_shape": [8192, 64, 128]}, "per_seq_latency": 1.7705347061157226, "per_doc_latency": 4.466312026977539, "per_seq_allgather_latency": 0.18435840010643006, "per_seq_attn_latency": 1.6024295926094054, "per_doc_allgather_latency": 2.3173651814460756, "per_doc_attn_latency": 2.1765064120292665, "num_seq_in_batch": 4, "seq_len": 16384, "num_heads": 64, "head_dim": 128, "cp": 8, "tp": 1, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"7": {"per_seq_latency": 3.9189342498779296, "per_doc_latency": 9.151882934570313, "perseq_allgather_time": 0.5423119977116585, "perseq_attn_time": 3.3697871923446656, "perdoc_allgather_time": 4.672371220588684, "perdoc_attn_time": 4.472755217552185, "output_shape": [8192, 32, 128]}, "0": {"per_seq_latency": 3.808729553222656, "per_doc_latency": 9.149671936035157, "perseq_allgather_time": 0.4319120019674301, "perseq_attn_time": 3.365174412727356, "perdoc_allgather_time": 4.723697590827942, "perdoc_attn_time": 4.419008016586304, "output_shape": [8192, 32, 128]}, "1": {"per_seq_latency": 3.9171871185302733, "per_doc_latency": 9.151598358154297, "perseq_allgather_time": 0.5031343981623649, "perseq_attn_time": 3.4069199919700623, "perdoc_allgather_time": 4.733457565307617, "perdoc_attn_time": 4.411107182502747, "output_shape": [8192, 32, 128]}, "2": {"per_seq_latency": 3.917622375488281, "per_doc_latency": 9.149948883056641, "perseq_allgather_time": 0.507108798623085, "perseq_attn_time": 3.403313624858856, "perdoc_allgather_time": 4.663899183273315, "perdoc_attn_time": 4.47882559299469, "output_shape": [8192, 32, 128]}, "6": {"per_seq_latency": 3.9166831970214844, "per_doc_latency": 9.151643371582031, "perseq_allgather_time": 0.5104399979114532, "perseq_attn_time": 3.399515211582184, "perdoc_allgather_time": 4.679225564002991, "perdoc_attn_time": 4.46562077999115, "output_shape": [8192, 32, 128]}, "4": {"per_seq_latency": 3.919403076171875, "per_doc_latency": 9.153018951416016, "perseq_allgather_time": 0.5254960000514984, "perseq_attn_time": 3.38709762096405, "perdoc_allgather_time": 4.697107219696045, "perdoc_attn_time": 4.449142408370972, "output_shape": [8192, 32, 128]}, "3": {"per_seq_latency": 3.9198848724365236, "per_doc_latency": 9.155449676513673, "perseq_allgather_time": 0.5781759962439537, "perseq_attn_time": 3.334536004066467, "perdoc_allgather_time": 4.703974366188049, "perdoc_attn_time": 4.444375967979431, "output_shape": [8192, 32, 128]}, "5": {"per_seq_latency": 3.9146575927734375, "per_doc_latency": 9.153164672851563, "perseq_allgather_time": 0.472852797806263, "perseq_attn_time": 3.434984016418457, "perdoc_allgather_time": 4.705175995826721, "perdoc_attn_time": 4.44125759601593, "output_shape": [8192, 32, 128]}, "per_seq_latency": 0.9799712181091309, "per_doc_latency": 2.288862419128418, "per_seq_allgather_latency": 0.14454399906098842, "per_seq_attn_latency": 0.8587460041046142, "per_doc_allgather_latency": 1.1833643913269043, "per_doc_attn_latency": 1.1197063982486726, "num_seq_in_batch": 4, "seq_len": 16384, "num_heads": 64, "head_dim": 128, "cp": 8, "tp": 2, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 2.195404815673828, "per_doc_latency": 4.832273483276367, "perseq_allgather_time": 0.3197039969265461, "perseq_attn_time": 1.8643120110034943, "perdoc_allgather_time": 2.4802224040031433, "perdoc_attn_time": 2.3449664235115053, "output_shape": [8192, 16, 128]}, "7": {"per_seq_latency": 2.365230369567871, "per_doc_latency": 4.832783889770508, "perseq_allgather_time": 0.48657919839024544, "perseq_attn_time": 1.8719792008399962, "perdoc_allgather_time": 2.471492826938629, "perdoc_attn_time": 2.354571211338043, "output_shape": [8192, 16, 128]}, "3": {"per_seq_latency": 2.3650287628173827, "per_doc_latency": 4.833692932128907, "perseq_allgather_time": 0.48683679550886155, "perseq_attn_time": 1.8709984004497529, "perdoc_allgather_time": 2.4689919710159303, "perdoc_attn_time": 2.3573808073997498, "output_shape": [8192, 16, 128]}, "2": {"per_seq_latency": 2.3661855697631835, "per_doc_latency": 4.798551940917969, "perseq_allgather_time": 0.4268895976245403, "perseq_attn_time": 1.9318752050399781, "perdoc_allgather_time": 2.4757376074790955, "perdoc_attn_time": 2.3155888319015503, "output_shape": [8192, 16, 128]}, "6": {"per_seq_latency": 2.365657615661621, "per_doc_latency": 4.8418113708496096, "perseq_allgather_time": 0.4154752016067505, "perseq_attn_time": 1.9201135993003846, "perdoc_allgather_time": 2.5112752079963685, "perdoc_attn_time": 2.323867213726044, "output_shape": [8192, 16, 128]}, "1": {"per_seq_latency": 2.369935989379883, "per_doc_latency": 4.833953475952148, "perseq_allgather_time": 0.44248799830675123, "perseq_attn_time": 1.9201872050762177, "perdoc_allgather_time": 2.4891968250274656, "perdoc_attn_time": 2.3375360012054442, "output_shape": [8192, 16, 128]}, "5": {"per_seq_latency": 2.3646015167236327, "per_doc_latency": 4.834280014038086, "perseq_allgather_time": 0.441702401638031, "perseq_attn_time": 1.9161695957183837, "perdoc_allgather_time": 2.480673599243164, "perdoc_attn_time": 2.3469759941101076, "output_shape": [8192, 16, 128]}, "4": {"per_seq_latency": 2.3660959243774413, "per_doc_latency": 4.832966232299805, "perseq_allgather_time": 0.49987840577960013, "perseq_attn_time": 1.859420794248581, "perdoc_allgather_time": 2.51146559715271, "perdoc_attn_time": 2.314750385284424, "output_shape": [8192, 16, 128]}, "per_seq_latency": 0.5924839973449707, "per_doc_latency": 1.2104528427124024, "per_seq_allgather_latency": 0.12496960144490003, "per_seq_attn_latency": 0.48296880125999453, "per_doc_allgather_latency": 0.6278663992881774, "per_doc_attn_latency": 0.5893452018499374, "num_seq_in_batch": 4, "seq_len": 16384, "num_heads": 64, "head_dim": 128, "cp": 8, "tp": 4, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 1.4001824378967285, "per_doc_latency": 2.736612892150879, "perseq_allgather_time": 0.32347839921712873, "perseq_attn_time": 1.0621823966503143, "perdoc_allgather_time": 1.452644795179367, "perdoc_attn_time": 1.2716895818710328, "output_shape": [8192, 8, 128]}, "7": {"per_seq_latency": 1.6314640045166016, "per_doc_latency": 2.7642608642578126, "perseq_allgather_time": 0.5322368010878563, "perseq_attn_time": 1.0899376034736634, "perdoc_allgather_time": 1.44685440659523, "perdoc_attn_time": 1.3105023980140686, "output_shape": [8192, 8, 128]}, "4": {"per_seq_latency": 1.6304784774780274, "per_doc_latency": 2.773793601989746, "perseq_allgather_time": 0.5619407959282399, "perseq_attn_time": 1.0617055952548982, "perdoc_allgather_time": 1.5128608107566834, "perdoc_attn_time": 1.2541728019714355, "output_shape": [8192, 8, 128]}, "1": {"per_seq_latency": 1.6316703796386718, "per_doc_latency": 2.762745666503906, "perseq_allgather_time": 0.5614959977567195, "perseq_attn_time": 1.0632160127162933, "perdoc_allgather_time": 1.519622415304184, "perdoc_attn_time": 1.236167997121811, "output_shape": [8192, 8, 128]}, "3": {"per_seq_latency": 1.6341472625732423, "per_doc_latency": 2.759611129760742, "perseq_allgather_time": 0.499904003739357, "perseq_attn_time": 1.1184240102767944, "perdoc_allgather_time": 1.509387195110321, "perdoc_attn_time": 1.2429648041725159, "output_shape": [8192, 8, 128]}, "2": {"per_seq_latency": 1.630241584777832, "per_doc_latency": 2.7619375228881835, "perseq_allgather_time": 0.5555296130478382, "perseq_attn_time": 1.0669920086860656, "perdoc_allgather_time": 1.5138767957687378, "perdoc_attn_time": 1.240839993953705, "output_shape": [8192, 8, 128]}, "5": {"per_seq_latency": 1.6305984497070312, "per_doc_latency": 2.75296630859375, "perseq_allgather_time": 0.5652607932686806, "perseq_attn_time": 1.0584479928016663, "perdoc_allgather_time": 1.502897596359253, "perdoc_attn_time": 1.2433264017105103, "output_shape": [8192, 8, 128]}, "6": {"per_seq_latency": 1.630633544921875, "per_doc_latency": 2.793662452697754, "perseq_allgather_time": 0.5470912091434001, "perseq_attn_time": 1.0768127977848052, "perdoc_allgather_time": 1.5055216014385224, "perdoc_attn_time": 1.280268794298172, "output_shape": [8192, 8, 128]}, "per_seq_latency": 0.40853681564331057, "per_doc_latency": 0.6984156131744385, "per_seq_allgather_latency": 0.14131519831717015, "per_seq_attn_latency": 0.2796060025691986, "per_doc_allgather_latency": 0.379905603826046, "per_doc_attn_latency": 0.32762559950351716, "num_seq_in_batch": 4, "seq_len": 16384, "num_heads": 64, "head_dim": 128, "cp": 8, "tp": 8, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 12.933647155761719, "per_doc_latency": 23.772088623046876, "perseq_allgather_time": 0.8278000086545945, "perseq_attn_time": 12.098596715927124, "perdoc_allgather_time": 9.310094356536865, "perdoc_attn_time": 14.45481448173523, "output_shape": [8192, 64, 128]}, "7": {"per_seq_latency": 12.941770935058594, "per_doc_latency": 23.7680908203125, "perseq_allgather_time": 0.698755195736885, "perseq_attn_time": 12.236387252807617, "perdoc_allgather_time": 9.219332933425903, "perdoc_attn_time": 14.541976118087769, "output_shape": [8192, 64, 128]}, "4": {"per_seq_latency": 12.939820861816406, "per_doc_latency": 23.79564666748047, "perseq_allgather_time": 0.6176080048084259, "perseq_attn_time": 12.31543517112732, "perdoc_allgather_time": 9.331825542449952, "perdoc_attn_time": 14.456959962844849, "output_shape": [8192, 64, 128]}, "6": {"per_seq_latency": 12.954736328125, "per_doc_latency": 23.761260986328125, "perseq_allgather_time": 0.8889919966459274, "perseq_attn_time": 12.059057569503784, "perdoc_allgather_time": 9.317084884643554, "perdoc_attn_time": 14.437326383590698, "output_shape": [8192, 64, 128]}, "3": {"per_seq_latency": 12.949862670898437, "per_doc_latency": 23.770651245117186, "perseq_allgather_time": 0.8558335989713669, "perseq_attn_time": 12.086883163452148, "perdoc_allgather_time": 9.335438442230224, "perdoc_attn_time": 14.428088045120239, "output_shape": [8192, 64, 128]}, "5": {"per_seq_latency": 12.939566040039063, "per_doc_latency": 23.771322631835936, "perseq_allgather_time": 0.899617600440979, "perseq_attn_time": 12.03307523727417, "perdoc_allgather_time": 9.493604755401611, "perdoc_attn_time": 14.27079348564148, "output_shape": [8192, 64, 128]}, "1": {"per_seq_latency": 12.964892578125, "per_doc_latency": 23.751556396484375, "perseq_allgather_time": 0.8124352037906647, "perseq_attn_time": 12.145459175109863, "perdoc_allgather_time": 9.23852801322937, "perdoc_attn_time": 14.50604157447815, "output_shape": [8192, 64, 128]}, "2": {"per_seq_latency": 12.94361572265625, "per_doc_latency": 23.757472229003906, "perseq_allgather_time": 0.7011312007904053, "perseq_attn_time": 12.235185670852662, "perdoc_allgather_time": 9.26774878501892, "perdoc_attn_time": 14.48256320953369, "output_shape": [8192, 64, 128]}, "per_seq_latency": 6.4824462890625, "per_doc_latency": 11.897823333740234, "per_seq_allgather_latency": 0.4498088002204895, "per_seq_attn_latency": 6.15771758556366, "per_doc_allgather_latency": 4.7468023777008055, "per_doc_attn_latency": 7.2709880590438845, "num_seq_in_batch": 2, "seq_len": 32768, "num_heads": 64, "head_dim": 128, "cp": 8, "tp": 1, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 6.818428802490234, "per_doc_latency": 12.183502197265625, "perseq_allgather_time": 0.5369200065732003, "perseq_attn_time": 6.269630408287048, "perdoc_allgather_time": 4.84760479927063, "perdoc_attn_time": 7.3287663698196415, "output_shape": [8192, 32, 128]}, "7": {"per_seq_latency": 6.841646575927735, "per_doc_latency": 12.188329315185547, "perseq_allgather_time": 0.5715999960899353, "perseq_attn_time": 6.263387155532837, "perdoc_allgather_time": 4.699023962020874, "perdoc_attn_time": 7.482532811164856, "output_shape": [8192, 32, 128]}, "5": {"per_seq_latency": 6.83068618774414, "per_doc_latency": 12.179039764404298, "perseq_allgather_time": 0.5370480045676231, "perseq_attn_time": 6.286948823928833, "perdoc_allgather_time": 4.78124475479126, "perdoc_attn_time": 7.39113597869873, "output_shape": [8192, 32, 128]}, "3": {"per_seq_latency": 6.823790740966797, "per_doc_latency": 12.182113647460938, "perseq_allgather_time": 0.5078383967280388, "perseq_attn_time": 6.308799982070923, "perdoc_allgather_time": 4.7313679456710815, "perdoc_attn_time": 7.443563222885132, "output_shape": [8192, 32, 128]}, "1": {"per_seq_latency": 6.830579376220703, "per_doc_latency": 12.18243179321289, "perseq_allgather_time": 0.46343519538640976, "perseq_attn_time": 6.36003839969635, "perdoc_allgather_time": 4.690699243545533, "perdoc_attn_time": 7.48460156917572, "output_shape": [8192, 32, 128]}, "4": {"per_seq_latency": 6.833064270019531, "per_doc_latency": 12.172627258300782, "perseq_allgather_time": 0.4827568009495735, "perseq_attn_time": 6.34346878528595, "perdoc_allgather_time": 4.6988015413284305, "perdoc_attn_time": 7.466982436180115, "output_shape": [8192, 32, 128]}, "6": {"per_seq_latency": 6.828151702880859, "per_doc_latency": 12.182943725585938, "perseq_allgather_time": 0.4916687965393066, "perseq_attn_time": 6.329676818847656, "perdoc_allgather_time": 4.7159007549285885, "perdoc_attn_time": 7.460243201255798, "output_shape": [8192, 32, 128]}, "2": {"per_seq_latency": 6.827059173583985, "per_doc_latency": 12.181270599365234, "perseq_allgather_time": 0.37859519869089125, "perseq_attn_time": 6.441215991973877, "perdoc_allgather_time": 4.762287998199463, "perdoc_attn_time": 7.411879992485046, "output_shape": [8192, 32, 128]}, "per_seq_latency": 3.4208232879638674, "per_doc_latency": 6.094164657592773, "per_seq_allgather_latency": 0.28579999804496764, "per_seq_attn_latency": 3.2206079959869385, "per_doc_allgather_latency": 2.423802399635315, "per_doc_attn_latency": 3.74230078458786, "num_seq_in_batch": 2, "seq_len": 32768, "num_heads": 64, "head_dim": 128, "cp": 8, "tp": 2, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 3.6258270263671877, "per_doc_latency": 6.316304016113281, "perseq_allgather_time": 0.32201119884848595, "perseq_attn_time": 3.29124801158905, "perdoc_allgather_time": 2.4473088145256043, "perdoc_attn_time": 3.862004780769348, "output_shape": [8192, 16, 128]}, "7": {"per_seq_latency": 3.7316814422607423, "per_doc_latency": 6.3166961669921875, "perseq_allgather_time": 0.43150399550795554, "perseq_attn_time": 3.293248009681702, "perdoc_allgather_time": 2.4332096099853517, "perdoc_attn_time": 3.8766607999801637, "output_shape": [8192, 16, 128]}, "6": {"per_seq_latency": 3.73230094909668, "per_doc_latency": 6.323128128051758, "perseq_allgather_time": 0.3249104075133801, "perseq_attn_time": 3.40064799785614, "perdoc_allgather_time": 2.451759994029999, "perdoc_attn_time": 3.8646944403648376, "output_shape": [8192, 16, 128]}, "4": {"per_seq_latency": 3.7264209747314454, "per_doc_latency": 6.32918701171875, "perseq_allgather_time": 0.4005024045705795, "perseq_attn_time": 3.319112014770508, "perdoc_allgather_time": 2.489846408367157, "perdoc_attn_time": 3.832641613483429, "output_shape": [8192, 16, 128]}, "5": {"per_seq_latency": 3.7286094665527343, "per_doc_latency": 6.328657531738282, "perseq_allgather_time": 0.3508127950131893, "perseq_attn_time": 3.3709216117858887, "perdoc_allgather_time": 2.4692736148834227, "perdoc_attn_time": 3.852631986141205, "output_shape": [8192, 16, 128]}, "1": {"per_seq_latency": 3.7312145233154297, "per_doc_latency": 6.325382232666016, "perseq_allgather_time": 0.3761359915137291, "perseq_attn_time": 3.3479328036308287, "perdoc_allgather_time": 2.503596782684326, "perdoc_attn_time": 3.8146511912345886, "output_shape": [8192, 16, 128]}, "3": {"per_seq_latency": 3.7243473052978517, "per_doc_latency": 6.322326278686523, "perseq_allgather_time": 0.4074768029153347, "perseq_attn_time": 3.3096927762031556, "perdoc_allgather_time": 2.465115225315094, "perdoc_attn_time": 3.850220775604248, "output_shape": [8192, 16, 128]}, "2": {"per_seq_latency": 3.72532958984375, "per_doc_latency": 6.322739028930664, "perseq_allgather_time": 0.34312479496002196, "perseq_attn_time": 3.3751183986663817, "perdoc_allgather_time": 2.4327903985977173, "perdoc_attn_time": 3.8827247977256776, "output_shape": [8192, 16, 128]}, "per_seq_latency": 1.86615047454834, "per_doc_latency": 3.164593505859375, "per_seq_allgather_latency": 0.21575199775397777, "per_seq_attn_latency": 1.70032399892807, "per_doc_allgather_latency": 1.251798391342163, "per_doc_attn_latency": 1.9413623988628388, "num_seq_in_batch": 2, "seq_len": 32768, "num_heads": 64, "head_dim": 128, "cp": 8, "tp": 4, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 2.1311792373657226, "per_doc_latency": 3.400172805786133, "perseq_allgather_time": 0.3352912001311779, "perseq_attn_time": 1.783375996351242, "perdoc_allgather_time": 1.3531728029251098, "perdoc_attn_time": 2.039859175682068, "output_shape": [8192, 8, 128]}, "7": {"per_seq_latency": 2.3423248291015626, "per_doc_latency": 3.3989471435546874, "perseq_allgather_time": 0.5039631970226764, "perseq_attn_time": 1.8237312138080597, "perdoc_allgather_time": 1.346919995546341, "perdoc_attn_time": 2.0449407935142516, "output_shape": [8192, 8, 128]}, "6": {"per_seq_latency": 2.340171241760254, "per_doc_latency": 3.397016143798828, "perseq_allgather_time": 0.518732787668705, "perseq_attn_time": 1.8137920022010803, "perdoc_allgather_time": 1.3812559902668, "perdoc_attn_time": 2.0090928077697754, "output_shape": [8192, 8, 128]}, "3": {"per_seq_latency": 2.3403039932250977, "per_doc_latency": 3.3960670471191405, "perseq_allgather_time": 0.5266207925975323, "perseq_attn_time": 1.8064895927906037, "perdoc_allgather_time": 1.347736006975174, "perdoc_attn_time": 2.04105281829834, "output_shape": [8192, 8, 128]}, "1": {"per_seq_latency": 2.3401391983032225, "per_doc_latency": 3.3976593017578125, "perseq_allgather_time": 0.5521823942661286, "perseq_attn_time": 1.780816000699997, "perdoc_allgather_time": 1.3683743894100189, "perdoc_attn_time": 2.022216039896011, "output_shape": [8192, 8, 128]}, "2": {"per_seq_latency": 2.340433692932129, "per_doc_latency": 3.398371124267578, "perseq_allgather_time": 0.5249775871634483, "perseq_attn_time": 1.8080927968025207, "perdoc_allgather_time": 1.326775997877121, "perdoc_attn_time": 2.0642239689826964, "output_shape": [8192, 8, 128]}, "5": {"per_seq_latency": 2.3400096893310547, "per_doc_latency": 3.3963039398193358, "perseq_allgather_time": 0.5395440079271794, "perseq_attn_time": 1.7935823857784272, "perdoc_allgather_time": 1.356388795375824, "perdoc_attn_time": 2.0332095861434936, "output_shape": [8192, 8, 128]}, "4": {"per_seq_latency": 2.3403968811035156, "per_doc_latency": 3.397073745727539, "perseq_allgather_time": 0.5260911926627159, "perseq_attn_time": 1.8065375983715057, "perdoc_allgather_time": 1.3724944114685058, "perdoc_attn_time": 2.0177743911743162, "output_shape": [8192, 8, 128]}, "per_seq_latency": 1.1711624145507813, "per_doc_latency": 1.7000864028930665, "per_seq_allgather_latency": 0.2760911971330643, "per_seq_attn_latency": 0.9118656069040298, "per_doc_allgather_latency": 0.6906279951334, "per_doc_attn_latency": 1.0321119844913482, "num_seq_in_batch": 2, "seq_len": 32768, "num_heads": 64, "head_dim": 128, "cp": 8, "tp": 8, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"7": {"per_seq_latency": 25.065153503417967, "per_doc_latency": 35.723367309570314, "perseq_allgather_time": 0.780080008506775, "perseq_attn_time": 24.278179454803468, "perdoc_allgather_time": 9.917969512939454, "perdoc_attn_time": 25.798670482635497, "output_shape": [8192, 64, 128]}, "0": {"per_seq_latency": 25.024256896972656, "per_doc_latency": 35.84630126953125, "perseq_allgather_time": 0.917808011174202, "perseq_attn_time": 24.09935369491577, "perdoc_allgather_time": 10.292137622833252, "perdoc_attn_time": 25.54702091217041, "output_shape": [8192, 64, 128]}, "6": {"per_seq_latency": 25.052224731445314, "per_doc_latency": 35.657894897460935, "perseq_allgather_time": 1.044100794196129, "perseq_attn_time": 24.001380825042723, "perdoc_allgather_time": 10.237012767791748, "perdoc_attn_time": 25.414174175262453, "output_shape": [8192, 64, 128]}, "4": {"per_seq_latency": 25.072547912597656, "per_doc_latency": 35.8354248046875, "perseq_allgather_time": 0.9046047985553741, "perseq_attn_time": 24.161200046539307, "perdoc_allgather_time": 10.047876834869385, "perdoc_attn_time": 25.780732917785645, "output_shape": [8192, 64, 128]}, "5": {"per_seq_latency": 25.033229064941406, "per_doc_latency": 35.77048034667969, "perseq_allgather_time": 1.1590800046920777, "perseq_attn_time": 23.867475318908692, "perdoc_allgather_time": 10.278660869598388, "perdoc_attn_time": 25.485089778900146, "output_shape": [8192, 64, 128]}, "1": {"per_seq_latency": 25.02654113769531, "per_doc_latency": 35.693624877929686, "perseq_allgather_time": 0.6748768031597138, "perseq_attn_time": 24.34464807510376, "perdoc_allgather_time": 9.835734367370605, "perdoc_attn_time": 25.85092191696167, "output_shape": [8192, 64, 128]}, "2": {"per_seq_latency": 25.04223175048828, "per_doc_latency": 35.758444213867186, "perseq_allgather_time": 0.8847792029380799, "perseq_attn_time": 24.15030403137207, "perdoc_allgather_time": 9.975681591033936, "perdoc_attn_time": 25.77554569244385, "output_shape": [8192, 64, 128]}, "3": {"per_seq_latency": 25.047544860839842, "per_doc_latency": 35.70594177246094, "perseq_allgather_time": 1.0860143929719925, "perseq_attn_time": 23.954331398010254, "perdoc_allgather_time": 10.20804467201233, "perdoc_attn_time": 25.490790367126465, "output_shape": [8192, 64, 128]}, "per_seq_latency": 25.072547912597656, "per_doc_latency": 35.84630126953125, "per_seq_allgather_latency": 1.1590800046920777, "per_seq_attn_latency": 24.34464807510376, "per_doc_allgather_latency": 10.292137622833252, "per_doc_attn_latency": 25.85092191696167, "num_seq_in_batch": 1, "seq_len": 65536, "num_heads": 64, "head_dim": 128, "cp": 8, "tp": 1, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"7": {"per_seq_latency": 12.748728179931641, "per_doc_latency": 18.23912353515625, "perseq_allgather_time": 0.4383696034550667, "perseq_attn_time": 12.303651142120362, "perdoc_allgather_time": 5.0979856014251705, "perdoc_attn_time": 13.134465646743774, "output_shape": [8192, 32, 128]}, "0": {"per_seq_latency": 12.760942077636718, "per_doc_latency": 18.21331329345703, "perseq_allgather_time": 0.7041904017329216, "perseq_attn_time": 12.049692678451539, "perdoc_allgather_time": 5.090103960037231, "perdoc_attn_time": 13.116089630126954, "output_shape": [8192, 32, 128]}, "5": {"per_seq_latency": 12.752278137207032, "per_doc_latency": 18.198745727539062, "perseq_allgather_time": 0.6879199981689453, "perseq_attn_time": 12.057599925994873, "perdoc_allgather_time": 5.341953587532044, "perdoc_attn_time": 12.850051116943359, "output_shape": [8192, 32, 128]}, "1": {"per_seq_latency": 12.774703979492188, "per_doc_latency": 18.23259735107422, "perseq_allgather_time": 0.481116795539856, "perseq_attn_time": 12.28635516166687, "perdoc_allgather_time": 5.130630397796631, "perdoc_attn_time": 13.094881629943847, "output_shape": [8192, 32, 128]}, "4": {"per_seq_latency": 12.756253051757813, "per_doc_latency": 18.225672912597656, "perseq_allgather_time": 0.5736063957214356, "perseq_attn_time": 12.175928020477295, "perdoc_allgather_time": 5.116217637062073, "perdoc_attn_time": 13.102571201324462, "output_shape": [8192, 32, 128]}, "3": {"per_seq_latency": 12.736790466308594, "per_doc_latency": 18.2011474609375, "perseq_allgather_time": 0.5117519974708558, "perseq_attn_time": 12.217705631256104, "perdoc_allgather_time": 5.28899359703064, "perdoc_attn_time": 12.904908895492554, "output_shape": [8192, 32, 128]}, "6": {"per_seq_latency": 12.758367919921875, "per_doc_latency": 18.19786682128906, "perseq_allgather_time": 0.7035631954669952, "perseq_attn_time": 12.048004817962646, "perdoc_allgather_time": 5.31485116481781, "perdoc_attn_time": 12.876319980621338, "output_shape": [8192, 32, 128]}, "2": {"per_seq_latency": 12.752397155761718, "per_doc_latency": 18.278826904296874, "perseq_allgather_time": 0.47515359669923785, "perseq_attn_time": 12.27005615234375, "perdoc_allgather_time": 5.077625560760498, "perdoc_attn_time": 13.194031906127929, "output_shape": [8192, 32, 128]}, "per_seq_latency": 12.774703979492188, "per_doc_latency": 18.278826904296874, "per_seq_allgather_latency": 0.7041904017329216, "per_seq_attn_latency": 12.303651142120362, "per_doc_allgather_latency": 5.341953587532044, "per_doc_attn_latency": 13.194031906127929, "num_seq_in_batch": 1, "seq_len": 65536, "num_heads": 64, "head_dim": 128, "cp": 8, "tp": 2, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"7": {"per_seq_latency": 6.6542816162109375, "per_doc_latency": 9.193888092041016, "perseq_allgather_time": 0.28757440075278284, "perseq_attn_time": 6.3598384141921995, "perdoc_allgather_time": 2.4573343873023985, "perdoc_attn_time": 6.729753589630127, "output_shape": [8192, 16, 128]}, "0": {"per_seq_latency": 6.653841400146485, "per_doc_latency": 9.191321563720702, "perseq_allgather_time": 0.35888800099492074, "perseq_attn_time": 6.282936000823975, "perdoc_allgather_time": 2.605766403675079, "perdoc_attn_time": 6.578574371337891, "output_shape": [8192, 16, 128]}, "5": {"per_seq_latency": 6.647020721435547, "per_doc_latency": 9.18335189819336, "perseq_allgather_time": 0.3684015989303589, "perseq_attn_time": 6.271903944015503, "perdoc_allgather_time": 2.526692795753479, "perdoc_attn_time": 6.649814438819885, "output_shape": [8192, 16, 128]}, "4": {"per_seq_latency": 6.643705749511719, "per_doc_latency": 9.170600128173827, "perseq_allgather_time": 0.27361439988017083, "perseq_attn_time": 6.36330885887146, "perdoc_allgather_time": 2.515276777744293, "perdoc_attn_time": 6.648422431945801, "output_shape": [8192, 16, 128]}, "6": {"per_seq_latency": 6.641865539550781, "per_doc_latency": 9.186102294921875, "perseq_allgather_time": 0.3090208001434803, "perseq_attn_time": 6.326065611839295, "perdoc_allgather_time": 2.4595760107040405, "perdoc_attn_time": 6.7195232629776, "output_shape": [8192, 16, 128]}, "3": {"per_seq_latency": 6.641510772705078, "per_doc_latency": 9.18762435913086, "perseq_allgather_time": 0.3710399977862835, "perseq_attn_time": 6.263160014152527, "perdoc_allgather_time": 2.4867536067962646, "perdoc_attn_time": 6.693596816062927, "output_shape": [8192, 16, 128]}, "2": {"per_seq_latency": 6.6600288391113285, "per_doc_latency": 9.18095703125, "perseq_allgather_time": 0.334383998811245, "perseq_attn_time": 6.31831841468811, "perdoc_allgather_time": 2.4946143984794618, "perdoc_attn_time": 6.67901759147644, "output_shape": [8192, 16, 128]}, "1": {"per_seq_latency": 6.639324951171875, "per_doc_latency": 9.182917022705078, "perseq_allgather_time": 0.3512879990041256, "perseq_attn_time": 6.28088161945343, "perdoc_allgather_time": 2.5077199816703795, "perdoc_attn_time": 6.66799840927124, "output_shape": [8192, 16, 128]}, "per_seq_latency": 6.6600288391113285, "per_doc_latency": 9.193888092041016, "per_seq_allgather_latency": 0.3710399977862835, "per_seq_attn_latency": 6.36330885887146, "per_doc_allgather_latency": 2.605766403675079, "per_doc_attn_latency": 6.729753589630127, "num_seq_in_batch": 1, "seq_len": 65536, "num_heads": 64, "head_dim": 128, "cp": 8, "tp": 4, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"7": {"per_seq_latency": 3.6913822174072264, "per_doc_latency": 4.815334320068359, "perseq_allgather_time": 0.42018239572644234, "perseq_attn_time": 3.264364814758301, "perdoc_allgather_time": 1.303766393661499, "perdoc_attn_time": 3.5047136187553405, "output_shape": [8192, 8, 128]}, "0": {"per_seq_latency": 3.5248638153076173, "per_doc_latency": 4.814326477050781, "perseq_allgather_time": 0.24995040223002435, "perseq_attn_time": 3.260590374469757, "perdoc_allgather_time": 1.3140096068382263, "perdoc_attn_time": 3.493227207660675, "output_shape": [8192, 8, 128]}, "2": {"per_seq_latency": 3.691196823120117, "per_doc_latency": 4.817652893066406, "perseq_allgather_time": 0.4337407946586609, "perseq_attn_time": 3.249985599517822, "perdoc_allgather_time": 1.3346992135047913, "perdoc_attn_time": 3.4756271839141846, "output_shape": [8192, 8, 128]}, "4": {"per_seq_latency": 3.6940208435058595, "per_doc_latency": 4.812609481811523, "perseq_allgather_time": 0.42754719480872155, "perseq_attn_time": 3.2595855951309205, "perdoc_allgather_time": 1.322955197095871, "perdoc_attn_time": 3.482916808128357, "output_shape": [8192, 8, 128]}, "5": {"per_seq_latency": 3.691012954711914, "per_doc_latency": 4.812875366210937, "perseq_allgather_time": 0.4567359946668148, "perseq_attn_time": 3.2274368166923524, "perdoc_allgather_time": 1.3327472150325774, "perdoc_attn_time": 3.4733567953109743, "output_shape": [8192, 8, 128]}, "6": {"per_seq_latency": 3.6905071258544924, "per_doc_latency": 4.814705657958984, "perseq_allgather_time": 0.44352800622582433, "perseq_attn_time": 3.2402079701423645, "perdoc_allgather_time": 1.3396063923835755, "perdoc_attn_time": 3.46839679479599, "output_shape": [8192, 8, 128]}, "1": {"per_seq_latency": 3.691844940185547, "per_doc_latency": 4.813100814819336, "perseq_allgather_time": 0.45960800498723986, "perseq_attn_time": 3.2251984119415282, "perdoc_allgather_time": 1.2983471870422363, "perdoc_attn_time": 3.5076543927192687, "output_shape": [8192, 8, 128]}, "3": {"per_seq_latency": 3.6914112091064455, "per_doc_latency": 4.811329650878906, "perseq_allgather_time": 0.393595203012228, "perseq_attn_time": 3.2904943943023683, "perdoc_allgather_time": 1.3363360106945037, "perdoc_attn_time": 3.467745578289032, "output_shape": [8192, 8, 128]}, "per_seq_latency": 3.6940208435058595, "per_doc_latency": 4.817652893066406, "per_seq_allgather_latency": 0.45960800498723986, "per_seq_attn_latency": 3.2904943943023683, "per_doc_allgather_latency": 1.3396063923835755, "per_doc_attn_latency": 3.5076543927192687, "num_seq_in_batch": 1, "seq_len": 65536, "num_heads": 64, "head_dim": 128, "cp": 8, "tp": 8, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}