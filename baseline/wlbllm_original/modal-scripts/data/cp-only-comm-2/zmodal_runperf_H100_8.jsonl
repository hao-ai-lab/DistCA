{"0": {"per_seq_latency": 1.1059375762939454, "per_doc_latency": 271.6392822265625, "perseq_allgather_time": 0.6433631926774979, "perseq_attn_time": 0.44704640060663225, "perdoc_allgather_time": 240.06465606689454, "perdoc_attn_time": 31.537383937835692, "output_shape": [8192, 64, 128]}, "7": {"per_seq_latency": 1.6892303466796874, "per_doc_latency": 263.0569091796875, "perseq_allgather_time": 1.212526398897171, "perseq_attn_time": 0.46765120327472687, "perdoc_allgather_time": 232.89686431884766, "perdoc_attn_time": 30.137974548339844, "output_shape": [8192, 64, 128]}, "3": {"per_seq_latency": 1.6895599365234375, "per_doc_latency": 269.0311279296875, "perseq_allgather_time": 1.2256303966045379, "perseq_attn_time": 0.4558799996972084, "perdoc_allgather_time": 238.65765533447265, "perdoc_attn_time": 30.352348709106444, "output_shape": [8192, 64, 128]}, "2": {"per_seq_latency": 1.6887184143066407, "per_doc_latency": 270.890185546875, "perseq_allgather_time": 1.2356576085090638, "perseq_attn_time": 0.44583200216293334, "perdoc_allgather_time": 240.5708885192871, "perdoc_attn_time": 30.297806549072266, "output_shape": [8192, 64, 128]}, "5": {"per_seq_latency": 1.6900672912597656, "per_doc_latency": 268.1824951171875, "perseq_allgather_time": 1.2328992038965225, "perseq_attn_time": 0.45051359534263613, "perdoc_allgather_time": 239.7927360534668, "perdoc_attn_time": 28.370631885528564, "output_shape": [8192, 64, 128]}, "4": {"per_seq_latency": 1.6896543502807617, "per_doc_latency": 270.6259521484375, "perseq_allgather_time": 1.216404777765274, "perseq_attn_time": 0.46472799926996233, "perdoc_allgather_time": 243.91541595458983, "perdoc_attn_time": 26.693779468536377, "output_shape": [8192, 64, 128]}, "1": {"per_seq_latency": 1.6888992309570312, "per_doc_latency": 274.2505126953125, "perseq_allgather_time": 1.236291202902794, "perseq_attn_time": 0.44549760073423383, "perdoc_allgather_time": 243.07261810302734, "perdoc_attn_time": 31.155484867095947, "output_shape": [8192, 64, 128]}, "6": {"per_seq_latency": 1.6898000717163086, "per_doc_latency": 267.60947265625, "perseq_allgather_time": 1.2347952038049699, "perseq_attn_time": 0.44827680140733717, "perdoc_allgather_time": 236.80320892333984, "perdoc_attn_time": 30.78464298248291, "output_shape": [8192, 64, 128]}, "per_seq_latency": 0.0016504563391208649, "per_doc_latency": 0.26782276630401614, "per_seq_allgather_latency": 0.0012073156278347597, "per_seq_attn_latency": 0.00045669062819797546, "per_doc_allgather_latency": 0.23819864839315413, "per_doc_attn_latency": 0.030798226501792668, "num_seq_in_batch": 1024, "seq_len": 64, "num_heads": 64, "head_dim": 128, "cp": 8, "tp": 1, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"7": {"per_seq_latency": 1.091430377960205, "per_doc_latency": 267.8000244140625, "perseq_allgather_time": 0.7708575919270515, "perseq_attn_time": 0.2980719983577728, "perdoc_allgather_time": 239.52442169189453, "perdoc_attn_time": 28.07612810134888, "output_shape": [8192, 32, 128]}, "0": {"per_seq_latency": 0.8458576202392578, "per_doc_latency": 276.1662841796875, "perseq_allgather_time": 0.4948080003261566, "perseq_attn_time": 0.29676959812641146, "perdoc_allgather_time": 245.22649765014648, "perdoc_attn_time": 30.358398628234863, "output_shape": [8192, 32, 128]}, "6": {"per_seq_latency": 1.0912896156311036, "per_doc_latency": 271.3525634765625, "perseq_allgather_time": 0.7747280016541481, "perseq_attn_time": 0.2963039979338646, "perdoc_allgather_time": 246.8935348510742, "perdoc_attn_time": 24.28305592536926, "output_shape": [8192, 32, 128]}, "4": {"per_seq_latency": 1.0913999557495118, "per_doc_latency": 277.0561767578125, "perseq_allgather_time": 0.791606391966343, "perseq_attn_time": 0.28725759983062743, "perdoc_allgather_time": 248.55380325317384, "perdoc_attn_time": 28.226791763305663, "output_shape": [8192, 32, 128]}, "1": {"per_seq_latency": 1.0913583755493164, "per_doc_latency": 276.5394287109375, "perseq_allgather_time": 0.7946640089154243, "perseq_attn_time": 0.28272159993648527, "perdoc_allgather_time": 247.9058822631836, "perdoc_attn_time": 28.428621006011962, "output_shape": [8192, 32, 128]}, "2": {"per_seq_latency": 1.0912960052490235, "per_doc_latency": 276.1605224609375, "perseq_allgather_time": 0.7770816057920455, "perseq_attn_time": 0.297665598988533, "perdoc_allgather_time": 247.70268173217772, "perdoc_attn_time": 28.29264965057373, "output_shape": [8192, 32, 128]}, "5": {"per_seq_latency": 1.091487979888916, "per_doc_latency": 274.7480224609375, "perseq_allgather_time": 0.793793597817421, "perseq_attn_time": 0.2854864031076431, "perdoc_allgather_time": 245.75130615234374, "perdoc_attn_time": 28.810528087615968, "output_shape": [8192, 32, 128]}, "3": {"per_seq_latency": 1.0911744117736817, "per_doc_latency": 274.3583740234375, "perseq_allgather_time": 0.7874671995639801, "perseq_attn_time": 0.28967679888010023, "perdoc_allgather_time": 246.52765045166015, "perdoc_attn_time": 27.61907501220703, "output_shape": [8192, 32, 128]}, "per_seq_latency": 0.0010659062303602696, "per_doc_latency": 0.2705626726150513, "per_seq_allgather_latency": 0.0007760390712064691, "per_seq_attn_latency": 0.0002910859358962625, "per_doc_allgather_latency": 0.24272832348942758, "per_doc_attn_latency": 0.029646873660385608, "num_seq_in_batch": 1024, "seq_len": 64, "num_heads": 64, "head_dim": 128, "cp": 8, "tp": 2, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 0.7941423892974854, "per_doc_latency": 273.8811767578125, "perseq_allgather_time": 0.36159520149230956, "perseq_attn_time": 0.29774400144815444, "perdoc_allgather_time": 242.34643020629883, "perdoc_attn_time": 30.678575801849366, "output_shape": [8192, 16, 128]}, "7": {"per_seq_latency": 1.0586560249328614, "per_doc_latency": 275.8164794921875, "perseq_allgather_time": 0.7658527925610542, "perseq_attn_time": 0.22633919939398767, "perdoc_allgather_time": 247.82135848999025, "perdoc_attn_time": 27.376430416107176, "output_shape": [8192, 16, 128]}, "4": {"per_seq_latency": 1.0600095748901368, "per_doc_latency": 266.330126953125, "perseq_allgather_time": 0.7516207873821259, "perseq_attn_time": 0.2361407995223999, "perdoc_allgather_time": 238.5010498046875, "perdoc_attn_time": 27.375930976867675, "output_shape": [8192, 16, 128]}, "5": {"per_seq_latency": 1.0586511611938476, "per_doc_latency": 264.9162353515625, "perseq_allgather_time": 0.7574127972126007, "perseq_attn_time": 0.2322367988526821, "perdoc_allgather_time": 236.75366592407227, "perdoc_attn_time": 27.70434856414795, "output_shape": [8192, 16, 128]}, "3": {"per_seq_latency": 1.0592255592346191, "per_doc_latency": 270.416259765625, "perseq_allgather_time": 0.7652016133069992, "perseq_attn_time": 0.2258432000875473, "perdoc_allgather_time": 242.02436218261718, "perdoc_attn_time": 27.904961776733398, "output_shape": [8192, 16, 128]}, "1": {"per_seq_latency": 1.0594143867492676, "per_doc_latency": 268.2248779296875, "perseq_allgather_time": 0.759260793030262, "perseq_attn_time": 0.2308304004371166, "perdoc_allgather_time": 241.5036277770996, "perdoc_attn_time": 26.189921569824218, "output_shape": [8192, 16, 128]}, "2": {"per_seq_latency": 1.0605839729309081, "per_doc_latency": 272.406201171875, "perseq_allgather_time": 0.7463760048151016, "perseq_attn_time": 0.24031680151820184, "perdoc_allgather_time": 243.87939224243163, "perdoc_attn_time": 28.040595149993898, "output_shape": [8192, 16, 128]}, "6": {"per_seq_latency": 1.0586992263793946, "per_doc_latency": 272.46728515625, "perseq_allgather_time": 0.7549456015229226, "perseq_attn_time": 0.23514719903469086, "perdoc_allgather_time": 244.8723892211914, "perdoc_attn_time": 27.026390266418456, "output_shape": [8192, 16, 128]}, "per_seq_latency": 0.00103572653606534, "per_doc_latency": 0.26935203075408937, "per_seq_allgather_latency": 0.0007479031177354045, "per_seq_attn_latency": 0.0002907656264142133, "per_doc_allgather_latency": 0.2420130454003811, "per_doc_attn_latency": 0.02995954668149352, "num_seq_in_batch": 1024, "seq_len": 64, "num_heads": 64, "head_dim": 128, "cp": 8, "tp": 4, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"7": {"per_seq_latency": 0.9698224067687988, "per_doc_latency": 276.85078125, "perseq_allgather_time": 0.6634816020727158, "perseq_attn_time": 0.21768000200390816, "perdoc_allgather_time": 249.3705924987793, "perdoc_attn_time": 26.71280174255371, "output_shape": [8192, 8, 128]}, "0": {"per_seq_latency": 0.7567696094512939, "per_doc_latency": 279.1479736328125, "perseq_allgather_time": 0.3492032065987587, "perseq_attn_time": 0.27169919982552526, "perdoc_allgather_time": 250.6884422302246, "perdoc_attn_time": 27.29993782043457, "output_shape": [8192, 8, 128]}, "4": {"per_seq_latency": 0.9740976333618164, "per_doc_latency": 266.91337890625, "perseq_allgather_time": 0.675828792154789, "perseq_attn_time": 0.20907519906759262, "perdoc_allgather_time": 240.95676498413087, "perdoc_attn_time": 25.34095993041992, "output_shape": [8192, 8, 128]}, "6": {"per_seq_latency": 0.9721648216247558, "per_doc_latency": 270.143798828125, "perseq_allgather_time": 0.6709952026605606, "perseq_attn_time": 0.21195679977536203, "perdoc_allgather_time": 246.42487106323242, "perdoc_attn_time": 23.099033880233765, "output_shape": [8192, 8, 128]}, "2": {"per_seq_latency": 0.9240927696228027, "per_doc_latency": 273.514306640625, "perseq_allgather_time": 0.6239456102252007, "perseq_attn_time": 0.20802560001611708, "perdoc_allgather_time": 245.8461555480957, "perdoc_attn_time": 26.955798053741454, "output_shape": [8192, 8, 128]}, "5": {"per_seq_latency": 0.9720959663391113, "per_doc_latency": 269.31650390625, "perseq_allgather_time": 0.6687759920954705, "perseq_attn_time": 0.2132767990231514, "perdoc_allgather_time": 241.13241806030274, "perdoc_attn_time": 27.436412620544434, "output_shape": [8192, 8, 128]}, "3": {"per_seq_latency": 0.9721903800964355, "per_doc_latency": 268.131787109375, "perseq_allgather_time": 0.6687824040651321, "perseq_attn_time": 0.21386399790644645, "perdoc_allgather_time": 241.16151428222656, "perdoc_attn_time": 26.262532711029053, "output_shape": [8192, 8, 128]}, "1": {"per_seq_latency": 0.9717184066772461, "per_doc_latency": 274.1144775390625, "perseq_allgather_time": 0.644998399913311, "perseq_attn_time": 0.23313120007514954, "perdoc_allgather_time": 246.0134162902832, "perdoc_attn_time": 27.39734058380127, "output_shape": [8192, 8, 128]}, "per_seq_latency": 0.0009512672200798989, "per_doc_latency": 0.2726054430007935, "per_seq_allgather_latency": 0.0006599890548386611, "per_seq_attn_latency": 0.0002653312498296145, "per_doc_allgather_latency": 0.24481293186545372, "per_doc_attn_latency": 0.026793371699750424, "num_seq_in_batch": 1024, "seq_len": 64, "num_heads": 64, "head_dim": 128, "cp": 8, "tp": 8, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"7": {"per_seq_latency": 1.274745559692383, "per_doc_latency": 130.01240234375, "perseq_allgather_time": 0.8260447949171066, "perseq_attn_time": 0.44149279594421387, "perdoc_allgather_time": 115.12521896362304, "perdoc_attn_time": 14.868611240386963, "output_shape": [8192, 64, 128]}, "0": {"per_seq_latency": 1.0657567977905273, "per_doc_latency": 135.4979248046875, "perseq_allgather_time": 0.6135487914085388, "perseq_attn_time": 0.437814399600029, "perdoc_allgather_time": 118.32777481079101, "perdoc_attn_time": 17.150296020507813, "output_shape": [8192, 64, 128]}, "4": {"per_seq_latency": 1.275011157989502, "per_doc_latency": 130.54117431640626, "perseq_allgather_time": 0.8306320011615753, "perseq_attn_time": 0.43757599890232085, "perdoc_allgather_time": 115.02311973571777, "perdoc_attn_time": 15.49784321784973, "output_shape": [8192, 64, 128]}, "1": {"per_seq_latency": 1.2752351760864258, "per_doc_latency": 130.99132080078124, "perseq_allgather_time": 0.8178544104099273, "perseq_attn_time": 0.44829919636249543, "perdoc_allgather_time": 115.49011535644532, "perdoc_attn_time": 15.478452825546265, "output_shape": [8192, 64, 128]}, "5": {"per_seq_latency": 1.2747695922851563, "per_doc_latency": 131.47476806640626, "perseq_allgather_time": 0.8321439951658249, "perseq_attn_time": 0.43586719781160355, "perdoc_allgather_time": 115.9390380859375, "perdoc_attn_time": 15.515606451034547, "output_shape": [8192, 64, 128]}, "2": {"per_seq_latency": 1.2749551773071288, "per_doc_latency": 129.23909912109374, "perseq_allgather_time": 0.830715212225914, "perseq_attn_time": 0.4372111976146698, "perdoc_allgather_time": 113.87940330505371, "perdoc_attn_time": 15.3397647857666, "output_shape": [8192, 64, 128]}, "3": {"per_seq_latency": 1.2751199722290039, "per_doc_latency": 130.70919189453124, "perseq_allgather_time": 0.8319023996591568, "perseq_attn_time": 0.43606879711151125, "perdoc_allgather_time": 115.01766052246094, "perdoc_attn_time": 15.671475219726563, "output_shape": [8192, 64, 128]}, "6": {"per_seq_latency": 1.2751551628112794, "per_doc_latency": 131.45377197265626, "perseq_allgather_time": 0.8343071907758712, "perseq_attn_time": 0.4340848013758659, "perdoc_allgather_time": 115.92575721740722, "perdoc_attn_time": 15.50676326751709, "output_shape": [8192, 64, 128]}, "per_seq_latency": 0.0024906937032938004, "per_doc_latency": 0.2646443843841553, "per_seq_allgather_latency": 0.0016295062319841235, "per_seq_attn_latency": 0.0008755843678954989, "per_doc_allgather_latency": 0.2311089351773262, "per_doc_attn_latency": 0.03349667191505432, "num_seq_in_batch": 512, "seq_len": 128, "num_heads": 64, "head_dim": 128, "cp": 8, "tp": 1, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"7": {"per_seq_latency": 1.0892831802368164, "per_doc_latency": 129.8605224609375, "perseq_allgather_time": 0.7870111897587776, "perseq_attn_time": 0.28609439730644226, "perdoc_allgather_time": 116.1365249633789, "perdoc_attn_time": 13.687472105026245, "output_shape": [8192, 32, 128]}, "0": {"per_seq_latency": 0.8922831535339355, "per_doc_latency": 135.11483154296874, "perseq_allgather_time": 0.5121935993432999, "perseq_attn_time": 0.3087487995624542, "perdoc_allgather_time": 117.19259643554688, "perdoc_attn_time": 17.75842080116272, "output_shape": [8192, 32, 128]}, "1": {"per_seq_latency": 1.0889472007751464, "per_doc_latency": 129.73912353515624, "perseq_allgather_time": 0.7760448053479194, "perseq_attn_time": 0.29130719900131224, "perdoc_allgather_time": 116.18122711181641, "perdoc_attn_time": 13.53686876296997, "output_shape": [8192, 32, 128]}, "5": {"per_seq_latency": 1.0887455940246582, "per_doc_latency": 133.95792236328126, "perseq_allgather_time": 0.7832144156098366, "perseq_attn_time": 0.28744159936904906, "perdoc_allgather_time": 120.24184112548828, "perdoc_attn_time": 13.695416116714478, "output_shape": [8192, 32, 128]}, "6": {"per_seq_latency": 1.1067760467529297, "per_doc_latency": 135.82135009765625, "perseq_allgather_time": 0.7721999928355217, "perseq_attn_time": 0.3025920018553734, "perdoc_allgather_time": 122.06839027404786, "perdoc_attn_time": 13.72648482322693, "output_shape": [8192, 32, 128]}, "4": {"per_seq_latency": 1.0886799812316894, "per_doc_latency": 133.022607421875, "perseq_allgather_time": 0.790350404381752, "perseq_attn_time": 0.28434560149908067, "perdoc_allgather_time": 119.18806381225586, "perdoc_attn_time": 13.814443254470826, "output_shape": [8192, 32, 128]}, "3": {"per_seq_latency": 1.0884623527526855, "per_doc_latency": 132.40689697265626, "perseq_allgather_time": 0.7719792038202286, "perseq_attn_time": 0.29382880181074145, "perdoc_allgather_time": 118.65241088867188, "perdoc_attn_time": 13.734460878372193, "output_shape": [8192, 32, 128]}, "2": {"per_seq_latency": 1.0887136459350586, "per_doc_latency": 129.09505615234374, "perseq_allgather_time": 0.7926064088940621, "perseq_attn_time": 0.2829472005367279, "perdoc_allgather_time": 115.24441261291504, "perdoc_attn_time": 13.829944133758545, "output_shape": [8192, 32, 128]}, "per_seq_latency": 0.002161671966314316, "per_doc_latency": 0.26527607440948486, "per_seq_allgather_latency": 0.001548059392371215, "per_seq_attn_latency": 0.0006030249991454184, "per_doc_allgather_latency": 0.23841482475399972, "per_doc_attn_latency": 0.03468441562727094, "num_seq_in_batch": 512, "seq_len": 128, "num_heads": 64, "head_dim": 128, "cp": 8, "tp": 2, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"7": {"per_seq_latency": 1.0076144218444825, "per_doc_latency": 126.3181640625, "perseq_allgather_time": 0.6994048014283181, "perseq_attn_time": 0.2370015986263752, "perdoc_allgather_time": 113.50676193237305, "perdoc_attn_time": 12.68212957382202, "output_shape": [8192, 16, 128]}, "0": {"per_seq_latency": 0.7892879962921142, "per_doc_latency": 133.28133544921874, "perseq_allgather_time": 0.37538560181856157, "perseq_attn_time": 0.2893375962972641, "perdoc_allgather_time": 117.54247360229492, "perdoc_attn_time": 15.264656019210815, "output_shape": [8192, 16, 128]}, "3": {"per_seq_latency": 1.0091919898986816, "per_doc_latency": 133.26942138671876, "perseq_allgather_time": 0.6917423903942108, "perseq_attn_time": 0.2423231989145279, "perdoc_allgather_time": 120.37088623046876, "perdoc_attn_time": 12.766303968429565, "output_shape": [8192, 16, 128]}, "1": {"per_seq_latency": 1.0101200103759767, "per_doc_latency": 129.3821044921875, "perseq_allgather_time": 0.6914448067545891, "perseq_attn_time": 0.2414768010377884, "perdoc_allgather_time": 118.87393798828126, "perdoc_attn_time": 10.405543971061707, "output_shape": [8192, 16, 128]}, "4": {"per_seq_latency": 1.0059087753295899, "per_doc_latency": 128.2354736328125, "perseq_allgather_time": 0.6783295899629593, "perseq_attn_time": 0.248038399964571, "perdoc_allgather_time": 117.60774993896484, "perdoc_attn_time": 10.496783924102782, "output_shape": [8192, 16, 128]}, "2": {"per_seq_latency": 1.0079279899597169, "per_doc_latency": 127.40107421875, "perseq_allgather_time": 0.6865792006254197, "perseq_attn_time": 0.24420960023999214, "perdoc_allgather_time": 114.48575286865234, "perdoc_attn_time": 12.79024796485901, "output_shape": [8192, 16, 128]}, "5": {"per_seq_latency": 1.0077024459838868, "per_doc_latency": 130.2445068359375, "perseq_allgather_time": 0.7047664001584053, "perseq_attn_time": 0.23354400098323821, "perdoc_allgather_time": 117.70830307006835, "perdoc_attn_time": 12.383604836463928, "output_shape": [8192, 16, 128]}, "6": {"per_seq_latency": 1.0078384399414062, "per_doc_latency": 133.4195556640625, "perseq_allgather_time": 0.6890736073255539, "perseq_attn_time": 0.24232639893889427, "perdoc_allgather_time": 120.37775382995605, "perdoc_attn_time": 12.841555213928222, "output_shape": [8192, 16, 128]}, "per_seq_latency": 0.0019728906452655794, "per_doc_latency": 0.26058506965637207, "per_seq_allgather_latency": 0.0013764968753093854, "per_seq_attn_latency": 0.0005651124927680939, "per_doc_allgather_latency": 0.2351128004491329, "per_doc_attn_latency": 0.029813781287521122, "num_seq_in_batch": 512, "seq_len": 128, "num_heads": 64, "head_dim": 128, "cp": 8, "tp": 4, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 0.733619213104248, "per_doc_latency": 131.63558349609374, "perseq_allgather_time": 0.3770160049200058, "perseq_attn_time": 0.2296527996659279, "perdoc_allgather_time": 115.22227401733399, "perdoc_attn_time": 15.62965922355652, "output_shape": [8192, 8, 128]}, "7": {"per_seq_latency": 0.9557359695434571, "per_doc_latency": 129.78240966796875, "perseq_allgather_time": 0.6411280080676078, "perseq_attn_time": 0.2223024010658264, "perdoc_allgather_time": 117.08922843933105, "perdoc_attn_time": 12.41169285774231, "output_shape": [8192, 8, 128]}, "4": {"per_seq_latency": 0.9554832458496094, "per_doc_latency": 131.066552734375, "perseq_allgather_time": 0.6458367943763733, "perseq_attn_time": 0.21533279940485955, "perdoc_allgather_time": 118.50207023620605, "perdoc_attn_time": 12.27740478515625, "output_shape": [8192, 8, 128]}, "1": {"per_seq_latency": 0.9576687812805176, "per_doc_latency": 129.54254150390625, "perseq_allgather_time": 0.6104959964752197, "perseq_attn_time": 0.24785759598016738, "perdoc_allgather_time": 116.80925750732422, "perdoc_attn_time": 12.441956806182862, "output_shape": [8192, 8, 128]}, "3": {"per_seq_latency": 0.9529279708862305, "per_doc_latency": 132.85733642578126, "perseq_allgather_time": 0.652771209180355, "perseq_attn_time": 0.21183360144495963, "perdoc_allgather_time": 120.17701644897461, "perdoc_attn_time": 12.399857521057129, "output_shape": [8192, 8, 128]}, "6": {"per_seq_latency": 0.9559472084045411, "per_doc_latency": 127.38670654296875, "perseq_allgather_time": 0.6537535935640335, "perseq_attn_time": 0.21204959899187087, "perdoc_allgather_time": 114.81599082946778, "perdoc_attn_time": 12.29041919708252, "output_shape": [8192, 8, 128]}, "5": {"per_seq_latency": 0.9553999900817871, "per_doc_latency": 127.817626953125, "perseq_allgather_time": 0.60364800542593, "perseq_attn_time": 0.2546112038195133, "perdoc_allgather_time": 115.2233512878418, "perdoc_attn_time": 12.28857593536377, "output_shape": [8192, 8, 128]}, "2": {"per_seq_latency": 0.9573792457580567, "per_doc_latency": 130.31182861328125, "perseq_allgather_time": 0.6550095975399017, "perseq_attn_time": 0.21283199787139892, "perdoc_allgather_time": 117.55868530273438, "perdoc_attn_time": 12.450553607940673, "output_shape": [8192, 8, 128]}, "per_seq_latency": 0.001870446838438511, "per_doc_latency": 0.259486985206604, "per_seq_allgather_latency": 0.0012793156201951206, "per_seq_attn_latency": 0.0004972875074599869, "per_doc_allgather_latency": 0.23472073525190354, "per_doc_attn_latency": 0.030526678171008827, "num_seq_in_batch": 512, "seq_len": 128, "num_heads": 64, "head_dim": 128, "cp": 8, "tp": 8, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"7": {"per_seq_latency": 1.3166959762573243, "per_doc_latency": 66.24313354492188, "perseq_allgather_time": 0.8066735982894897, "perseq_attn_time": 0.5032464042305946, "perdoc_allgather_time": 57.492513465881345, "perdoc_attn_time": 8.739537572860717, "output_shape": [8192, 64, 128]}, "0": {"per_seq_latency": 1.126155185699463, "per_doc_latency": 67.14893188476563, "perseq_allgather_time": 0.5828447937965393, "perseq_attn_time": 0.5147296011447906, "perdoc_allgather_time": 57.85153942108154, "perdoc_attn_time": 9.283451271057128, "output_shape": [8192, 64, 128]}, "4": {"per_seq_latency": 1.315337562561035, "per_doc_latency": 68.1054931640625, "perseq_allgather_time": 0.8000272035598754, "perseq_attn_time": 0.5050543949007988, "perdoc_allgather_time": 59.171366119384764, "perdoc_attn_time": 8.92293438911438, "output_shape": [8192, 64, 128]}, "2": {"per_seq_latency": 1.316220760345459, "per_doc_latency": 67.21431884765624, "perseq_allgather_time": 0.8026303946971893, "perseq_attn_time": 0.5063616022467613, "perdoc_allgather_time": 58.03651866912842, "perdoc_attn_time": 9.165412759780883, "output_shape": [8192, 64, 128]}, "5": {"per_seq_latency": 1.3162575721740724, "per_doc_latency": 66.99602661132812, "perseq_allgather_time": 0.80381920337677, "perseq_attn_time": 0.505675196647644, "perdoc_allgather_time": 58.24117240905762, "perdoc_attn_time": 8.742564868927001, "output_shape": [8192, 64, 128]}, "6": {"per_seq_latency": 1.316915225982666, "per_doc_latency": 65.28850708007812, "perseq_allgather_time": 0.8032448053359985, "perseq_attn_time": 0.5069632008671761, "perdoc_allgather_time": 56.43644275665283, "perdoc_attn_time": 8.841811180114746, "output_shape": [8192, 64, 128]}, "1": {"per_seq_latency": 1.316380786895752, "per_doc_latency": 66.54974365234375, "perseq_allgather_time": 0.8099359959363938, "perseq_attn_time": 0.4994367972016335, "perdoc_allgather_time": 57.821332931518555, "perdoc_attn_time": 8.718632173538207, "output_shape": [8192, 64, 128]}, "3": {"per_seq_latency": 1.3151488304138184, "per_doc_latency": 67.922900390625, "perseq_allgather_time": 0.80278559923172, "perseq_attn_time": 0.5051200047135354, "perdoc_allgather_time": 58.866768264770506, "perdoc_attn_time": 9.045657634735107, "output_shape": [8192, 64, 128]}, "per_seq_latency": 0.005144200101494789, "per_doc_latency": 0.2660370826721191, "per_seq_allgather_latency": 0.003163812484126538, "per_seq_attn_latency": 0.0020106625044718383, "per_doc_allgather_latency": 0.23113814890384674, "per_doc_attn_latency": 0.03626348152756691, "num_seq_in_batch": 256, "seq_len": 256, "num_heads": 64, "head_dim": 128, "cp": 8, "tp": 1, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 0.8157648086547852, "per_doc_latency": 68.87909545898438, "perseq_allgather_time": 0.45194239616394044, "perseq_attn_time": 0.3183615982532501, "perdoc_allgather_time": 60.91673564910889, "perdoc_attn_time": 7.844492769241333, "output_shape": [8192, 32, 128]}, "7": {"per_seq_latency": 1.0360416412353515, "per_doc_latency": 67.09537353515626, "perseq_allgather_time": 0.6992208048701286, "perseq_attn_time": 0.3234175994992256, "perdoc_allgather_time": 60.3172794342041, "perdoc_attn_time": 6.763590383529663, "output_shape": [8192, 32, 128]}, "1": {"per_seq_latency": 1.0364303588867188, "per_doc_latency": 66.53211059570313, "perseq_allgather_time": 0.6972031936049461, "perseq_attn_time": 0.3293152004480362, "perdoc_allgather_time": 59.020406341552736, "perdoc_attn_time": 7.493108797073364, "output_shape": [8192, 32, 128]}, "2": {"per_seq_latency": 1.035976028442383, "per_doc_latency": 67.00826416015624, "perseq_allgather_time": 0.7112719997763634, "perseq_attn_time": 0.3124640017747879, "perdoc_allgather_time": 59.55889949798584, "perdoc_attn_time": 7.43109278678894, "output_shape": [8192, 32, 128]}, "5": {"per_seq_latency": 1.0361632347106933, "per_doc_latency": 67.21910400390625, "perseq_allgather_time": 0.7086799934506416, "perseq_attn_time": 0.31793759763240814, "perdoc_allgather_time": 59.756218910217285, "perdoc_attn_time": 7.418015956878662, "output_shape": [8192, 32, 128]}, "6": {"per_seq_latency": 1.0363823890686035, "per_doc_latency": 67.08513793945312, "perseq_allgather_time": 0.7108303934335709, "perseq_attn_time": 0.3138480007648468, "perdoc_allgather_time": 59.60792903900146, "perdoc_attn_time": 7.458574414253235, "output_shape": [8192, 32, 128]}, "4": {"per_seq_latency": 1.0351519584655762, "per_doc_latency": 67.45791625976562, "perseq_allgather_time": 0.7052127882838249, "perseq_attn_time": 0.3195008009672165, "perdoc_allgather_time": 60.77120304107666, "perdoc_attn_time": 6.67139048576355, "output_shape": [8192, 32, 128]}, "3": {"per_seq_latency": 1.0362624168395995, "per_doc_latency": 66.84742431640625, "perseq_allgather_time": 0.7100991904735565, "perseq_attn_time": 0.3172784000635147, "perdoc_allgather_time": 59.24511833190918, "perdoc_attn_time": 7.584427237510681, "output_shape": [8192, 32, 128]}, "per_seq_latency": 0.004048556089401245, "per_doc_latency": 0.26905896663665774, "per_seq_allgather_latency": 0.0027784062491264193, "per_seq_attn_latency": 0.0012863875017501414, "per_doc_allgather_latency": 0.2379559986293316, "per_doc_attn_latency": 0.030642549879848956, "num_seq_in_batch": 256, "seq_len": 256, "num_heads": 64, "head_dim": 128, "cp": 8, "tp": 2, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 0.8555295944213868, "per_doc_latency": 67.18795776367188, "perseq_allgather_time": 0.4702496036887169, "perseq_attn_time": 0.26755999997258184, "perdoc_allgather_time": 60.168568229675294, "perdoc_attn_time": 6.861800050735473, "output_shape": [8192, 16, 128]}, "7": {"per_seq_latency": 1.0838560104370116, "per_doc_latency": 65.20162963867188, "perseq_allgather_time": 0.7595663994550705, "perseq_attn_time": 0.25177439823746683, "perdoc_allgather_time": 59.24822521209717, "perdoc_attn_time": 5.881905579566956, "output_shape": [8192, 16, 128]}, "1": {"per_seq_latency": 1.0834239959716796, "per_doc_latency": 64.929931640625, "perseq_allgather_time": 0.7628431960940361, "perseq_attn_time": 0.24939039945602418, "perdoc_allgather_time": 58.75583553314209, "perdoc_attn_time": 6.135660791397095, "output_shape": [8192, 16, 128]}, "4": {"per_seq_latency": 1.0798048019409179, "per_doc_latency": 64.04457397460938, "perseq_allgather_time": 0.753022401034832, "perseq_attn_time": 0.2596144013106823, "perdoc_allgather_time": 57.234507942199706, "perdoc_attn_time": 6.7330447912216185, "output_shape": [8192, 16, 128]}, "2": {"per_seq_latency": 1.0833680152893066, "per_doc_latency": 63.98301391601562, "perseq_allgather_time": 0.7522543996572495, "perseq_attn_time": 0.2604175999760628, "perdoc_allgather_time": 57.18026065826416, "perdoc_attn_time": 6.756979203224182, "output_shape": [8192, 16, 128]}, "5": {"per_seq_latency": 1.0891887664794921, "per_doc_latency": 64.05466918945312, "perseq_allgather_time": 0.7692047983407975, "perseq_attn_time": 0.2520495980978012, "perdoc_allgather_time": 58.08500652313232, "perdoc_attn_time": 5.896494436264038, "output_shape": [8192, 16, 128]}, "6": {"per_seq_latency": 1.0825519561767578, "per_doc_latency": 66.043798828125, "perseq_allgather_time": 0.7713776111602784, "perseq_attn_time": 0.24720319956541062, "perdoc_allgather_time": 60.906873321533205, "perdoc_attn_time": 5.07778080701828, "output_shape": [8192, 16, 128]}, "3": {"per_seq_latency": 1.0827775955200196, "per_doc_latency": 64.724365234375, "perseq_allgather_time": 0.7774528115987778, "perseq_attn_time": 0.23965919986367226, "perdoc_allgather_time": 57.818270683288574, "perdoc_attn_time": 6.87359037399292, "output_shape": [8192, 16, 128]}, "per_seq_latency": 0.004254643619060516, "per_doc_latency": 0.26245296001434326, "per_seq_allgather_latency": 0.0030369250453077257, "per_seq_attn_latency": 0.0010451562498928978, "per_doc_allgather_latency": 0.23791747391223908, "per_doc_attn_latency": 0.026849962398409845, "num_seq_in_batch": 256, "seq_len": 256, "num_heads": 64, "head_dim": 128, "cp": 8, "tp": 4, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"7": {"per_seq_latency": 0.9445775985717774, "per_doc_latency": 65.29519653320312, "perseq_allgather_time": 0.6530352041125298, "perseq_attn_time": 0.2050831988453865, "perdoc_allgather_time": 58.79867382049561, "perdoc_attn_time": 6.286268746852874, "output_shape": [8192, 8, 128]}, "0": {"per_seq_latency": 0.7156288146972656, "per_doc_latency": 65.24854125976563, "perseq_allgather_time": 0.3415184020996094, "perseq_attn_time": 0.25571359917521475, "perdoc_allgather_time": 58.30872001647949, "perdoc_attn_time": 6.547596788406372, "output_shape": [8192, 8, 128]}, "3": {"per_seq_latency": 0.9412783622741699, "per_doc_latency": 63.734246826171876, "perseq_allgather_time": 0.6268047988414764, "perseq_attn_time": 0.2205760009586811, "perdoc_allgather_time": 57.17956657409668, "perdoc_attn_time": 6.391292834281922, "output_shape": [8192, 8, 128]}, "6": {"per_seq_latency": 0.9489935874938965, "per_doc_latency": 64.13779296875, "perseq_allgather_time": 0.632443206012249, "perseq_attn_time": 0.21997919902205468, "perdoc_allgather_time": 57.89712657928467, "perdoc_attn_time": 6.0570672154426575, "output_shape": [8192, 8, 128]}, "4": {"per_seq_latency": 0.9433247566223144, "per_doc_latency": 63.813909912109374, "perseq_allgather_time": 0.652449594438076, "perseq_attn_time": 0.20205920040607453, "perdoc_allgather_time": 57.09364280700684, "perdoc_attn_time": 6.508078384399414, "output_shape": [8192, 8, 128]}, "1": {"per_seq_latency": 0.9445487976074218, "per_doc_latency": 63.94608764648437, "perseq_allgather_time": 0.6114159896969795, "perseq_attn_time": 0.23641760125756264, "perdoc_allgather_time": 57.29439144134521, "perdoc_attn_time": 6.486500811576843, "output_shape": [8192, 8, 128]}, "5": {"per_seq_latency": 0.9479200363159179, "per_doc_latency": 66.16217651367188, "perseq_allgather_time": 0.6233951970934868, "perseq_attn_time": 0.2269648015499115, "perdoc_allgather_time": 59.600776290893556, "perdoc_attn_time": 6.383479952812195, "output_shape": [8192, 8, 128]}, "2": {"per_seq_latency": 0.9428112030029296, "per_doc_latency": 63.54058837890625, "perseq_allgather_time": 0.6495871931314469, "perseq_attn_time": 0.20540320128202438, "perdoc_allgather_time": 56.80989112854004, "perdoc_attn_time": 6.565049576759338, "output_shape": [8192, 8, 128]}, "per_seq_latency": 0.0037070062011480332, "per_doc_latency": 0.2584460020065308, "per_seq_allgather_latency": 0.0025509187660645695, "per_seq_attn_latency": 0.0009988812467781826, "per_doc_allgather_latency": 0.23281553238630295, "per_doc_attn_latency": 0.025644724909216165, "num_seq_in_batch": 256, "seq_len": 256, "num_heads": 64, "head_dim": 128, "cp": 8, "tp": 8, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"7": {"per_seq_latency": 1.4866448402404786, "per_doc_latency": 35.071051025390624, "perseq_allgather_time": 0.8608911901712417, "perseq_attn_time": 0.6188575983047485, "perdoc_allgather_time": 30.03889102935791, "perdoc_attn_time": 5.024062371253967, "output_shape": [8192, 64, 128]}, "0": {"per_seq_latency": 1.2556544303894044, "per_doc_latency": 35.59600830078125, "perseq_allgather_time": 0.5967824012041092, "perseq_attn_time": 0.625134402513504, "perdoc_allgather_time": 30.08657102584839, "perdoc_attn_time": 5.495771217346191, "output_shape": [8192, 64, 128]}, "2": {"per_seq_latency": 1.4862128257751466, "per_doc_latency": 34.919253540039065, "perseq_allgather_time": 0.8647008061408996, "perseq_attn_time": 0.6144015967845917, "perdoc_allgather_time": 29.571454429626463, "perdoc_attn_time": 5.33896484375, "output_shape": [8192, 64, 128]}, "6": {"per_seq_latency": 1.4861599922180175, "per_doc_latency": 35.22091369628906, "perseq_allgather_time": 0.8530096054077149, "perseq_attn_time": 0.6264080047607422, "perdoc_allgather_time": 30.09089756011963, "perdoc_attn_time": 5.121609616279602, "output_shape": [8192, 64, 128]}, "1": {"per_seq_latency": 1.4862431526184081, "per_doc_latency": 34.972348022460935, "perseq_allgather_time": 0.8734784007072449, "perseq_attn_time": 0.6057792007923126, "perdoc_allgather_time": 29.459856033325195, "perdoc_attn_time": 5.504521584510803, "output_shape": [8192, 64, 128]}, "4": {"per_seq_latency": 1.4847200393676758, "per_doc_latency": 35.145074462890626, "perseq_allgather_time": 0.8723759979009629, "perseq_attn_time": 0.6055808037519455, "perdoc_allgather_time": 29.80306396484375, "perdoc_attn_time": 5.332692790031433, "output_shape": [8192, 64, 128]}, "5": {"per_seq_latency": 1.4849056243896483, "per_doc_latency": 35.512637329101565, "perseq_allgather_time": 0.8691231936216355, "perseq_attn_time": 0.6089344054460526, "perdoc_allgather_time": 30.335032176971435, "perdoc_attn_time": 5.170124840736389, "output_shape": [8192, 64, 128]}, "3": {"per_seq_latency": 1.485540771484375, "per_doc_latency": 34.907354736328124, "perseq_allgather_time": 0.8625839978456498, "perseq_attn_time": 0.6157903999090195, "perdoc_allgather_time": 29.741414546966553, "perdoc_attn_time": 5.157960033416748, "output_shape": [8192, 64, 128]}, "per_seq_latency": 0.011614412814378739, "per_doc_latency": 0.2780938148498535, "per_seq_allgather_latency": 0.006824050005525351, "per_seq_attn_latency": 0.0048938125371932985, "per_doc_allgather_latency": 0.23699243888258933, "per_doc_attn_latency": 0.04300407487899065, "num_seq_in_batch": 128, "seq_len": 512, "num_heads": 64, "head_dim": 128, "cp": 8, "tp": 1, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"7": {"per_seq_latency": 1.1449376106262208, "per_doc_latency": 33.713070678710935, "perseq_allgather_time": 0.7519840002059937, "perseq_attn_time": 0.38198399990797044, "perdoc_allgather_time": 30.20806255340576, "perdoc_attn_time": 3.498136019706726, "output_shape": [8192, 32, 128]}, "0": {"per_seq_latency": 0.8876015663146972, "per_doc_latency": 33.940371704101565, "perseq_allgather_time": 0.4392415970563889, "perseq_attn_time": 0.40259040147066116, "perdoc_allgather_time": 29.88562078475952, "perdoc_attn_time": 3.99557603597641, "output_shape": [8192, 32, 128]}, "6": {"per_seq_latency": 1.1446335792541504, "per_doc_latency": 33.602352905273435, "perseq_allgather_time": 0.7452575922012329, "perseq_attn_time": 0.390801602602005, "perdoc_allgather_time": 29.078049755096437, "perdoc_attn_time": 4.513119959831238, "output_shape": [8192, 32, 128]}, "1": {"per_seq_latency": 1.1451007843017578, "per_doc_latency": 33.597625732421875, "perseq_allgather_time": 0.7594384014606476, "perseq_attn_time": 0.37665440142154694, "perdoc_allgather_time": 29.038347244262695, "perdoc_attn_time": 4.5484415769577025, "output_shape": [8192, 32, 128]}, "5": {"per_seq_latency": 1.1450511932373046, "per_doc_latency": 33.671636962890624, "perseq_allgather_time": 0.7653168022632599, "perseq_attn_time": 0.37298719882965087, "perdoc_allgather_time": 29.783376026153565, "perdoc_attn_time": 3.880188834667206, "output_shape": [8192, 32, 128]}, "3": {"per_seq_latency": 1.1451871871948243, "per_doc_latency": 34.348757934570315, "perseq_allgather_time": 0.7327488020062447, "perseq_attn_time": 0.4010943979024887, "perdoc_allgather_time": 29.63378095626831, "perdoc_attn_time": 4.703169584274292, "output_shape": [8192, 32, 128]}, "2": {"per_seq_latency": 1.1452336311340332, "per_doc_latency": 33.154547119140624, "perseq_allgather_time": 0.7469472020864487, "perseq_attn_time": 0.3803919985890388, "perdoc_allgather_time": 29.134833526611327, "perdoc_attn_time": 4.009884774684906, "output_shape": [8192, 32, 128]}, "4": {"per_seq_latency": 1.1450816154479981, "per_doc_latency": 33.533511352539065, "perseq_allgather_time": 0.7658752009272576, "perseq_attn_time": 0.37247679829597474, "perdoc_allgather_time": 29.025595569610594, "perdoc_attn_time": 4.4975823879241945, "output_shape": [8192, 32, 128]}, "per_seq_latency": 0.008947137743234634, "per_doc_latency": 0.2683496713638306, "per_seq_allgather_latency": 0.0059834000072442, "per_seq_attn_latency": 0.0031452375114895403, "per_doc_allgather_latency": 0.2360004886984825, "per_doc_attn_latency": 0.036743512377142906, "num_seq_in_batch": 128, "seq_len": 512, "num_heads": 64, "head_dim": 128, "cp": 8, "tp": 2, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 0.7914576053619384, "per_doc_latency": 33.230615234375, "perseq_allgather_time": 0.38987360894680023, "perseq_attn_time": 0.3122160017490387, "perdoc_allgather_time": 29.391190338134766, "perdoc_attn_time": 3.704076826572418, "output_shape": [8192, 16, 128]}, "7": {"per_seq_latency": 1.0919520378112793, "per_doc_latency": 33.318389892578125, "perseq_allgather_time": 0.7764400094747543, "perseq_attn_time": 0.26571040153503417, "perdoc_allgather_time": 29.374267196655275, "perdoc_attn_time": 3.8856335997581484, "output_shape": [8192, 16, 128]}, "5": {"per_seq_latency": 1.091539192199707, "per_doc_latency": 32.96502685546875, "perseq_allgather_time": 0.7874623939394951, "perseq_attn_time": 0.26034080013632777, "perdoc_allgather_time": 29.02770233154297, "perdoc_attn_time": 3.8954415798187254, "output_shape": [8192, 16, 128]}, "4": {"per_seq_latency": 1.1002703666687013, "per_doc_latency": 32.628726196289065, "perseq_allgather_time": 0.7640671983361245, "perseq_attn_time": 0.282284801453352, "perdoc_allgather_time": 29.043337440490724, "perdoc_attn_time": 3.558467209339142, "output_shape": [8192, 16, 128]}, "2": {"per_seq_latency": 1.0910719871520995, "per_doc_latency": 32.678125, "perseq_allgather_time": 0.7423472002148628, "perseq_attn_time": 0.2936383992433548, "perdoc_allgather_time": 28.704420852661134, "perdoc_attn_time": 3.9428655982017515, "output_shape": [8192, 16, 128]}, "1": {"per_seq_latency": 1.0926272392272949, "per_doc_latency": 33.35708923339844, "perseq_allgather_time": 0.7433264091610908, "perseq_attn_time": 0.29171519801020623, "perdoc_allgather_time": 29.333183765411377, "perdoc_attn_time": 3.9713120222091676, "output_shape": [8192, 16, 128]}, "3": {"per_seq_latency": 1.0944463729858398, "per_doc_latency": 32.642181396484375, "perseq_allgather_time": 0.7947920128703118, "perseq_attn_time": 0.2570528000593185, "perdoc_allgather_time": 28.657102584838867, "perdoc_attn_time": 3.944851207733154, "output_shape": [8192, 16, 128]}, "6": {"per_seq_latency": 1.0931407928466796, "per_doc_latency": 33.48761901855469, "perseq_allgather_time": 0.7766207829117775, "perseq_attn_time": 0.26950719878077506, "perdoc_allgather_time": 29.502524757385252, "perdoc_attn_time": 3.922000002861023, "output_shape": [8192, 16, 128]}, "per_seq_latency": 0.008595862239599229, "per_doc_latency": 0.2616220235824585, "per_seq_allgather_latency": 0.006209312600549311, "per_seq_attn_latency": 0.0024391875136643647, "per_doc_allgather_latency": 0.23048847466707229, "per_doc_attn_latency": 0.03102587517350912, "num_seq_in_batch": 128, "seq_len": 512, "num_heads": 64, "head_dim": 128, "cp": 8, "tp": 4, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"7": {"per_seq_latency": 0.9833375930786132, "per_doc_latency": 31.767703247070312, "perseq_allgather_time": 0.681224012374878, "perseq_attn_time": 0.21261759847402573, "perdoc_allgather_time": 28.13447198867798, "perdoc_attn_time": 3.4773136019706725, "output_shape": [8192, 8, 128]}, "0": {"per_seq_latency": 0.7764463901519776, "per_doc_latency": 33.10295715332031, "perseq_allgather_time": 0.3847375988960266, "perseq_attn_time": 0.25432799831032754, "perdoc_allgather_time": 29.295115184783935, "perdoc_attn_time": 3.5906639814376833, "output_shape": [8192, 8, 128]}, "3": {"per_seq_latency": 0.9833647727966308, "per_doc_latency": 32.42052307128906, "perseq_allgather_time": 0.6856399893760681, "perseq_attn_time": 0.21045919880270958, "perdoc_allgather_time": 28.746894454956056, "perdoc_attn_time": 3.529916822910309, "output_shape": [8192, 8, 128]}, "6": {"per_seq_latency": 0.9876895904541015, "per_doc_latency": 31.903036499023436, "perseq_allgather_time": 0.6580896094441414, "perseq_attn_time": 0.23364959955215453, "perdoc_allgather_time": 28.199591827392577, "perdoc_attn_time": 3.4967648148536683, "output_shape": [8192, 8, 128]}, "2": {"per_seq_latency": 0.986184024810791, "per_doc_latency": 31.6485107421875, "perseq_allgather_time": 0.6771664127707482, "perseq_attn_time": 0.21471680030226709, "perdoc_allgather_time": 28.00001745223999, "perdoc_attn_time": 3.526728022098541, "output_shape": [8192, 8, 128]}, "1": {"per_seq_latency": 0.9834192276000977, "per_doc_latency": 32.121054077148436, "perseq_allgather_time": 0.6556544005870819, "perseq_attn_time": 0.22940800040960313, "perdoc_allgather_time": 28.48807849884033, "perdoc_attn_time": 3.528774380683899, "output_shape": [8192, 8, 128]}, "4": {"per_seq_latency": 0.9831952095031739, "per_doc_latency": 31.922390747070313, "perseq_allgather_time": 0.6688672006130219, "perseq_attn_time": 0.22085760161280632, "perdoc_allgather_time": 29.140558528900147, "perdoc_attn_time": 2.661260795593262, "output_shape": [8192, 8, 128]}, "5": {"per_seq_latency": 0.9828240394592285, "per_doc_latency": 32.25516357421875, "perseq_allgather_time": 0.6827311933040618, "perseq_attn_time": 0.21117120012640953, "perdoc_allgather_time": 28.595670700073242, "perdoc_attn_time": 3.5110016226768495, "output_shape": [8192, 8, 128]}, "per_seq_latency": 0.007716324925422668, "per_doc_latency": 0.25861685276031493, "per_seq_allgather_latency": 0.005356562417000532, "per_seq_attn_latency": 0.001986937486799434, "per_doc_allgather_latency": 0.2288680873811245, "per_doc_attn_latency": 0.0280520623549819, "num_seq_in_batch": 128, "seq_len": 512, "num_heads": 64, "head_dim": 128, "cp": 8, "tp": 8, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 1.4359295845031739, "per_doc_latency": 21.431202697753907, "perseq_allgather_time": 0.6349887937307358, "perseq_attn_time": 0.7817823976278305, "perdoc_allgather_time": 17.064366388320924, "perdoc_attn_time": 4.359680008888245, "output_shape": [8192, 64, 128]}, "7": {"per_seq_latency": 1.660041618347168, "per_doc_latency": 21.481451416015624, "perseq_allgather_time": 0.8634447991847992, "perseq_attn_time": 0.7898624062538147, "perdoc_allgather_time": 17.49212336540222, "perdoc_attn_time": 3.9827216029167176, "output_shape": [8192, 64, 128]}, "3": {"per_seq_latency": 1.6591104507446288, "per_doc_latency": 21.488804626464844, "perseq_allgather_time": 0.8667871981859208, "perseq_attn_time": 0.7850784003734589, "perdoc_allgather_time": 17.30996952056885, "perdoc_attn_time": 4.171624040603637, "output_shape": [8192, 64, 128]}, "2": {"per_seq_latency": 1.6586368560791016, "per_doc_latency": 21.523365783691407, "perseq_allgather_time": 0.8638016015291214, "perseq_attn_time": 0.7876176059246063, "perdoc_allgather_time": 17.29306564331055, "perdoc_attn_time": 4.223112034797668, "output_shape": [8192, 64, 128]}, "4": {"per_seq_latency": 1.6588943481445313, "per_doc_latency": 21.504971313476563, "perseq_allgather_time": 0.8508912056684494, "perseq_attn_time": 0.7990112006664276, "perdoc_allgather_time": 17.385508918762206, "perdoc_attn_time": 4.112795209884643, "output_shape": [8192, 64, 128]}, "1": {"per_seq_latency": 1.6590047836303712, "per_doc_latency": 21.487657165527345, "perseq_allgather_time": 0.8425455838441849, "perseq_attn_time": 0.8091792076826095, "perdoc_allgather_time": 17.20091986656189, "perdoc_attn_time": 4.279510402679444, "output_shape": [8192, 64, 128]}, "6": {"per_seq_latency": 1.6606592178344726, "per_doc_latency": 21.629566955566407, "perseq_allgather_time": 0.8652208179235459, "perseq_attn_time": 0.7887600004673004, "perdoc_allgather_time": 17.607404804229738, "perdoc_attn_time": 4.015468776226044, "output_shape": [8192, 64, 128]}, "5": {"per_seq_latency": 1.6600175857543946, "per_doc_latency": 21.350164794921874, "perseq_allgather_time": 0.8721103996038437, "perseq_attn_time": 0.7812095999717712, "perdoc_allgather_time": 17.21554880142212, "perdoc_attn_time": 4.127921628952026, "output_shape": [8192, 64, 128]}, "per_seq_latency": 0.025947800278663634, "per_doc_latency": 0.3379619836807251, "per_seq_allgather_latency": 0.013626724993810058, "per_seq_attn_latency": 0.012643425120040774, "per_doc_allgather_latency": 0.27511570006608965, "per_doc_attn_latency": 0.06812000013887883, "num_seq_in_batch": 64, "seq_len": 1024, "num_heads": 64, "head_dim": 128, "cp": 8, "tp": 1, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"7": {"per_seq_latency": 1.1869935989379883, "per_doc_latency": 19.485877990722656, "perseq_allgather_time": 0.7025648057460785, "perseq_attn_time": 0.47771520018577573, "perdoc_allgather_time": 16.88177146911621, "perdoc_attn_time": 2.5966143727302553, "output_shape": [8192, 32, 128]}, "0": {"per_seq_latency": 0.9806783676147461, "per_doc_latency": 19.539030456542967, "perseq_allgather_time": 0.46308480352163317, "perseq_attn_time": 0.48737759590148927, "perdoc_allgather_time": 16.76296172142029, "perdoc_attn_time": 2.744825577735901, "output_shape": [8192, 32, 128]}, "6": {"per_seq_latency": 1.1869071960449218, "per_doc_latency": 19.900987243652345, "perseq_allgather_time": 0.6926127880811691, "perseq_attn_time": 0.4861199989914894, "perdoc_allgather_time": 17.17372307777405, "perdoc_attn_time": 2.719041574001312, "output_shape": [8192, 32, 128]}, "4": {"per_seq_latency": 1.1864560127258301, "per_doc_latency": 19.399668884277343, "perseq_allgather_time": 0.687307195365429, "perseq_attn_time": 0.490388797223568, "perdoc_allgather_time": 16.744705724716187, "perdoc_attn_time": 2.6466880321502684, "output_shape": [8192, 32, 128]}, "1": {"per_seq_latency": 1.1864272117614747, "per_doc_latency": 19.554713439941406, "perseq_allgather_time": 0.6823840007185936, "perseq_attn_time": 0.4944432005286217, "perdoc_allgather_time": 16.815177488327027, "perdoc_attn_time": 2.718767988681793, "output_shape": [8192, 32, 128]}, "2": {"per_seq_latency": 1.1869359970092774, "per_doc_latency": 19.408416748046875, "perseq_allgather_time": 0.7000495970249176, "perseq_attn_time": 0.479851196706295, "perdoc_allgather_time": 16.692847967147827, "perdoc_attn_time": 2.707744002342224, "output_shape": [8192, 32, 128]}, "3": {"per_seq_latency": 1.1869024276733398, "per_doc_latency": 19.608973693847656, "perseq_allgather_time": 0.6602896094322205, "perseq_attn_time": 0.48018079847097395, "perdoc_allgather_time": 16.981742429733277, "perdoc_attn_time": 2.6201728105545046, "output_shape": [8192, 32, 128]}, "5": {"per_seq_latency": 1.1867535591125489, "per_doc_latency": 19.48656005859375, "perseq_allgather_time": 0.6894415900111198, "perseq_attn_time": 0.4895791977643967, "perdoc_allgather_time": 16.88719038963318, "perdoc_attn_time": 2.5925536155700684, "output_shape": [8192, 32, 128]}, "per_seq_latency": 0.018546774983406067, "per_doc_latency": 0.3109529256820679, "per_seq_allgather_latency": 0.010977575089782476, "per_seq_attn_latency": 0.007725675008259714, "per_doc_allgather_latency": 0.2683394230902195, "per_doc_attn_latency": 0.04288789965212345, "num_seq_in_batch": 64, "seq_len": 1024, "num_heads": 64, "head_dim": 128, "cp": 8, "tp": 2, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 0.8612303733825684, "per_doc_latency": 18.217044067382812, "perseq_allgather_time": 0.4732063993811607, "perseq_attn_time": 0.3524959996342659, "perdoc_allgather_time": 15.836112117767334, "perdoc_attn_time": 2.3295488238334654, "output_shape": [8192, 16, 128]}, "7": {"per_seq_latency": 1.1202768325805663, "per_doc_latency": 18.213777160644533, "perseq_allgather_time": 0.7611328095197678, "perseq_attn_time": 0.33844479769468305, "perdoc_allgather_time": 15.952350282669068, "perdoc_attn_time": 2.2343600034713744, "output_shape": [8192, 16, 128]}, "4": {"per_seq_latency": 1.1174256324768066, "per_doc_latency": 18.228126525878906, "perseq_allgather_time": 0.7673408031463623, "perseq_attn_time": 0.33050559312105177, "perdoc_allgather_time": 16.03554711341858, "perdoc_attn_time": 2.162028807401657, "output_shape": [8192, 16, 128]}, "5": {"per_seq_latency": 1.124852752685547, "per_doc_latency": 18.148129272460938, "perseq_allgather_time": 0.7661071881651879, "perseq_attn_time": 0.33684160113334655, "perdoc_allgather_time": 15.784135866165162, "perdoc_attn_time": 2.3416287899017334, "output_shape": [8192, 16, 128]}, "2": {"per_seq_latency": 1.1189552307128907, "per_doc_latency": 18.100169372558593, "perseq_allgather_time": 0.7672479972243309, "perseq_attn_time": 0.3289696007966995, "perdoc_allgather_time": 15.853476858139038, "perdoc_attn_time": 2.2388143956661226, "output_shape": [8192, 16, 128]}, "1": {"per_seq_latency": 1.1194191932678224, "per_doc_latency": 18.151995849609374, "perseq_allgather_time": 0.7706223800778389, "perseq_attn_time": 0.32957439720630644, "perdoc_allgather_time": 15.787785625457763, "perdoc_attn_time": 2.3445663928985594, "output_shape": [8192, 16, 128]}, "3": {"per_seq_latency": 1.1173775672912598, "per_doc_latency": 17.96864013671875, "perseq_allgather_time": 0.7693952098488808, "perseq_attn_time": 0.3262319967150688, "perdoc_allgather_time": 15.594267272949219, "perdoc_attn_time": 2.361299204826355, "output_shape": [8192, 16, 128]}, "6": {"per_seq_latency": 1.120894432067871, "per_doc_latency": 17.888328552246094, "perseq_allgather_time": 0.7207120046019554, "perseq_attn_time": 0.3617664039134979, "perdoc_allgather_time": 15.57783522605896, "perdoc_attn_time": 2.295425605773926, "output_shape": [8192, 16, 128]}, "per_seq_latency": 0.01757582426071167, "per_doc_latency": 0.2848144769668579, "per_seq_allgather_latency": 0.012040974688716233, "per_seq_attn_latency": 0.005652600061148405, "per_doc_allgather_latency": 0.2505554236471653, "per_doc_attn_latency": 0.036895300075411794, "num_seq_in_batch": 64, "seq_len": 1024, "num_heads": 64, "head_dim": 128, "cp": 8, "tp": 4, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 0.7813151836395263, "per_doc_latency": 18.705360412597656, "perseq_allgather_time": 0.39625599682331086, "perseq_attn_time": 0.26641279757022857, "perdoc_allgather_time": 16.446919775009157, "perdoc_attn_time": 2.12119197845459, "output_shape": [8192, 8, 128]}, "7": {"per_seq_latency": 1.009663963317871, "per_doc_latency": 18.044273376464844, "perseq_allgather_time": 0.7085663944482803, "perseq_attn_time": 0.23012800067663192, "perdoc_allgather_time": 15.987116861343384, "perdoc_attn_time": 1.9307503879070282, "output_shape": [8192, 8, 128]}, "4": {"per_seq_latency": 1.0091456413269042, "per_doc_latency": 18.19611511230469, "perseq_allgather_time": 0.6886208072304726, "perseq_attn_time": 0.24228159859776496, "perdoc_allgather_time": 16.22182869911194, "perdoc_attn_time": 1.8656031847000123, "output_shape": [8192, 8, 128]}, "5": {"per_seq_latency": 1.009347152709961, "per_doc_latency": 18.16077880859375, "perseq_allgather_time": 0.6568575903773308, "perseq_attn_time": 0.26365440115332606, "perdoc_allgather_time": 15.987854480743408, "perdoc_attn_time": 2.0517055869102476, "output_shape": [8192, 8, 128]}, "1": {"per_seq_latency": 1.0100048065185547, "per_doc_latency": 18.280194091796876, "perseq_allgather_time": 0.6970080137252808, "perseq_attn_time": 0.23775359839200974, "perdoc_allgather_time": 16.096833515167237, "perdoc_attn_time": 2.0930895805358887, "output_shape": [8192, 8, 128]}, "3": {"per_seq_latency": 1.0160752296447755, "per_doc_latency": 18.799539184570314, "perseq_allgather_time": 0.6447519928216934, "perseq_attn_time": 0.27572639659047127, "perdoc_allgather_time": 16.637268781661987, "perdoc_attn_time": 2.058747208118439, "output_shape": [8192, 8, 128]}, "6": {"per_seq_latency": 1.010153579711914, "per_doc_latency": 18.084889221191407, "perseq_allgather_time": 0.6875663980841636, "perseq_attn_time": 0.24493920356035231, "perdoc_allgather_time": 15.977640008926391, "perdoc_attn_time": 1.9805791914463042, "output_shape": [8192, 8, 128]}, "2": {"per_seq_latency": 1.0090800285339356, "per_doc_latency": 18.278140258789062, "perseq_allgather_time": 0.6833119928836823, "perseq_attn_time": 0.24602400064468383, "perdoc_allgather_time": 16.08292636871338, "perdoc_attn_time": 2.084414374828339, "output_shape": [8192, 8, 128]}, "per_seq_latency": 0.015876175463199617, "per_doc_latency": 0.29374279975891116, "per_seq_allgather_latency": 0.01107134991325438, "per_seq_attn_latency": 0.0043082249467261136, "per_doc_allgather_latency": 0.25995732471346855, "per_doc_attn_latency": 0.033143624663352966, "num_seq_in_batch": 64, "seq_len": 1024, "num_heads": 64, "head_dim": 128, "cp": 8, "tp": 8, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 1.7732479095458984, "per_doc_latency": 13.313990783691406, "perseq_allgather_time": 0.5827311962842942, "perseq_attn_time": 1.175822389125824, "perdoc_allgather_time": 9.334904050827026, "perdoc_attn_time": 3.9720383882522583, "output_shape": [8192, 64, 128]}, "7": {"per_seq_latency": 1.9835391998291017, "per_doc_latency": 13.313555908203124, "perseq_allgather_time": 0.8076976060867309, "perseq_attn_time": 1.1690831899642944, "perdoc_allgather_time": 9.636444854736329, "perdoc_attn_time": 3.670342409610748, "output_shape": [8192, 64, 128]}, "5": {"per_seq_latency": 1.9842063903808593, "per_doc_latency": 13.3091064453125, "perseq_allgather_time": 0.8009296119213104, "perseq_attn_time": 1.1765967965126038, "perdoc_allgather_time": 9.60687026977539, "perdoc_attn_time": 3.6954848051071165, "output_shape": [8192, 64, 128]}, "2": {"per_seq_latency": 1.9836944580078124, "per_doc_latency": 13.316917419433594, "perseq_allgather_time": 0.797956794500351, "perseq_attn_time": 1.1785263955593108, "perdoc_allgather_time": 9.461015987396241, "perdoc_attn_time": 3.848795199394226, "output_shape": [8192, 64, 128]}, "3": {"per_seq_latency": 1.9840768814086913, "per_doc_latency": 13.312174987792968, "perseq_allgather_time": 0.8009696006774902, "perseq_attn_time": 1.1760064005851745, "perdoc_allgather_time": 9.503107261657714, "perdoc_attn_time": 3.8019904017448427, "output_shape": [8192, 64, 128]}, "4": {"per_seq_latency": 1.9847856521606446, "per_doc_latency": 13.308757019042968, "perseq_allgather_time": 0.7960303843021392, "perseq_attn_time": 1.18195042014122, "perdoc_allgather_time": 9.551062297821044, "perdoc_attn_time": 3.750825583934784, "output_shape": [8192, 64, 128]}, "1": {"per_seq_latency": 1.9859424591064454, "per_doc_latency": 13.31457061767578, "perseq_allgather_time": 0.8075008004903793, "perseq_attn_time": 1.1713392078876494, "perdoc_allgather_time": 9.408313512802124, "perdoc_attn_time": 3.8990991830825807, "output_shape": [8192, 64, 128]}, "6": {"per_seq_latency": 1.984511947631836, "per_doc_latency": 13.309956359863282, "perseq_allgather_time": 0.8050560086965561, "perseq_attn_time": 1.1726143896579742, "perdoc_allgather_time": 9.591387176513672, "perdoc_attn_time": 3.7117680072784425, "output_shape": [8192, 64, 128]}, "per_seq_latency": 0.06206070184707642, "per_doc_latency": 0.4161536693572998, "per_seq_allgather_latency": 0.02524055019021034, "per_seq_attn_latency": 0.03693595062941313, "per_doc_allgather_latency": 0.3011389017105103, "per_doc_attn_latency": 0.12412619963288307, "num_seq_in_batch": 32, "seq_len": 2048, "num_heads": 64, "head_dim": 128, "cp": 8, "tp": 1, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 1.1541296005249024, "per_doc_latency": 9.692750549316406, "perseq_allgather_time": 0.40618400275707245, "perseq_attn_time": 0.7193199902772903, "perdoc_allgather_time": 7.399854421615601, "perdoc_attn_time": 2.2809759974479675, "output_shape": [8192, 32, 128]}, "7": {"per_seq_latency": 1.3793536186218263, "per_doc_latency": 9.639920043945313, "perseq_allgather_time": 0.6578400045633316, "perseq_attn_time": 0.7136063992977142, "perdoc_allgather_time": 7.5399264097213745, "perdoc_attn_time": 2.0931648135185243, "output_shape": [8192, 32, 128]}, "4": {"per_seq_latency": 1.3790399551391601, "per_doc_latency": 9.573091125488281, "perseq_allgather_time": 0.6763792142271996, "perseq_attn_time": 0.6958783984184265, "perdoc_allgather_time": 7.39389443397522, "perdoc_attn_time": 2.1718640089035035, "output_shape": [8192, 32, 128]}, "2": {"per_seq_latency": 1.379035186767578, "per_doc_latency": 9.66921157836914, "perseq_allgather_time": 0.6697391927242279, "perseq_attn_time": 0.7013663947582245, "perdoc_allgather_time": 7.444993591308593, "perdoc_attn_time": 2.2170719861984254, "output_shape": [8192, 32, 128]}, "5": {"per_seq_latency": 1.380729579925537, "per_doc_latency": 9.6309326171875, "perseq_allgather_time": 0.6580671966075897, "perseq_attn_time": 0.7129520058631897, "perdoc_allgather_time": 7.498916840553283, "perdoc_attn_time": 2.1251936078071596, "output_shape": [8192, 32, 128]}, "3": {"per_seq_latency": 1.379646396636963, "per_doc_latency": 9.602365112304687, "perseq_allgather_time": 0.6740960031747818, "perseq_attn_time": 0.6984495967626572, "perdoc_allgather_time": 7.352175998687744, "perdoc_attn_time": 2.2430767893791197, "output_shape": [8192, 32, 128]}, "6": {"per_seq_latency": 1.3796112060546875, "per_doc_latency": 9.620137786865234, "perseq_allgather_time": 0.6693232104182243, "perseq_attn_time": 0.7029920041561126, "perdoc_allgather_time": 7.513768029212952, "perdoc_attn_time": 2.0996224164962767, "output_shape": [8192, 32, 128]}, "1": {"per_seq_latency": 1.379475212097168, "per_doc_latency": 9.558968353271485, "perseq_allgather_time": 0.6723248049616813, "perseq_attn_time": 0.7000288039445877, "perdoc_allgather_time": 7.324830436706543, "perdoc_attn_time": 2.226979160308838, "output_shape": [8192, 32, 128]}, "per_seq_latency": 0.04314779937267303, "per_doc_latency": 0.3028984546661377, "per_seq_allgather_latency": 0.021136850444599987, "per_seq_attn_latency": 0.022478749696165323, "per_doc_allgather_latency": 0.23562270030379295, "per_doc_attn_latency": 0.07128049992024899, "num_seq_in_batch": 32, "seq_len": 2048, "num_heads": 64, "head_dim": 128, "cp": 8, "tp": 2, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"7": {"per_seq_latency": 1.1048751831054688, "per_doc_latency": 8.4934814453125, "perseq_allgather_time": 0.6289343908429146, "perseq_attn_time": 0.4684016019105911, "perdoc_allgather_time": 7.050452780723572, "perdoc_attn_time": 1.4167519986629487, "output_shape": [8192, 16, 128]}, "0": {"per_seq_latency": 0.8902704238891601, "per_doc_latency": 8.63977279663086, "perseq_allgather_time": 0.32969280034303666, "perseq_attn_time": 0.517163197696209, "perdoc_allgather_time": 7.08927845954895, "perdoc_attn_time": 1.52010880112648, "output_shape": [8192, 16, 128]}, "3": {"per_seq_latency": 1.1046751976013183, "per_doc_latency": 8.397332763671875, "perseq_allgather_time": 0.6085103906691074, "perseq_attn_time": 0.4843280017375946, "perdoc_allgather_time": 6.947887969017029, "perdoc_attn_time": 1.440304011106491, "output_shape": [8192, 16, 128]}, "4": {"per_seq_latency": 1.1046655654907227, "per_doc_latency": 8.50964126586914, "perseq_allgather_time": 0.641358396410942, "perseq_attn_time": 0.4566223993897438, "perdoc_allgather_time": 7.0938063859939575, "perdoc_attn_time": 1.4053232073783875, "output_shape": [8192, 16, 128]}, "5": {"per_seq_latency": 1.112452793121338, "per_doc_latency": 8.58249282836914, "perseq_allgather_time": 0.615731206536293, "perseq_attn_time": 0.4844992011785507, "perdoc_allgather_time": 7.122646403312683, "perdoc_attn_time": 1.4440671980381012, "output_shape": [8192, 16, 128]}, "2": {"per_seq_latency": 1.104047966003418, "per_doc_latency": 8.635523223876953, "perseq_allgather_time": 0.5970320053398609, "perseq_attn_time": 0.49339199513196946, "perdoc_allgather_time": 7.149860811233521, "perdoc_attn_time": 1.475107192993164, "output_shape": [8192, 16, 128]}, "6": {"per_seq_latency": 1.1042112350463866, "per_doc_latency": 8.543608093261719, "perseq_allgather_time": 0.6315584108233452, "perseq_attn_time": 0.46330719739198684, "perdoc_allgather_time": 7.093503928184509, "perdoc_attn_time": 1.4337472081184388, "output_shape": [8192, 16, 128]}, "1": {"per_seq_latency": 1.1043935775756837, "per_doc_latency": 8.45080337524414, "perseq_allgather_time": 0.6377360120415687, "perseq_attn_time": 0.4594976007938385, "perdoc_allgather_time": 6.9397104501724245, "perdoc_attn_time": 1.4894304037094117, "output_shape": [8192, 16, 128]}, "per_seq_latency": 0.03476414978504181, "per_doc_latency": 0.26999289989471437, "per_seq_allgather_latency": 0.02004244988784194, "per_seq_attn_latency": 0.01616134992800653, "per_doc_allgather_latency": 0.22343315035104752, "per_doc_attn_latency": 0.0475034000352025, "num_seq_in_batch": 32, "seq_len": 2048, "num_heads": 64, "head_dim": 128, "cp": 8, "tp": 4, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 0.7739568233489991, "per_doc_latency": 8.213471984863281, "perseq_allgather_time": 0.36177600026130674, "perseq_attn_time": 0.3563248008489609, "perdoc_allgather_time": 6.802494382858276, "perdoc_attn_time": 1.3298896074295044, "output_shape": [8192, 8, 128]}, "7": {"per_seq_latency": 1.0053407669067382, "per_doc_latency": 8.152079772949218, "perseq_allgather_time": 0.6553712129592896, "perseq_attn_time": 0.330862395465374, "perdoc_allgather_time": 6.803705620765686, "perdoc_attn_time": 1.250776007771492, "output_shape": [8192, 8, 128]}, "2": {"per_seq_latency": 1.0050607681274415, "per_doc_latency": 8.151665496826173, "perseq_allgather_time": 0.6372111976146698, "perseq_attn_time": 0.33569439947605134, "perdoc_allgather_time": 6.843068838119507, "perdoc_attn_time": 1.2466815888881684, "output_shape": [8192, 8, 128]}, "1": {"per_seq_latency": 1.0274415969848634, "per_doc_latency": 8.194937896728515, "perseq_allgather_time": 0.6315039932727814, "perseq_attn_time": 0.3596592009067535, "perdoc_allgather_time": 7.128628849983215, "perdoc_attn_time": 1.0094512045383452, "output_shape": [8192, 8, 128]}, "5": {"per_seq_latency": 1.0048111915588378, "per_doc_latency": 8.240601348876954, "perseq_allgather_time": 0.6194383949041367, "perseq_attn_time": 0.3534160017967224, "perdoc_allgather_time": 6.856436777114868, "perdoc_attn_time": 1.2981856048107148, "output_shape": [8192, 8, 128]}, "3": {"per_seq_latency": 1.0043904304504394, "per_doc_latency": 8.243977355957032, "perseq_allgather_time": 0.6392496138811111, "perseq_attn_time": 0.3368239998817444, "perdoc_allgather_time": 6.830020833015442, "perdoc_attn_time": 1.32425919175148, "output_shape": [8192, 8, 128]}, "6": {"per_seq_latency": 1.0049599647521972, "per_doc_latency": 8.211140441894532, "perseq_allgather_time": 0.6402559906244278, "perseq_attn_time": 0.3343567982316017, "perdoc_allgather_time": 6.841796827316284, "perdoc_attn_time": 1.2812911987304687, "output_shape": [8192, 8, 128]}, "4": {"per_seq_latency": 1.0050592422485352, "per_doc_latency": 8.131515502929688, "perseq_allgather_time": 0.6698095917701721, "perseq_attn_time": 0.3159248039126396, "perdoc_allgather_time": 6.765787243843079, "perdoc_attn_time": 1.2885263979434967, "output_shape": [8192, 8, 128]}, "per_seq_latency": 0.03210754990577698, "per_doc_latency": 0.25762429237365725, "per_seq_allgather_latency": 0.020931549742817877, "per_seq_attn_latency": 0.011239350028336047, "per_doc_allgather_latency": 0.22276965156197548, "per_doc_attn_latency": 0.04155905023217201, "num_seq_in_batch": 32, "seq_len": 2048, "num_heads": 64, "head_dim": 128, "cp": 8, "tp": 8, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"7": {"per_seq_latency": 2.819822311401367, "per_doc_latency": 13.594789123535156, "perseq_allgather_time": 0.841811203956604, "perseq_attn_time": 1.971065604686737, "perdoc_allgather_time": 9.26522707939148, "perdoc_attn_time": 4.322731137275696, "output_shape": [8192, 64, 128]}, "0": {"per_seq_latency": 2.624769592285156, "per_doc_latency": 13.594850158691406, "perseq_allgather_time": 0.6407984077930451, "perseq_attn_time": 1.9694559931755067, "perdoc_allgather_time": 9.16712818145752, "perdoc_attn_time": 4.420564770698547, "output_shape": [8192, 64, 128]}, "5": {"per_seq_latency": 2.8209823608398437, "per_doc_latency": 13.597625732421875, "perseq_allgather_time": 0.8358080059289932, "perseq_attn_time": 1.9782383859157562, "perdoc_allgather_time": 9.291676759719849, "perdoc_attn_time": 4.299129629135132, "output_shape": [8192, 64, 128]}, "3": {"per_seq_latency": 2.818516731262207, "per_doc_latency": 13.59717254638672, "perseq_allgather_time": 0.8150928050279618, "perseq_attn_time": 1.9961647927761077, "perdoc_allgather_time": 9.258036804199218, "perdoc_attn_time": 4.331958365440369, "output_shape": [8192, 64, 128]}, "6": {"per_seq_latency": 2.81918888092041, "per_doc_latency": 13.595852661132813, "perseq_allgather_time": 0.8648911863565445, "perseq_attn_time": 1.9475903928279876, "perdoc_allgather_time": 9.261124753952027, "perdoc_attn_time": 4.327913618087768, "output_shape": [8192, 64, 128]}, "2": {"per_seq_latency": 2.8183311462402343, "per_doc_latency": 13.59740753173828, "perseq_allgather_time": 0.7926927894353867, "perseq_attn_time": 2.018364804983139, "perdoc_allgather_time": 9.262329483032227, "perdoc_attn_time": 4.327905607223511, "output_shape": [8192, 64, 128]}, "1": {"per_seq_latency": 2.8208879470825194, "per_doc_latency": 13.595257568359376, "perseq_allgather_time": 0.8558080166578292, "perseq_attn_time": 1.95796799659729, "perdoc_allgather_time": 9.243031978607178, "perdoc_attn_time": 4.345209646224975, "output_shape": [8192, 64, 128]}, "4": {"per_seq_latency": 2.8196592330932617, "per_doc_latency": 13.596891784667969, "perseq_allgather_time": 0.8654000043869019, "perseq_attn_time": 1.94757279753685, "perdoc_allgather_time": 9.277140903472901, "perdoc_attn_time": 4.313041615486145, "output_shape": [8192, 64, 128]}, "per_seq_latency": 0.17631139755249023, "per_doc_latency": 0.8498516082763672, "per_seq_allgather_latency": 0.05408750027418137, "per_seq_attn_latency": 0.12614780031144618, "per_doc_allgather_latency": 0.5807297974824905, "per_doc_attn_latency": 0.2762852981686592, "num_seq_in_batch": 16, "seq_len": 4096, "num_heads": 64, "head_dim": 128, "cp": 8, "tp": 1, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 1.5574224472045899, "per_doc_latency": 7.310774230957032, "perseq_allgather_time": 0.37902719974517823, "perseq_attn_time": 1.1598143935203553, "perdoc_allgather_time": 4.873967981338501, "perdoc_attn_time": 2.4219696283340455, "output_shape": [8192, 32, 128]}, "7": {"per_seq_latency": 1.8018896102905273, "per_doc_latency": 7.313929748535156, "perseq_allgather_time": 0.6315472051501274, "perseq_attn_time": 1.1627295911312103, "perdoc_allgather_time": 5.028468823432922, "perdoc_attn_time": 2.2787087678909304, "output_shape": [8192, 32, 128]}, "5": {"per_seq_latency": 1.8030927658081055, "per_doc_latency": 7.314158630371094, "perseq_allgather_time": 0.631883193552494, "perseq_attn_time": 1.164406406879425, "perdoc_allgather_time": 5.064092779159546, "perdoc_attn_time": 2.2433055877685546, "output_shape": [8192, 32, 128]}, "6": {"per_seq_latency": 1.801046371459961, "per_doc_latency": 7.313587188720703, "perseq_allgather_time": 0.6456543922424316, "perseq_attn_time": 1.148659199476242, "perdoc_allgather_time": 5.061334347724914, "perdoc_attn_time": 2.245574390888214, "output_shape": [8192, 32, 128]}, "1": {"per_seq_latency": 1.8015424728393554, "per_doc_latency": 7.315789031982422, "perseq_allgather_time": 0.6595712006092072, "perseq_attn_time": 1.134790402650833, "perdoc_allgather_time": 4.961616015434265, "perdoc_attn_time": 2.347108805179596, "output_shape": [8192, 32, 128]}, "2": {"per_seq_latency": 1.805476760864258, "per_doc_latency": 7.317192077636719, "perseq_allgather_time": 0.6481263995170593, "perseq_attn_time": 1.1501312017440797, "perdoc_allgather_time": 5.0077552318573, "perdoc_attn_time": 2.302256000041962, "output_shape": [8192, 32, 128]}, "3": {"per_seq_latency": 1.803331184387207, "per_doc_latency": 7.316366577148438, "perseq_allgather_time": 0.6354799851775169, "perseq_attn_time": 1.1607231974601746, "perdoc_allgather_time": 5.044054388999939, "perdoc_attn_time": 2.265223968029022, "output_shape": [8192, 32, 128]}, "4": {"per_seq_latency": 1.8025999069213867, "per_doc_latency": 7.315609741210937, "perseq_allgather_time": 0.6531119927763939, "perseq_attn_time": 1.1426752090454102, "perdoc_allgather_time": 5.056003165245056, "perdoc_attn_time": 2.252782392501831, "output_shape": [8192, 32, 128]}, "per_seq_latency": 0.11284229755401612, "per_doc_latency": 0.4573245048522949, "per_seq_allgather_latency": 0.04122320003807545, "per_seq_attn_latency": 0.07277540042996407, "per_doc_allgather_latency": 0.31650579869747164, "per_doc_attn_latency": 0.15137310177087784, "num_seq_in_batch": 16, "seq_len": 4096, "num_heads": 64, "head_dim": 128, "cp": 8, "tp": 2, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"7": {"per_seq_latency": 1.319491195678711, "per_doc_latency": 6.5988914489746096, "perseq_allgather_time": 0.5839343927800655, "perseq_attn_time": 0.7286368042230607, "perdoc_allgather_time": 5.361463928222657, "perdoc_attn_time": 1.2306304097175598, "output_shape": [8192, 16, 128]}, "0": {"per_seq_latency": 1.030777645111084, "per_doc_latency": 6.657855987548828, "perseq_allgather_time": 0.28114560171961783, "perseq_attn_time": 0.7359648019075393, "perdoc_allgather_time": 5.230276823043823, "perdoc_attn_time": 1.4065311908721925, "output_shape": [8192, 16, 128]}, "4": {"per_seq_latency": 1.3187935829162598, "per_doc_latency": 6.619471740722656, "perseq_allgather_time": 0.5784015983343125, "perseq_attn_time": 0.7335439950227738, "perdoc_allgather_time": 5.304409587383271, "perdoc_attn_time": 1.307504004240036, "output_shape": [8192, 16, 128]}, "6": {"per_seq_latency": 1.3204560279846191, "per_doc_latency": 6.663893127441407, "perseq_allgather_time": 0.5629119887948036, "perseq_attn_time": 0.7505375981330872, "perdoc_allgather_time": 5.363070380687714, "perdoc_attn_time": 1.2940656125545502, "output_shape": [8192, 16, 128]}, "1": {"per_seq_latency": 1.3203840255737305, "per_doc_latency": 6.64306869506836, "perseq_allgather_time": 0.5884608037769794, "perseq_attn_time": 0.7246847927570343, "perdoc_allgather_time": 5.228947246074677, "perdoc_attn_time": 1.407038402557373, "output_shape": [8192, 16, 128]}, "2": {"per_seq_latency": 1.3208352088928224, "per_doc_latency": 6.602339172363282, "perseq_allgather_time": 0.5744943954050541, "perseq_attn_time": 0.7391200006008148, "perdoc_allgather_time": 5.259120047092438, "perdoc_attn_time": 1.336222392320633, "output_shape": [8192, 16, 128]}, "3": {"per_seq_latency": 1.3202095985412599, "per_doc_latency": 6.620990753173828, "perseq_allgather_time": 0.5538144089281559, "perseq_attn_time": 0.7552448004484177, "perdoc_allgather_time": 5.263831961154938, "perdoc_attn_time": 1.3499135971069336, "output_shape": [8192, 16, 128]}, "5": {"per_seq_latency": 1.3211135864257812, "per_doc_latency": 6.513925170898437, "perseq_allgather_time": 0.5776943936944008, "perseq_attn_time": 0.736025607585907, "perdoc_allgather_time": 5.220911979675293, "perdoc_attn_time": 1.275414389371872, "output_shape": [8192, 16, 128]}, "per_seq_latency": 0.08256959915161133, "per_doc_latency": 0.4164933204650879, "per_seq_allgather_latency": 0.03677880023606121, "per_seq_attn_latency": 0.047202800028026105, "per_doc_allgather_latency": 0.3351918987929821, "per_doc_attn_latency": 0.08793990015983581, "num_seq_in_batch": 16, "seq_len": 4096, "num_heads": 64, "head_dim": 128, "cp": 8, "tp": 4, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 0.9339664459228516, "per_doc_latency": 4.835895919799805, "perseq_allgather_time": 0.35532959923148155, "perseq_attn_time": 0.5410975947976112, "perdoc_allgather_time": 3.8133935928344727, "perdoc_attn_time": 0.9979039937257767, "output_shape": [8192, 8, 128]}, "7": {"per_seq_latency": 1.1691184043884277, "per_doc_latency": 4.840480041503906, "perseq_allgather_time": 0.654004792124033, "perseq_attn_time": 0.5081983998417854, "perdoc_allgather_time": 3.928772759437561, "perdoc_attn_time": 0.869420799612999, "output_shape": [8192, 8, 128]}, "5": {"per_seq_latency": 1.1673616409301757, "per_doc_latency": 4.8031982421875, "perseq_allgather_time": 0.6123072095215321, "perseq_attn_time": 0.5436783984303475, "perdoc_allgather_time": 3.940819203853607, "perdoc_attn_time": 0.8468111991882324, "output_shape": [8192, 8, 128]}, "6": {"per_seq_latency": 1.168387222290039, "per_doc_latency": 4.797129440307617, "perseq_allgather_time": 0.6057088047266006, "perseq_attn_time": 0.540324792265892, "perdoc_allgather_time": 3.8772943735122682, "perdoc_attn_time": 0.8919711947441101, "output_shape": [8192, 8, 128]}, "1": {"per_seq_latency": 1.1890144348144531, "per_doc_latency": 4.855392074584961, "perseq_allgather_time": 0.6521135896444321, "perseq_attn_time": 0.5286208003759384, "perdoc_allgather_time": 3.928150403499603, "perdoc_attn_time": 0.9161312043666839, "output_shape": [8192, 8, 128]}, "3": {"per_seq_latency": 1.170569610595703, "per_doc_latency": 4.801374435424805, "perseq_allgather_time": 0.6483743987977505, "perseq_attn_time": 0.5136304035782814, "perdoc_allgather_time": 3.896233630180359, "perdoc_attn_time": 0.8939935982227325, "output_shape": [8192, 8, 128]}, "4": {"per_seq_latency": 1.170257568359375, "per_doc_latency": 4.863905715942383, "perseq_allgather_time": 0.6423584088683129, "perseq_attn_time": 0.5193392008543014, "perdoc_allgather_time": 3.9161359906196593, "perdoc_attn_time": 0.9273119986057281, "output_shape": [8192, 8, 128]}, "2": {"per_seq_latency": 1.170414352416992, "per_doc_latency": 4.867580795288086, "perseq_allgather_time": 0.6266240008175373, "perseq_attn_time": 0.5342207953333855, "perdoc_allgather_time": 3.9431615829467774, "perdoc_attn_time": 0.9100783973932266, "output_shape": [8192, 8, 128]}, "per_seq_latency": 0.07431340217590332, "per_doc_latency": 0.3042237997055054, "per_seq_allgather_latency": 0.04087529950775206, "per_seq_attn_latency": 0.03397989990189672, "per_doc_allgather_latency": 0.2464475989341736, "per_doc_attn_latency": 0.06236899960786104, "num_seq_in_batch": 16, "seq_len": 4096, "num_heads": 64, "head_dim": 128, "cp": 8, "tp": 8, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 4.01685905456543, "per_doc_latency": 14.926747131347657, "perseq_allgather_time": 0.6116911977529526, "perseq_attn_time": 3.3912192225456237, "perdoc_allgather_time": 9.167569589614867, "perdoc_attn_time": 5.7519471645355225, "output_shape": [8192, 64, 128]}, "7": {"per_seq_latency": 4.16889762878418, "per_doc_latency": 14.926521301269531, "perseq_allgather_time": 0.7840303987264633, "perseq_attn_time": 3.3781856298446655, "perdoc_allgather_time": 9.158806371688843, "perdoc_attn_time": 5.761009573936462, "output_shape": [8192, 64, 128]}, "4": {"per_seq_latency": 4.168936157226563, "per_doc_latency": 14.924082946777343, "perseq_allgather_time": 0.7662271976470947, "perseq_attn_time": 3.396025598049164, "perdoc_allgather_time": 9.214135980606079, "perdoc_attn_time": 5.703294396400452, "output_shape": [8192, 64, 128]}, "2": {"per_seq_latency": 4.166633605957031, "per_doc_latency": 14.929620361328125, "perseq_allgather_time": 0.7395231932401657, "perseq_attn_time": 3.4198816061019897, "perdoc_allgather_time": 9.165196704864503, "perdoc_attn_time": 5.757228851318359, "output_shape": [8192, 64, 128]}, "1": {"per_seq_latency": 4.168913650512695, "per_doc_latency": 14.929756164550781, "perseq_allgather_time": 0.7486784070730209, "perseq_attn_time": 3.4131023645401, "perdoc_allgather_time": 9.161838340759278, "perdoc_attn_time": 5.760707211494446, "output_shape": [8192, 64, 128]}, "3": {"per_seq_latency": 4.169803237915039, "per_doc_latency": 14.9226806640625, "perseq_allgather_time": 0.7564528048038482, "perseq_attn_time": 3.4060959815979004, "perdoc_allgather_time": 9.194038438796998, "perdoc_attn_time": 5.721454358100891, "output_shape": [8192, 64, 128]}, "6": {"per_seq_latency": 4.171691131591797, "per_doc_latency": 14.918629455566407, "perseq_allgather_time": 0.7331488013267518, "perseq_attn_time": 3.4317999720573424, "perdoc_allgather_time": 9.14841914176941, "perdoc_attn_time": 5.763440036773682, "output_shape": [8192, 64, 128]}, "5": {"per_seq_latency": 4.170843124389648, "per_doc_latency": 14.92431182861328, "perseq_allgather_time": 0.7754464030265809, "perseq_attn_time": 3.388540804386139, "perdoc_allgather_time": 9.210244846343993, "perdoc_attn_time": 5.7072944164276125, "output_shape": [8192, 64, 128]}, "per_seq_latency": 0.5214613914489746, "per_doc_latency": 1.8662195205688477, "per_seq_allgather_latency": 0.09800379984080791, "per_seq_attn_latency": 0.4289749965071678, "per_doc_allgather_latency": 1.1517669975757598, "per_doc_attn_latency": 0.7204300045967102, "num_seq_in_batch": 8, "seq_len": 8192, "num_heads": 64, "head_dim": 128, "cp": 8, "tp": 1, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 2.3125247955322266, "per_doc_latency": 7.728923034667969, "perseq_allgather_time": 0.3714639976620674, "perseq_attn_time": 1.926903986930847, "perdoc_allgather_time": 4.698462390899659, "perdoc_attn_time": 3.0233360052108766, "output_shape": [8192, 32, 128]}, "7": {"per_seq_latency": 2.5075376510620115, "per_doc_latency": 7.728358459472656, "perseq_allgather_time": 0.5801215976476669, "perseq_attn_time": 1.9206480026245116, "perdoc_allgather_time": 4.726310396194458, "perdoc_attn_time": 2.995289611816406, "output_shape": [8192, 32, 128]}, "3": {"per_seq_latency": 2.503492736816406, "per_doc_latency": 7.727648162841797, "perseq_allgather_time": 0.5666543960571289, "perseq_attn_time": 1.9295471847057342, "perdoc_allgather_time": 4.708094334602356, "perdoc_attn_time": 3.0123775959014893, "output_shape": [8192, 32, 128]}, "4": {"per_seq_latency": 2.5033039093017577, "per_doc_latency": 7.7262451171875, "perseq_allgather_time": 0.5991727963089943, "perseq_attn_time": 1.8972671985626222, "perdoc_allgather_time": 4.766625642776489, "perdoc_attn_time": 2.9529775738716126, "output_shape": [8192, 32, 128]}, "5": {"per_seq_latency": 2.504417610168457, "per_doc_latency": 7.728702545166016, "perseq_allgather_time": 0.5674095943570137, "perseq_attn_time": 1.9301231980323792, "perdoc_allgather_time": 4.757278347015381, "perdoc_attn_time": 2.9645391941070556, "output_shape": [8192, 32, 128]}, "6": {"per_seq_latency": 2.5030399322509767, "per_doc_latency": 7.729646301269531, "perseq_allgather_time": 0.5799663931131362, "perseq_attn_time": 1.916312003135681, "perdoc_allgather_time": 4.726719999313355, "perdoc_attn_time": 2.996073603630066, "output_shape": [8192, 32, 128]}, "1": {"per_seq_latency": 2.503518486022949, "per_doc_latency": 7.72778091430664, "perseq_allgather_time": 0.5998464077711105, "perseq_attn_time": 1.8966415882110597, "perdoc_allgather_time": 4.726128053665161, "perdoc_attn_time": 2.9946159720420837, "output_shape": [8192, 32, 128]}, "2": {"per_seq_latency": 2.503411293029785, "per_doc_latency": 7.7284400939941404, "perseq_allgather_time": 0.5929599925875664, "perseq_attn_time": 1.9032592117786407, "perdoc_allgather_time": 4.725921583175659, "perdoc_attn_time": 2.995305573940277, "output_shape": [8192, 32, 128]}, "per_seq_latency": 0.31344220638275144, "per_doc_latency": 0.9662057876586914, "per_seq_allgather_latency": 0.07498080097138882, "per_seq_attn_latency": 0.2412653997540474, "per_doc_allgather_latency": 0.5958282053470612, "per_doc_attn_latency": 0.3779170006513596, "num_seq_in_batch": 8, "seq_len": 8192, "num_heads": 64, "head_dim": 128, "cp": 8, "tp": 2, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 1.440060806274414, "per_doc_latency": 4.30963363647461, "perseq_allgather_time": 0.26734239757061007, "perseq_attn_time": 1.157828801870346, "perdoc_allgather_time": 2.6289680123329164, "perdoc_attn_time": 1.6651888072490693, "output_shape": [8192, 16, 128]}, "7": {"per_seq_latency": 1.6656303405761719, "per_doc_latency": 4.3191486358642575, "perseq_allgather_time": 0.5180991925299168, "perseq_attn_time": 1.140809601545334, "perdoc_allgather_time": 2.7058815956115723, "perdoc_attn_time": 1.6065599918365479, "output_shape": [8192, 16, 128]}, "1": {"per_seq_latency": 1.6762704849243164, "per_doc_latency": 4.318286514282226, "perseq_allgather_time": 0.5072031952440739, "perseq_attn_time": 1.160257601737976, "perdoc_allgather_time": 2.706232023239136, "perdoc_attn_time": 1.6049808084964752, "output_shape": [8192, 16, 128]}, "2": {"per_seq_latency": 1.6766063690185546, "per_doc_latency": 4.318328094482422, "perseq_allgather_time": 0.5288400009274483, "perseq_attn_time": 1.140590387582779, "perdoc_allgather_time": 2.725704002380371, "perdoc_attn_time": 1.5854607939720153, "output_shape": [8192, 16, 128]}, "3": {"per_seq_latency": 1.6829120635986328, "per_doc_latency": 4.318726348876953, "perseq_allgather_time": 0.5204544052481651, "perseq_attn_time": 1.1538128077983856, "perdoc_allgather_time": 2.7109391927719115, "perdoc_attn_time": 1.6005407929420472, "output_shape": [8192, 16, 128]}, "6": {"per_seq_latency": 1.6786432266235352, "per_doc_latency": 4.3182624816894535, "perseq_allgather_time": 0.5185503929853439, "perseq_attn_time": 1.1531984090805054, "perdoc_allgather_time": 2.671769607067108, "perdoc_attn_time": 1.6397231996059418, "output_shape": [8192, 16, 128]}, "4": {"per_seq_latency": 1.6784095764160156, "per_doc_latency": 4.317790222167969, "perseq_allgather_time": 0.5398288130760193, "perseq_attn_time": 1.1318431973457337, "perdoc_allgather_time": 2.7201104044914244, "perdoc_attn_time": 1.5909488022327423, "output_shape": [8192, 16, 128]}, "5": {"per_seq_latency": 1.6809743881225585, "per_doc_latency": 4.318929672241211, "perseq_allgather_time": 0.5165936015546322, "perseq_attn_time": 1.1565648019313812, "perdoc_allgather_time": 2.7146767735481263, "perdoc_attn_time": 1.597404807806015, "output_shape": [8192, 16, 128]}, "per_seq_latency": 0.2103640079498291, "per_doc_latency": 0.5398935794830322, "per_seq_allgather_latency": 0.06747860163450241, "per_seq_attn_latency": 0.145032200217247, "per_doc_allgather_latency": 0.34071300029754636, "per_doc_attn_latency": 0.20814860090613366, "num_seq_in_batch": 8, "seq_len": 8192, "num_heads": 64, "head_dim": 128, "cp": 8, "tp": 4, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"7": {"per_seq_latency": 1.4491392135620118, "per_doc_latency": 3.3089950561523436, "perseq_allgather_time": 0.6756607994437218, "perseq_attn_time": 0.7236512005329132, "perdoc_allgather_time": 2.3849407911300657, "perdoc_attn_time": 0.9046288013458252, "output_shape": [8192, 8, 128]}, "0": {"per_seq_latency": 1.2190688133239747, "per_doc_latency": 3.2442222595214845, "perseq_allgather_time": 0.47909439727663994, "perseq_attn_time": 0.7165360003709793, "perdoc_allgather_time": 2.253152000904083, "perdoc_attn_time": 0.969564801454544, "output_shape": [8192, 8, 128]}, "2": {"per_seq_latency": 1.4473376274108887, "per_doc_latency": 3.264556884765625, "perseq_allgather_time": 0.7420768134295941, "perseq_attn_time": 0.6971583992242814, "perdoc_allgather_time": 2.333201563358307, "perdoc_attn_time": 0.9241375923156738, "output_shape": [8192, 8, 128]}, "3": {"per_seq_latency": 1.4483152389526368, "per_doc_latency": 3.259552001953125, "perseq_allgather_time": 0.6658111974596977, "perseq_attn_time": 0.7509824007749557, "perdoc_allgather_time": 2.351873588562012, "perdoc_attn_time": 0.9006256014108658, "output_shape": [8192, 8, 128]}, "5": {"per_seq_latency": 1.4576944351196288, "per_doc_latency": 3.2503120422363283, "perseq_allgather_time": 0.7006575912237167, "perseq_attn_time": 0.7366496026515961, "perdoc_allgather_time": 2.3451583981513977, "perdoc_attn_time": 0.8969184041023255, "output_shape": [8192, 8, 128]}, "1": {"per_seq_latency": 1.4472720146179199, "per_doc_latency": 3.229564666748047, "perseq_allgather_time": 0.700704000890255, "perseq_attn_time": 0.7300368010997772, "perdoc_allgather_time": 2.2853936076164247, "perdoc_attn_time": 0.9370655983686447, "output_shape": [8192, 8, 128]}, "4": {"per_seq_latency": 1.4468704223632813, "per_doc_latency": 3.2745838165283203, "perseq_allgather_time": 0.7522592127323151, "perseq_attn_time": 0.6878576010465622, "perdoc_allgather_time": 2.396062397956848, "perdoc_attn_time": 0.8717328011989594, "output_shape": [8192, 8, 128]}, "6": {"per_seq_latency": 1.4490320205688476, "per_doc_latency": 3.225724792480469, "perseq_allgather_time": 0.7394495896995068, "perseq_attn_time": 0.7019327998161315, "perdoc_allgather_time": 2.303623986244202, "perdoc_attn_time": 0.9017328023910522, "output_shape": [8192, 8, 128]}, "per_seq_latency": 0.1822118043899536, "per_doc_latency": 0.41362438201904295, "per_seq_allgather_latency": 0.09403240159153939, "per_seq_attn_latency": 0.09387280009686946, "per_doc_allgather_latency": 0.299507799744606, "per_doc_attn_latency": 0.121195600181818, "num_seq_in_batch": 8, "seq_len": 8192, "num_heads": 64, "head_dim": 128, "cp": 8, "tp": 8, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 7.067683410644531, "per_doc_latency": 17.85626983642578, "perseq_allgather_time": 0.7040256023406982, "perseq_attn_time": 6.356619167327881, "perdoc_allgather_time": 9.25270414352417, "perdoc_attn_time": 8.596571207046509, "output_shape": [8192, 64, 128]}, "7": {"per_seq_latency": 7.068856048583984, "per_doc_latency": 17.859909057617188, "perseq_allgather_time": 0.6612287998199463, "perseq_attn_time": 6.400796842575073, "perdoc_allgather_time": 9.21475510597229, "perdoc_attn_time": 8.638303995132446, "output_shape": [8192, 64, 128]}, "6": {"per_seq_latency": 7.074073791503906, "per_doc_latency": 17.847067260742186, "perseq_allgather_time": 0.7374336004257203, "perseq_attn_time": 6.329756784439087, "perdoc_allgather_time": 9.176823997497559, "perdoc_attn_time": 8.663425493240357, "output_shape": [8192, 64, 128]}, "4": {"per_seq_latency": 7.080248260498047, "per_doc_latency": 17.86248321533203, "perseq_allgather_time": 0.7151904016733169, "perseq_attn_time": 6.3583872556686405, "perdoc_allgather_time": 9.260342407226563, "perdoc_attn_time": 8.59537444114685, "output_shape": [8192, 64, 128]}, "3": {"per_seq_latency": 7.06982421875, "per_doc_latency": 17.865248107910155, "perseq_allgather_time": 0.7137295931577683, "perseq_attn_time": 6.348886442184448, "perdoc_allgather_time": 9.269460725784302, "perdoc_attn_time": 8.588647985458374, "output_shape": [8192, 64, 128]}, "5": {"per_seq_latency": 7.066150665283203, "per_doc_latency": 17.858155822753908, "perseq_allgather_time": 0.7145392000675201, "perseq_attn_time": 6.344747114181518, "perdoc_allgather_time": 9.26941113471985, "perdoc_attn_time": 8.581903982162476, "output_shape": [8192, 64, 128]}, "1": {"per_seq_latency": 7.0821388244628904, "per_doc_latency": 17.849153137207033, "perseq_allgather_time": 0.6751456052064896, "perseq_attn_time": 6.399964785575866, "perdoc_allgather_time": 9.136065578460693, "perdoc_attn_time": 8.706025648117066, "output_shape": [8192, 64, 128]}, "2": {"per_seq_latency": 7.071485137939453, "per_doc_latency": 17.85869903564453, "perseq_allgather_time": 0.6544800043106079, "perseq_attn_time": 6.409718370437622, "perdoc_allgather_time": 9.248408079147339, "perdoc_attn_time": 8.603139162063599, "output_shape": [8192, 64, 128]}, "per_seq_latency": 1.7705347061157226, "per_doc_latency": 4.466312026977539, "per_seq_allgather_latency": 0.18435840010643006, "per_seq_attn_latency": 1.6024295926094054, "per_doc_allgather_latency": 2.3173651814460756, "per_doc_attn_latency": 2.1765064120292665, "num_seq_in_batch": 4, "seq_len": 16384, "num_heads": 64, "head_dim": 128, "cp": 8, "tp": 1, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"7": {"per_seq_latency": 3.9189342498779296, "per_doc_latency": 9.151882934570313, "perseq_allgather_time": 0.5423119977116585, "perseq_attn_time": 3.3697871923446656, "perdoc_allgather_time": 4.672371220588684, "perdoc_attn_time": 4.472755217552185, "output_shape": [8192, 32, 128]}, "0": {"per_seq_latency": 3.808729553222656, "per_doc_latency": 9.149671936035157, "perseq_allgather_time": 0.4319120019674301, "perseq_attn_time": 3.365174412727356, "perdoc_allgather_time": 4.723697590827942, "perdoc_attn_time": 4.419008016586304, "output_shape": [8192, 32, 128]}, "1": {"per_seq_latency": 3.9171871185302733, "per_doc_latency": 9.151598358154297, "perseq_allgather_time": 0.5031343981623649, "perseq_attn_time": 3.4069199919700623, "perdoc_allgather_time": 4.733457565307617, "perdoc_attn_time": 4.411107182502747, "output_shape": [8192, 32, 128]}, "2": {"per_seq_latency": 3.917622375488281, "per_doc_latency": 9.149948883056641, "perseq_allgather_time": 0.507108798623085, "perseq_attn_time": 3.403313624858856, "perdoc_allgather_time": 4.663899183273315, "perdoc_attn_time": 4.47882559299469, "output_shape": [8192, 32, 128]}, "6": {"per_seq_latency": 3.9166831970214844, "per_doc_latency": 9.151643371582031, "perseq_allgather_time": 0.5104399979114532, "perseq_attn_time": 3.399515211582184, "perdoc_allgather_time": 4.679225564002991, "perdoc_attn_time": 4.46562077999115, "output_shape": [8192, 32, 128]}, "4": {"per_seq_latency": 3.919403076171875, "per_doc_latency": 9.153018951416016, "perseq_allgather_time": 0.5254960000514984, "perseq_attn_time": 3.38709762096405, "perdoc_allgather_time": 4.697107219696045, "perdoc_attn_time": 4.449142408370972, "output_shape": [8192, 32, 128]}, "3": {"per_seq_latency": 3.9198848724365236, "per_doc_latency": 9.155449676513673, "perseq_allgather_time": 0.5781759962439537, "perseq_attn_time": 3.334536004066467, "perdoc_allgather_time": 4.703974366188049, "perdoc_attn_time": 4.444375967979431, "output_shape": [8192, 32, 128]}, "5": {"per_seq_latency": 3.9146575927734375, "per_doc_latency": 9.153164672851563, "perseq_allgather_time": 0.472852797806263, "perseq_attn_time": 3.434984016418457, "perdoc_allgather_time": 4.705175995826721, "perdoc_attn_time": 4.44125759601593, "output_shape": [8192, 32, 128]}, "per_seq_latency": 0.9799712181091309, "per_doc_latency": 2.288862419128418, "per_seq_allgather_latency": 0.14454399906098842, "per_seq_attn_latency": 0.8587460041046142, "per_doc_allgather_latency": 1.1833643913269043, "per_doc_attn_latency": 1.1197063982486726, "num_seq_in_batch": 4, "seq_len": 16384, "num_heads": 64, "head_dim": 128, "cp": 8, "tp": 2, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 2.195404815673828, "per_doc_latency": 4.832273483276367, "perseq_allgather_time": 0.3197039969265461, "perseq_attn_time": 1.8643120110034943, "perdoc_allgather_time": 2.4802224040031433, "perdoc_attn_time": 2.3449664235115053, "output_shape": [8192, 16, 128]}, "7": {"per_seq_latency": 2.365230369567871, "per_doc_latency": 4.832783889770508, "perseq_allgather_time": 0.48657919839024544, "perseq_attn_time": 1.8719792008399962, "perdoc_allgather_time": 2.471492826938629, "perdoc_attn_time": 2.354571211338043, "output_shape": [8192, 16, 128]}, "3": {"per_seq_latency": 2.3650287628173827, "per_doc_latency": 4.833692932128907, "perseq_allgather_time": 0.48683679550886155, "perseq_attn_time": 1.8709984004497529, "perdoc_allgather_time": 2.4689919710159303, "perdoc_attn_time": 2.3573808073997498, "output_shape": [8192, 16, 128]}, "2": {"per_seq_latency": 2.3661855697631835, "per_doc_latency": 4.798551940917969, "perseq_allgather_time": 0.4268895976245403, "perseq_attn_time": 1.9318752050399781, "perdoc_allgather_time": 2.4757376074790955, "perdoc_attn_time": 2.3155888319015503, "output_shape": [8192, 16, 128]}, "6": {"per_seq_latency": 2.365657615661621, "per_doc_latency": 4.8418113708496096, "perseq_allgather_time": 0.4154752016067505, "perseq_attn_time": 1.9201135993003846, "perdoc_allgather_time": 2.5112752079963685, "perdoc_attn_time": 2.323867213726044, "output_shape": [8192, 16, 128]}, "1": {"per_seq_latency": 2.369935989379883, "per_doc_latency": 4.833953475952148, "perseq_allgather_time": 0.44248799830675123, "perseq_attn_time": 1.9201872050762177, "perdoc_allgather_time": 2.4891968250274656, "perdoc_attn_time": 2.3375360012054442, "output_shape": [8192, 16, 128]}, "5": {"per_seq_latency": 2.3646015167236327, "per_doc_latency": 4.834280014038086, "perseq_allgather_time": 0.441702401638031, "perseq_attn_time": 1.9161695957183837, "perdoc_allgather_time": 2.480673599243164, "perdoc_attn_time": 2.3469759941101076, "output_shape": [8192, 16, 128]}, "4": {"per_seq_latency": 2.3660959243774413, "per_doc_latency": 4.832966232299805, "perseq_allgather_time": 0.49987840577960013, "perseq_attn_time": 1.859420794248581, "perdoc_allgather_time": 2.51146559715271, "perdoc_attn_time": 2.314750385284424, "output_shape": [8192, 16, 128]}, "per_seq_latency": 0.5924839973449707, "per_doc_latency": 1.2104528427124024, "per_seq_allgather_latency": 0.12496960144490003, "per_seq_attn_latency": 0.48296880125999453, "per_doc_allgather_latency": 0.6278663992881774, "per_doc_attn_latency": 0.5893452018499374, "num_seq_in_batch": 4, "seq_len": 16384, "num_heads": 64, "head_dim": 128, "cp": 8, "tp": 4, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 1.4001824378967285, "per_doc_latency": 2.736612892150879, "perseq_allgather_time": 0.32347839921712873, "perseq_attn_time": 1.0621823966503143, "perdoc_allgather_time": 1.452644795179367, "perdoc_attn_time": 1.2716895818710328, "output_shape": [8192, 8, 128]}, "7": {"per_seq_latency": 1.6314640045166016, "per_doc_latency": 2.7642608642578126, "perseq_allgather_time": 0.5322368010878563, "perseq_attn_time": 1.0899376034736634, "perdoc_allgather_time": 1.44685440659523, "perdoc_attn_time": 1.3105023980140686, "output_shape": [8192, 8, 128]}, "4": {"per_seq_latency": 1.6304784774780274, "per_doc_latency": 2.773793601989746, "perseq_allgather_time": 0.5619407959282399, "perseq_attn_time": 1.0617055952548982, "perdoc_allgather_time": 1.5128608107566834, "perdoc_attn_time": 1.2541728019714355, "output_shape": [8192, 8, 128]}, "1": {"per_seq_latency": 1.6316703796386718, "per_doc_latency": 2.762745666503906, "perseq_allgather_time": 0.5614959977567195, "perseq_attn_time": 1.0632160127162933, "perdoc_allgather_time": 1.519622415304184, "perdoc_attn_time": 1.236167997121811, "output_shape": [8192, 8, 128]}, "3": {"per_seq_latency": 1.6341472625732423, "per_doc_latency": 2.759611129760742, "perseq_allgather_time": 0.499904003739357, "perseq_attn_time": 1.1184240102767944, "perdoc_allgather_time": 1.509387195110321, "perdoc_attn_time": 1.2429648041725159, "output_shape": [8192, 8, 128]}, "2": {"per_seq_latency": 1.630241584777832, "per_doc_latency": 2.7619375228881835, "perseq_allgather_time": 0.5555296130478382, "perseq_attn_time": 1.0669920086860656, "perdoc_allgather_time": 1.5138767957687378, "perdoc_attn_time": 1.240839993953705, "output_shape": [8192, 8, 128]}, "5": {"per_seq_latency": 1.6305984497070312, "per_doc_latency": 2.75296630859375, "perseq_allgather_time": 0.5652607932686806, "perseq_attn_time": 1.0584479928016663, "perdoc_allgather_time": 1.502897596359253, "perdoc_attn_time": 1.2433264017105103, "output_shape": [8192, 8, 128]}, "6": {"per_seq_latency": 1.630633544921875, "per_doc_latency": 2.793662452697754, "perseq_allgather_time": 0.5470912091434001, "perseq_attn_time": 1.0768127977848052, "perdoc_allgather_time": 1.5055216014385224, "perdoc_attn_time": 1.280268794298172, "output_shape": [8192, 8, 128]}, "per_seq_latency": 0.40853681564331057, "per_doc_latency": 0.6984156131744385, "per_seq_allgather_latency": 0.14131519831717015, "per_seq_attn_latency": 0.2796060025691986, "per_doc_allgather_latency": 0.379905603826046, "per_doc_attn_latency": 0.32762559950351716, "num_seq_in_batch": 4, "seq_len": 16384, "num_heads": 64, "head_dim": 128, "cp": 8, "tp": 8, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 12.933647155761719, "per_doc_latency": 23.772088623046876, "perseq_allgather_time": 0.8278000086545945, "perseq_attn_time": 12.098596715927124, "perdoc_allgather_time": 9.310094356536865, "perdoc_attn_time": 14.45481448173523, "output_shape": [8192, 64, 128]}, "7": {"per_seq_latency": 12.941770935058594, "per_doc_latency": 23.7680908203125, "perseq_allgather_time": 0.698755195736885, "perseq_attn_time": 12.236387252807617, "perdoc_allgather_time": 9.219332933425903, "perdoc_attn_time": 14.541976118087769, "output_shape": [8192, 64, 128]}, "4": {"per_seq_latency": 12.939820861816406, "per_doc_latency": 23.79564666748047, "perseq_allgather_time": 0.6176080048084259, "perseq_attn_time": 12.31543517112732, "perdoc_allgather_time": 9.331825542449952, "perdoc_attn_time": 14.456959962844849, "output_shape": [8192, 64, 128]}, "6": {"per_seq_latency": 12.954736328125, "per_doc_latency": 23.761260986328125, "perseq_allgather_time": 0.8889919966459274, "perseq_attn_time": 12.059057569503784, "perdoc_allgather_time": 9.317084884643554, "perdoc_attn_time": 14.437326383590698, "output_shape": [8192, 64, 128]}, "3": {"per_seq_latency": 12.949862670898437, "per_doc_latency": 23.770651245117186, "perseq_allgather_time": 0.8558335989713669, "perseq_attn_time": 12.086883163452148, "perdoc_allgather_time": 9.335438442230224, "perdoc_attn_time": 14.428088045120239, "output_shape": [8192, 64, 128]}, "5": {"per_seq_latency": 12.939566040039063, "per_doc_latency": 23.771322631835936, "perseq_allgather_time": 0.899617600440979, "perseq_attn_time": 12.03307523727417, "perdoc_allgather_time": 9.493604755401611, "perdoc_attn_time": 14.27079348564148, "output_shape": [8192, 64, 128]}, "1": {"per_seq_latency": 12.964892578125, "per_doc_latency": 23.751556396484375, "perseq_allgather_time": 0.8124352037906647, "perseq_attn_time": 12.145459175109863, "perdoc_allgather_time": 9.23852801322937, "perdoc_attn_time": 14.50604157447815, "output_shape": [8192, 64, 128]}, "2": {"per_seq_latency": 12.94361572265625, "per_doc_latency": 23.757472229003906, "perseq_allgather_time": 0.7011312007904053, "perseq_attn_time": 12.235185670852662, "perdoc_allgather_time": 9.26774878501892, "perdoc_attn_time": 14.48256320953369, "output_shape": [8192, 64, 128]}, "per_seq_latency": 6.4824462890625, "per_doc_latency": 11.897823333740234, "per_seq_allgather_latency": 0.4498088002204895, "per_seq_attn_latency": 6.15771758556366, "per_doc_allgather_latency": 4.7468023777008055, "per_doc_attn_latency": 7.2709880590438845, "num_seq_in_batch": 2, "seq_len": 32768, "num_heads": 64, "head_dim": 128, "cp": 8, "tp": 1, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 6.818428802490234, "per_doc_latency": 12.183502197265625, "perseq_allgather_time": 0.5369200065732003, "perseq_attn_time": 6.269630408287048, "perdoc_allgather_time": 4.84760479927063, "perdoc_attn_time": 7.3287663698196415, "output_shape": [8192, 32, 128]}, "7": {"per_seq_latency": 6.841646575927735, "per_doc_latency": 12.188329315185547, "perseq_allgather_time": 0.5715999960899353, "perseq_attn_time": 6.263387155532837, "perdoc_allgather_time": 4.699023962020874, "perdoc_attn_time": 7.482532811164856, "output_shape": [8192, 32, 128]}, "5": {"per_seq_latency": 6.83068618774414, "per_doc_latency": 12.179039764404298, "perseq_allgather_time": 0.5370480045676231, "perseq_attn_time": 6.286948823928833, "perdoc_allgather_time": 4.78124475479126, "perdoc_attn_time": 7.39113597869873, "output_shape": [8192, 32, 128]}, "3": {"per_seq_latency": 6.823790740966797, "per_doc_latency": 12.182113647460938, "perseq_allgather_time": 0.5078383967280388, "perseq_attn_time": 6.308799982070923, "perdoc_allgather_time": 4.7313679456710815, "perdoc_attn_time": 7.443563222885132, "output_shape": [8192, 32, 128]}, "1": {"per_seq_latency": 6.830579376220703, "per_doc_latency": 12.18243179321289, "perseq_allgather_time": 0.46343519538640976, "perseq_attn_time": 6.36003839969635, "perdoc_allgather_time": 4.690699243545533, "perdoc_attn_time": 7.48460156917572, "output_shape": [8192, 32, 128]}, "4": {"per_seq_latency": 6.833064270019531, "per_doc_latency": 12.172627258300782, "perseq_allgather_time": 0.4827568009495735, "perseq_attn_time": 6.34346878528595, "perdoc_allgather_time": 4.6988015413284305, "perdoc_attn_time": 7.466982436180115, "output_shape": [8192, 32, 128]}, "6": {"per_seq_latency": 6.828151702880859, "per_doc_latency": 12.182943725585938, "perseq_allgather_time": 0.4916687965393066, "perseq_attn_time": 6.329676818847656, "perdoc_allgather_time": 4.7159007549285885, "perdoc_attn_time": 7.460243201255798, "output_shape": [8192, 32, 128]}, "2": {"per_seq_latency": 6.827059173583985, "per_doc_latency": 12.181270599365234, "perseq_allgather_time": 0.37859519869089125, "perseq_attn_time": 6.441215991973877, "perdoc_allgather_time": 4.762287998199463, "perdoc_attn_time": 7.411879992485046, "output_shape": [8192, 32, 128]}, "per_seq_latency": 3.4208232879638674, "per_doc_latency": 6.094164657592773, "per_seq_allgather_latency": 0.28579999804496764, "per_seq_attn_latency": 3.2206079959869385, "per_doc_allgather_latency": 2.423802399635315, "per_doc_attn_latency": 3.74230078458786, "num_seq_in_batch": 2, "seq_len": 32768, "num_heads": 64, "head_dim": 128, "cp": 8, "tp": 2, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 3.6258270263671877, "per_doc_latency": 6.316304016113281, "perseq_allgather_time": 0.32201119884848595, "perseq_attn_time": 3.29124801158905, "perdoc_allgather_time": 2.4473088145256043, "perdoc_attn_time": 3.862004780769348, "output_shape": [8192, 16, 128]}, "7": {"per_seq_latency": 3.7316814422607423, "per_doc_latency": 6.3166961669921875, "perseq_allgather_time": 0.43150399550795554, "perseq_attn_time": 3.293248009681702, "perdoc_allgather_time": 2.4332096099853517, "perdoc_attn_time": 3.8766607999801637, "output_shape": [8192, 16, 128]}, "6": {"per_seq_latency": 3.73230094909668, "per_doc_latency": 6.323128128051758, "perseq_allgather_time": 0.3249104075133801, "perseq_attn_time": 3.40064799785614, "perdoc_allgather_time": 2.451759994029999, "perdoc_attn_time": 3.8646944403648376, "output_shape": [8192, 16, 128]}, "4": {"per_seq_latency": 3.7264209747314454, "per_doc_latency": 6.32918701171875, "perseq_allgather_time": 0.4005024045705795, "perseq_attn_time": 3.319112014770508, "perdoc_allgather_time": 2.489846408367157, "perdoc_attn_time": 3.832641613483429, "output_shape": [8192, 16, 128]}, "5": {"per_seq_latency": 3.7286094665527343, "per_doc_latency": 6.328657531738282, "perseq_allgather_time": 0.3508127950131893, "perseq_attn_time": 3.3709216117858887, "perdoc_allgather_time": 2.4692736148834227, "perdoc_attn_time": 3.852631986141205, "output_shape": [8192, 16, 128]}, "1": {"per_seq_latency": 3.7312145233154297, "per_doc_latency": 6.325382232666016, "perseq_allgather_time": 0.3761359915137291, "perseq_attn_time": 3.3479328036308287, "perdoc_allgather_time": 2.503596782684326, "perdoc_attn_time": 3.8146511912345886, "output_shape": [8192, 16, 128]}, "3": {"per_seq_latency": 3.7243473052978517, "per_doc_latency": 6.322326278686523, "perseq_allgather_time": 0.4074768029153347, "perseq_attn_time": 3.3096927762031556, "perdoc_allgather_time": 2.465115225315094, "perdoc_attn_time": 3.850220775604248, "output_shape": [8192, 16, 128]}, "2": {"per_seq_latency": 3.72532958984375, "per_doc_latency": 6.322739028930664, "perseq_allgather_time": 0.34312479496002196, "perseq_attn_time": 3.3751183986663817, "perdoc_allgather_time": 2.4327903985977173, "perdoc_attn_time": 3.8827247977256776, "output_shape": [8192, 16, 128]}, "per_seq_latency": 1.86615047454834, "per_doc_latency": 3.164593505859375, "per_seq_allgather_latency": 0.21575199775397777, "per_seq_attn_latency": 1.70032399892807, "per_doc_allgather_latency": 1.251798391342163, "per_doc_attn_latency": 1.9413623988628388, "num_seq_in_batch": 2, "seq_len": 32768, "num_heads": 64, "head_dim": 128, "cp": 8, "tp": 4, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"0": {"per_seq_latency": 2.1311792373657226, "per_doc_latency": 3.400172805786133, "perseq_allgather_time": 0.3352912001311779, "perseq_attn_time": 1.783375996351242, "perdoc_allgather_time": 1.3531728029251098, "perdoc_attn_time": 2.039859175682068, "output_shape": [8192, 8, 128]}, "7": {"per_seq_latency": 2.3423248291015626, "per_doc_latency": 3.3989471435546874, "perseq_allgather_time": 0.5039631970226764, "perseq_attn_time": 1.8237312138080597, "perdoc_allgather_time": 1.346919995546341, "perdoc_attn_time": 2.0449407935142516, "output_shape": [8192, 8, 128]}, "6": {"per_seq_latency": 2.340171241760254, "per_doc_latency": 3.397016143798828, "perseq_allgather_time": 0.518732787668705, "perseq_attn_time": 1.8137920022010803, "perdoc_allgather_time": 1.3812559902668, "perdoc_attn_time": 2.0090928077697754, "output_shape": [8192, 8, 128]}, "3": {"per_seq_latency": 2.3403039932250977, "per_doc_latency": 3.3960670471191405, "perseq_allgather_time": 0.5266207925975323, "perseq_attn_time": 1.8064895927906037, "perdoc_allgather_time": 1.347736006975174, "perdoc_attn_time": 2.04105281829834, "output_shape": [8192, 8, 128]}, "1": {"per_seq_latency": 2.3401391983032225, "per_doc_latency": 3.3976593017578125, "perseq_allgather_time": 0.5521823942661286, "perseq_attn_time": 1.780816000699997, "perdoc_allgather_time": 1.3683743894100189, "perdoc_attn_time": 2.022216039896011, "output_shape": [8192, 8, 128]}, "2": {"per_seq_latency": 2.340433692932129, "per_doc_latency": 3.398371124267578, "perseq_allgather_time": 0.5249775871634483, "perseq_attn_time": 1.8080927968025207, "perdoc_allgather_time": 1.326775997877121, "perdoc_attn_time": 2.0642239689826964, "output_shape": [8192, 8, 128]}, "5": {"per_seq_latency": 2.3400096893310547, "per_doc_latency": 3.3963039398193358, "perseq_allgather_time": 0.5395440079271794, "perseq_attn_time": 1.7935823857784272, "perdoc_allgather_time": 1.356388795375824, "perdoc_attn_time": 2.0332095861434936, "output_shape": [8192, 8, 128]}, "4": {"per_seq_latency": 2.3403968811035156, "per_doc_latency": 3.397073745727539, "perseq_allgather_time": 0.5260911926627159, "perseq_attn_time": 1.8065375983715057, "perdoc_allgather_time": 1.3724944114685058, "perdoc_attn_time": 2.0177743911743162, "output_shape": [8192, 8, 128]}, "per_seq_latency": 1.1711624145507813, "per_doc_latency": 1.7000864028930665, "per_seq_allgather_latency": 0.2760911971330643, "per_seq_attn_latency": 0.9118656069040298, "per_doc_allgather_latency": 0.6906279951334, "per_doc_attn_latency": 1.0321119844913482, "num_seq_in_batch": 2, "seq_len": 32768, "num_heads": 64, "head_dim": 128, "cp": 8, "tp": 8, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"7": {"per_seq_latency": 25.065153503417967, "per_doc_latency": 35.723367309570314, "perseq_allgather_time": 0.780080008506775, "perseq_attn_time": 24.278179454803468, "perdoc_allgather_time": 9.917969512939454, "perdoc_attn_time": 25.798670482635497, "output_shape": [8192, 64, 128]}, "0": {"per_seq_latency": 25.024256896972656, "per_doc_latency": 35.84630126953125, "perseq_allgather_time": 0.917808011174202, "perseq_attn_time": 24.09935369491577, "perdoc_allgather_time": 10.292137622833252, "perdoc_attn_time": 25.54702091217041, "output_shape": [8192, 64, 128]}, "6": {"per_seq_latency": 25.052224731445314, "per_doc_latency": 35.657894897460935, "perseq_allgather_time": 1.044100794196129, "perseq_attn_time": 24.001380825042723, "perdoc_allgather_time": 10.237012767791748, "perdoc_attn_time": 25.414174175262453, "output_shape": [8192, 64, 128]}, "4": {"per_seq_latency": 25.072547912597656, "per_doc_latency": 35.8354248046875, "perseq_allgather_time": 0.9046047985553741, "perseq_attn_time": 24.161200046539307, "perdoc_allgather_time": 10.047876834869385, "perdoc_attn_time": 25.780732917785645, "output_shape": [8192, 64, 128]}, "5": {"per_seq_latency": 25.033229064941406, "per_doc_latency": 35.77048034667969, "perseq_allgather_time": 1.1590800046920777, "perseq_attn_time": 23.867475318908692, "perdoc_allgather_time": 10.278660869598388, "perdoc_attn_time": 25.485089778900146, "output_shape": [8192, 64, 128]}, "1": {"per_seq_latency": 25.02654113769531, "per_doc_latency": 35.693624877929686, "perseq_allgather_time": 0.6748768031597138, "perseq_attn_time": 24.34464807510376, "perdoc_allgather_time": 9.835734367370605, "perdoc_attn_time": 25.85092191696167, "output_shape": [8192, 64, 128]}, "2": {"per_seq_latency": 25.04223175048828, "per_doc_latency": 35.758444213867186, "perseq_allgather_time": 0.8847792029380799, "perseq_attn_time": 24.15030403137207, "perdoc_allgather_time": 9.975681591033936, "perdoc_attn_time": 25.77554569244385, "output_shape": [8192, 64, 128]}, "3": {"per_seq_latency": 25.047544860839842, "per_doc_latency": 35.70594177246094, "perseq_allgather_time": 1.0860143929719925, "perseq_attn_time": 23.954331398010254, "perdoc_allgather_time": 10.20804467201233, "perdoc_attn_time": 25.490790367126465, "output_shape": [8192, 64, 128]}, "per_seq_latency": 25.072547912597656, "per_doc_latency": 35.84630126953125, "per_seq_allgather_latency": 1.1590800046920777, "per_seq_attn_latency": 24.34464807510376, "per_doc_allgather_latency": 10.292137622833252, "per_doc_attn_latency": 25.85092191696167, "num_seq_in_batch": 1, "seq_len": 65536, "num_heads": 64, "head_dim": 128, "cp": 8, "tp": 1, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"7": {"per_seq_latency": 12.748728179931641, "per_doc_latency": 18.23912353515625, "perseq_allgather_time": 0.4383696034550667, "perseq_attn_time": 12.303651142120362, "perdoc_allgather_time": 5.0979856014251705, "perdoc_attn_time": 13.134465646743774, "output_shape": [8192, 32, 128]}, "0": {"per_seq_latency": 12.760942077636718, "per_doc_latency": 18.21331329345703, "perseq_allgather_time": 0.7041904017329216, "perseq_attn_time": 12.049692678451539, "perdoc_allgather_time": 5.090103960037231, "perdoc_attn_time": 13.116089630126954, "output_shape": [8192, 32, 128]}, "5": {"per_seq_latency": 12.752278137207032, "per_doc_latency": 18.198745727539062, "perseq_allgather_time": 0.6879199981689453, "perseq_attn_time": 12.057599925994873, "perdoc_allgather_time": 5.341953587532044, "perdoc_attn_time": 12.850051116943359, "output_shape": [8192, 32, 128]}, "1": {"per_seq_latency": 12.774703979492188, "per_doc_latency": 18.23259735107422, "perseq_allgather_time": 0.481116795539856, "perseq_attn_time": 12.28635516166687, "perdoc_allgather_time": 5.130630397796631, "perdoc_attn_time": 13.094881629943847, "output_shape": [8192, 32, 128]}, "4": {"per_seq_latency": 12.756253051757813, "per_doc_latency": 18.225672912597656, "perseq_allgather_time": 0.5736063957214356, "perseq_attn_time": 12.175928020477295, "perdoc_allgather_time": 5.116217637062073, "perdoc_attn_time": 13.102571201324462, "output_shape": [8192, 32, 128]}, "3": {"per_seq_latency": 12.736790466308594, "per_doc_latency": 18.2011474609375, "perseq_allgather_time": 0.5117519974708558, "perseq_attn_time": 12.217705631256104, "perdoc_allgather_time": 5.28899359703064, "perdoc_attn_time": 12.904908895492554, "output_shape": [8192, 32, 128]}, "6": {"per_seq_latency": 12.758367919921875, "per_doc_latency": 18.19786682128906, "perseq_allgather_time": 0.7035631954669952, "perseq_attn_time": 12.048004817962646, "perdoc_allgather_time": 5.31485116481781, "perdoc_attn_time": 12.876319980621338, "output_shape": [8192, 32, 128]}, "2": {"per_seq_latency": 12.752397155761718, "per_doc_latency": 18.278826904296874, "perseq_allgather_time": 0.47515359669923785, "perseq_attn_time": 12.27005615234375, "perdoc_allgather_time": 5.077625560760498, "perdoc_attn_time": 13.194031906127929, "output_shape": [8192, 32, 128]}, "per_seq_latency": 12.774703979492188, "per_doc_latency": 18.278826904296874, "per_seq_allgather_latency": 0.7041904017329216, "per_seq_attn_latency": 12.303651142120362, "per_doc_allgather_latency": 5.341953587532044, "per_doc_attn_latency": 13.194031906127929, "num_seq_in_batch": 1, "seq_len": 65536, "num_heads": 64, "head_dim": 128, "cp": 8, "tp": 2, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"7": {"per_seq_latency": 6.6542816162109375, "per_doc_latency": 9.193888092041016, "perseq_allgather_time": 0.28757440075278284, "perseq_attn_time": 6.3598384141921995, "perdoc_allgather_time": 2.4573343873023985, "perdoc_attn_time": 6.729753589630127, "output_shape": [8192, 16, 128]}, "0": {"per_seq_latency": 6.653841400146485, "per_doc_latency": 9.191321563720702, "perseq_allgather_time": 0.35888800099492074, "perseq_attn_time": 6.282936000823975, "perdoc_allgather_time": 2.605766403675079, "perdoc_attn_time": 6.578574371337891, "output_shape": [8192, 16, 128]}, "5": {"per_seq_latency": 6.647020721435547, "per_doc_latency": 9.18335189819336, "perseq_allgather_time": 0.3684015989303589, "perseq_attn_time": 6.271903944015503, "perdoc_allgather_time": 2.526692795753479, "perdoc_attn_time": 6.649814438819885, "output_shape": [8192, 16, 128]}, "4": {"per_seq_latency": 6.643705749511719, "per_doc_latency": 9.170600128173827, "perseq_allgather_time": 0.27361439988017083, "perseq_attn_time": 6.36330885887146, "perdoc_allgather_time": 2.515276777744293, "perdoc_attn_time": 6.648422431945801, "output_shape": [8192, 16, 128]}, "6": {"per_seq_latency": 6.641865539550781, "per_doc_latency": 9.186102294921875, "perseq_allgather_time": 0.3090208001434803, "perseq_attn_time": 6.326065611839295, "perdoc_allgather_time": 2.4595760107040405, "perdoc_attn_time": 6.7195232629776, "output_shape": [8192, 16, 128]}, "3": {"per_seq_latency": 6.641510772705078, "per_doc_latency": 9.18762435913086, "perseq_allgather_time": 0.3710399977862835, "perseq_attn_time": 6.263160014152527, "perdoc_allgather_time": 2.4867536067962646, "perdoc_attn_time": 6.693596816062927, "output_shape": [8192, 16, 128]}, "2": {"per_seq_latency": 6.6600288391113285, "per_doc_latency": 9.18095703125, "perseq_allgather_time": 0.334383998811245, "perseq_attn_time": 6.31831841468811, "perdoc_allgather_time": 2.4946143984794618, "perdoc_attn_time": 6.67901759147644, "output_shape": [8192, 16, 128]}, "1": {"per_seq_latency": 6.639324951171875, "per_doc_latency": 9.182917022705078, "perseq_allgather_time": 0.3512879990041256, "perseq_attn_time": 6.28088161945343, "perdoc_allgather_time": 2.5077199816703795, "perdoc_attn_time": 6.66799840927124, "output_shape": [8192, 16, 128]}, "per_seq_latency": 6.6600288391113285, "per_doc_latency": 9.193888092041016, "per_seq_allgather_latency": 0.3710399977862835, "per_seq_attn_latency": 6.36330885887146, "per_doc_allgather_latency": 2.605766403675079, "per_doc_attn_latency": 6.729753589630127, "num_seq_in_batch": 1, "seq_len": 65536, "num_heads": 64, "head_dim": 128, "cp": 8, "tp": 4, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
{"7": {"per_seq_latency": 3.6913822174072264, "per_doc_latency": 4.815334320068359, "perseq_allgather_time": 0.42018239572644234, "perseq_attn_time": 3.264364814758301, "perdoc_allgather_time": 1.303766393661499, "perdoc_attn_time": 3.5047136187553405, "output_shape": [8192, 8, 128]}, "0": {"per_seq_latency": 3.5248638153076173, "per_doc_latency": 4.814326477050781, "perseq_allgather_time": 0.24995040223002435, "perseq_attn_time": 3.260590374469757, "perdoc_allgather_time": 1.3140096068382263, "perdoc_attn_time": 3.493227207660675, "output_shape": [8192, 8, 128]}, "2": {"per_seq_latency": 3.691196823120117, "per_doc_latency": 4.817652893066406, "perseq_allgather_time": 0.4337407946586609, "perseq_attn_time": 3.249985599517822, "perdoc_allgather_time": 1.3346992135047913, "perdoc_attn_time": 3.4756271839141846, "output_shape": [8192, 8, 128]}, "4": {"per_seq_latency": 3.6940208435058595, "per_doc_latency": 4.812609481811523, "perseq_allgather_time": 0.42754719480872155, "perseq_attn_time": 3.2595855951309205, "perdoc_allgather_time": 1.322955197095871, "perdoc_attn_time": 3.482916808128357, "output_shape": [8192, 8, 128]}, "5": {"per_seq_latency": 3.691012954711914, "per_doc_latency": 4.812875366210937, "perseq_allgather_time": 0.4567359946668148, "perseq_attn_time": 3.2274368166923524, "perdoc_allgather_time": 1.3327472150325774, "perdoc_attn_time": 3.4733567953109743, "output_shape": [8192, 8, 128]}, "6": {"per_seq_latency": 3.6905071258544924, "per_doc_latency": 4.814705657958984, "perseq_allgather_time": 0.44352800622582433, "perseq_attn_time": 3.2402079701423645, "perdoc_allgather_time": 1.3396063923835755, "perdoc_attn_time": 3.46839679479599, "output_shape": [8192, 8, 128]}, "1": {"per_seq_latency": 3.691844940185547, "per_doc_latency": 4.813100814819336, "perseq_allgather_time": 0.45960800498723986, "perseq_attn_time": 3.2251984119415282, "perdoc_allgather_time": 1.2983471870422363, "perdoc_attn_time": 3.5076543927192687, "output_shape": [8192, 8, 128]}, "3": {"per_seq_latency": 3.6914112091064455, "per_doc_latency": 4.811329650878906, "perseq_allgather_time": 0.393595203012228, "perseq_attn_time": 3.2904943943023683, "perdoc_allgather_time": 1.3363360106945037, "perdoc_attn_time": 3.467745578289032, "output_shape": [8192, 8, 128]}, "per_seq_latency": 3.6940208435058595, "per_doc_latency": 4.817652893066406, "per_seq_allgather_latency": 0.45960800498723986, "per_seq_attn_latency": 3.2904943943023683, "per_doc_allgather_latency": 1.3396063923835755, "per_doc_attn_latency": 3.5076543927192687, "num_seq_in_batch": 1, "seq_len": 65536, "num_heads": 64, "head_dim": 128, "cp": 8, "tp": 8, "comment": "tp runs with reduced num_heads, cp is the same as world_size. Time measured in ms."}
